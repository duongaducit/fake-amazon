(function(f){var c=window.AmazonUIPageJS||window.P,q=c._namespace||c.attributeErrors,a=q?q("InTransitActionsBuzzAssets",""):c;a.guardFatal?a.guardFatal(f)(a,window):a.execute(function(){f(a,window)})})(function(f,c,q){"use strict";f.register("in-transit-csm-metrics-utils",function(){var a,g;try{a=navigator.userAgent}catch(b){a=""}a&&(a=a.toLowerCase(),(a=a.match(/(chrome|firefox|safari|trident|ddge|opr|crios|fxios)/gi))&&0<a.length&&(-1<a.indexOf("safari")&&1<a.length?-1<a.indexOf("chrome")||-1<a.indexOf("crios")?
g="chrome":-1<a.indexOf("fxios")&&(g="firefox"):g=a[0]));var d=[],l=function(b){c.ue&&c.uex&&uex("ld",b,{wb:1});b=d.indexOf(b);-1<b&&d.splice(b,1)};c.addEventListener("beforeunload",function(b){for(;0<d.length;)l(d[0])});return{setScope:function(b){c.ue&&c.uet&&c.uet("tc",b);return b},setPreAjax:function(b){c.ue&&c.ues&&c.ues("t0",b,new Date)},setPostAjax:function(b){c.ue&&c.uet&&c.uet("be",b)},sendAjaxMetrics:function(b){c.ue&&c.uex&&c.uex("ld",b)},recordReftag:function(b,c){b.ajax({type:"POST",
url:"/gp/mobile/tag?"+c,success:function(b){console.log("record ref tag ajax call success: ",b)},error:function(b){console.log("ref tag ajax call error: ",b)}})},logFatal:function(b){if(c.ueLogError){var a=b.feature||"pt2-fatal-generic";c.ueLogError(b.error||{message:b.message||a},{logLevel:"FATAL",attribution:a})}},logError:function(b){if(c.ueLogError){var a=b.feature||"pt2-error-generic";c.ueLogError(b.error||{message:b.message||a},{logLevel:"ERROR",attribution:a})}},logWarn:function(b){if(c.ueLogError){var a=
b.feature||"pt2-warn-generic";c.ueLogError(b.error||{message:b.message||a},{logLevel:"WARN",attribution:a})}},incrementCount:function(b,a){c.ue&&c.ue.count&&(c.ue.count(b,(c.ue.count(b)||0)+1),a&&a.browser&&g&&c.ue.count(b+"-"+g,(c.ue.count(b+"-"+g)||0)+1))},startWidgetTimer:function(b){c.ue&&c.uet&&0>d.indexOf(b)&&(uet("bb",b,{wb:1}),d.push(b))},stopWidgetTimer:l}});"use strict";f.when("A").register("in-transit-url-utils",function(a){function c(a){return a.split("\x26").reduce(function(b,a){a=a.split("\x3d").map(function(b){return decodeURIComponent(b.replace(/\+/g,
" "))});b[a[0]]=a[1];return b},{})}var d=a.$;return{getQueryParameterFromUrl:function(a,b){a=-1<a.indexOf("?")?a.substr(a.indexOf("?")):"";-1<a.indexOf("#")&&(a=a.substring(0,a.indexOf("#")));a=c(a);return a[b]?a[b]:!1},addQueryParameterToUrl:function(a,b){var c=!1;-1<a.indexOf("#")&&(c=a.substring(a.indexOf("#")),a=a.substr(0,a.indexOf("#")));b=d.param(b);a=-1<a.indexOf("?")?a+("\x26"+b):a+("?"+b);return c?a+c:a}}});"use strict";f.when("A","in-transit-csm-metrics-utils","ready").register("in-transit-sign-in-again-or-do",
function(a,g){var d=-1!==c.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker/actions/is-authenticated":"/progress-tracker/package/actions/is-authenticated",l;return function(b,g,f,e,h){a.post(d,{params:{csrfToken:e.csrfToken},success:function(a){a.success&&a.value?h&&h():a.success?(a=b.$currentTarget,e.width=620>c.innerWidth?.75*c.innerWidth:600,e.name=f,e.dataStrategy="preload",l||(l=g.create(a,e)),l.update({header:e.header||""}).show()):console.log("service failed")},error:function(a){}})}});
"use strict";f.when("A","in-transit-csm-metrics-utils","a-tooltip","ready").register("in-transit-tooltip",function(a,c,d){function f(a){c.incrementCount(a+"-total");e&&(c.incrementCount(a+"-unique"),e=!1)}function b(a){m("body").addClass("in-transit-tooltip-style-override "+n.deviceType);m(".in-transit-tooltip-trigger."+a).attr("title","")}var m=a.$,n=a.state("page-state")||{},e=!0,h=function(c){a.declarative("a-tooltip","mouseenter",function(a){b(c);f(c)});a.declarative("a-tooltip","click",function(a){a.$event.preventDefault()})},
r=function(c){a.declarative("a-tooltip","click",function(a){b(c);a=m(".in-transit-tooltip-trigger."+c);a=d.get(a);a.isVisible()?a.hide():f(c)})};return function(a){"desktop"!==n.deviceType&&n.deviceType?r(a):h(a)}});"use strict";f.when("A","a-modal","a-button","in-transit-url-utils","in-transit-csm-metrics-utils","ready").register("rescheduleDelivery",function(a,g,d,f,b){function m(){var a;a=t?0<e(".rescheduleWindowOption .a-button-selected").length?!0:!1:!0;a?u.enable():u.disable()}function n(){return"?"+
e.param({orderId:h.orderId,shipmentId:h.shipmentId,packageIndex:h.packageIndex})+"\x26amzlMessageId\x3d"}var e=a.$,h=a.state("page-state")||{},r=-1!==c.location.host.indexOf("hp-shoppingportal")?"/portal/cstrac/progress-tracker":"/progress-tracker/package",q=r+"/actions/in-transit/reschedule",y={isModalContent:"1"},v=n(),p=r+v,x=1==h.stringDebug,t="true"===e("#rescheduleDayOptions-container").attr("data-isRescheduleToWindow"),k,w=!1,u=d("#reschedule-submitBtn");a.declarative("intransit-reschedule-open-modal",
"click",function(b){b.$event.preventDefault();var d=b.$currentTarget;d.find("a").data("ref");b=a.extend({},b.data);b.width=620>c.innerWidth?.75*c.innerWidth:600;b.name="rescheduleModal";b.dataStrategy="ajax";"#"===d.find("a").attr("href")?b.url=d.find("a").attr("data-modalurl"):b.url=d.find("a").attr("href");b.url=f.addQueryParameterToUrl(b.url,y);g.create(d,b).show()});a.on("a:popover:ajaxContentLoaded:rescheduleModal",function(b){a.state.parse();h=a.state("page-state")||{};v=n();p=r+v;x=1==h.stringDebug;
t="true"===e("#rescheduleDayOptions-container").attr("data-isRescheduleToWindow");u=d("#reschedule-submitBtn")});a.on("a:button-group:toggleRescheduleDayOption:toggle",function(a){a=a.selectedButton.buttonName;if(0<a.length){a=a.split("_");a=e("#rescheduleDeliveryWindowsGroup_"+(1<a.length?a[1]:"INVALID"));if(t){var c=e(".rescheduleWindowOption .a-button-selected");e(".rescheduleDeliveryWindowsGroup").addClass("invisible");c.removeClass("a-button-selected");c.attr("aria-checked","false");0<a.length?
a.removeClass("invisible"):console.log("No matching window group found for the day option selected")}else k=a.find(".rescheduleWindowOption").first().find(".a-button-input").data("token"),w=!0,"undefined"===typeof k&&(b.logError({feature:"request-reschedule-ajax-call-day-toggle-token-not-set",message:"The reschedule token was not set while toggling day"}),b.incrementCount("request-reschedule-ajax-call-day-toggle-token-not-set"));m()}});a.on("a:button-group:toggleRescheduleWindowOption:toggle",function(a){m()});
a.declarative("submit-reschedule","click",function(d){d.$event.preventDefault();u.disable();t&&(k=e(".rescheduleWindowOption .a-button-selected").find(".a-button-input").data("token"),w=!0);"undefined"!==typeof k&&"undefined"!==k||!t?"undefined"!==typeof k&&"undefined"!==k||!1!==w?a.post(q,{params:{rescheduleToken:k,stringDebug:x,csrfToken:c.csrfToken},dataType:"json",success:function(a){var d=a.requestRescheduleDisplayResponse;if(a.success)b.incrementCount("request-reschedule-ajax-call-success"),
c.location=p+"7";else{b.incrementCount("request-reschedule-ajax-call-failure");var d=(d=d.failureReason)||0,e="";d&&(e=", failureReason: "+d);b.logError({feature:"request-reschedule-ajax-call-failure-log",message:"Failed to request reschedule due to responseCode: "+a.responseCode+e});c.location=p+"8"}},error:function(a){b.incrementCount("request-reschedule-ajax-call-error");b.logError({feature:"request-reschedule-ajax-call-error-log",message:("Error making a request to reschedule with",a)});c.location=
p+"8"}}):(b.logError({feature:"request-reschedule-ajax-call-token-never-attempted-to-set",message:("The reschedule token was never attempted to set before making a reschedule request for ",data)}),b.incrementCount("request-reschedule-ajax-call-token-never-attempted-to-set"),c.location=p+"8"):(b.logError({feature:"request-reschedule-ajax-call-window-toggle-token-not-set",message:"The reschedule token was not set while toggling window"}),b.incrementCount("request-reschedule-ajax-call-window-toggle-token-not-set"),
c.location=p+"8")})});"use strict";f.when("A","in-transit-url-utils","rescheduleDelivery","ready").execute("in-transit-loaded",function(a,f){var d=["PackageProgressTracker"];"desktop"===(a.state("page-state")||{}).deviceType&&(f=f.getQueryParameterFromUrl(c.location.search||c.location.href,"showModal"))&&-1<d.indexOf(c.uept.pageType||"")&&(d=f.replace(/[^0-9a-z\-\_]/gi,""),a=a.$("[data-action\x3d"+d+"]"),1===a.length&&a.click())})});