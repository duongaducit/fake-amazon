(function(pa){var qa=window.AmazonUIPageJS||window.P,ta=qa._namespace||qa.attributeErrors,y=ta?ta("CampfireCryptoJS_AUIBuild",""):qa;y.guardFatal?y.guardFatal(pa)(y,window):y.execute(function(){pa(y,window)})})(function(pa,qa,ta){pa.register("3p-CryptoJS",function(){var y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=
this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;
a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),
v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=
a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=
this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);
this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,g=k.Hasher,k=d.algo,p=e.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,
5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),q=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),
v=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),r=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0]),k=k.RIPEMD160=g.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,d){for(var b=0;16>
b;b++){var a=d+b,f=e[a];e[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var a=this._hash.words,f=r.words,t=c.words,h=p.words,J=q.words,g=u.words,k=v.words,ha,Q,T,C,N,F,D,B,y,m;F=ha=a[0];D=Q=a[1];B=T=a[2];y=C=a[3];m=N=a[4];for(var l,b=0;80>b;b+=1)l=ha+e[d+h[b]]|0,l=16>b?l+((Q^T^C)+f[0]):32>b?l+((Q&T|~Q&C)+f[1]):48>b?l+(((Q|~T)^C)+f[2]):64>b?l+((Q&C|T&~C)+f[3]):l+((Q^(T|~C))+f[4]),l|=0,l=l<<g[b]|l>>>32-g[b],l=l+N|0,ha=N,N=C,C=T<<10|T>>>22,T=Q,Q=l,l=F+e[d+J[b]]|0,l=16>b?l+((D^(B|~y))+t[0]):32>b?
l+((D&y|B&~y)+t[1]):48>b?l+(((D|~B)^y)+t[2]):64>b?l+((D&B|~D&y)+t[3]):l+((D^B^y)+t[4]),l|=0,l=l<<k[b]|l>>>32-k[b],l=l+m|0,F=m,m=y,y=B<<10|B>>>22,B=D,D=l;l=a[1]+T+y|0;a[1]=a[2]+C+m|0;a[2]=a[3]+N+F|0;a[3]=a[4]+ha+D|0;a[4]=a[0]+Q+B|0;a[0]=l},_doFinalize:function(){var c=this._data,e=c.words,b=8*this._nDataBytes,a=8*c.sigBytes;e[a>>>5]|=128<<24-a%32;e[(a+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;c.sigBytes=4*(e.length+1);this._process();c=this._hash;e=c.words;for(b=0;5>b;b++)a=e[b],
e[b]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;return c},clone:function(){var c=g.clone.call(this);c._hash=this._hash.clone();return c}});d.RIPEMD160=g._createHelper(k);d.HmacRIPEMD160=g._createHmacHelper(k)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(e,d){e=this._hasher=new e.init;"string"==typeof d&&(d=k.parse(d));var p=e.blockSize,q=4*p;d.sigBytes>q&&(d=e.finalize(d));d.clamp();e=this._oKey=d.clone();d=this._iKey=d.clone();for(var u=e.words,v=d.words,
r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;e.sigBytes=d.sigBytes=q;this.reset()},reset:function(){var e=this._hasher;e.reset();e.update(this._iKey)},update:function(e){this._hasher.update(e);return this},finalize:function(e){var d=this._hasher;e=d.finalize(e);d.reset();return d.finalize(this._oKey.clone().concat(e))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,
arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=
this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*
d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*
8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));
this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},
reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,g=k.Hasher,k=d.algo,p=e.create([0,1,2,3,4,5,6,7,8,9,
10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),q=e.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),u=e.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,
12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),v=e.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),r=e.create([0,1518500249,1859775393,2400959708,2840853838]),c=e.create([1352829926,1548603684,1836072691,2053994217,0]),k=k.RIPEMD160=g.extend({_doReset:function(){this._hash=e.create([1732584193,4023233417,
2562383102,271733878,3285377520])},_doProcessBlock:function(e,d){for(var b=0;16>b;b++){var a=d+b,f=e[a];e[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360}var a=this._hash.words,f=r.words,t=c.words,h=p.words,J=q.words,g=u.words,k=v.words,ha,Q,T,C,N,F,y,B,E,m;F=ha=a[0];y=Q=a[1];B=T=a[2];E=C=a[3];m=N=a[4];for(var l,b=0;80>b;b+=1)l=ha+e[d+h[b]]|0,l=16>b?l+((Q^T^C)+f[0]):32>b?l+((Q&T|~Q&C)+f[1]):48>b?l+(((Q|~T)^C)+f[2]):64>b?l+((Q&C|T&~C)+f[3]):l+((Q^(T|~C))+f[4]),l|=0,l=l<<g[b]|l>>>32-g[b],l=l+N|0,
ha=N,N=C,C=T<<10|T>>>22,T=Q,Q=l,l=F+e[d+J[b]]|0,l=16>b?l+((y^(B|~E))+t[0]):32>b?l+((y&E|B&~E)+t[1]):48>b?l+(((y|~B)^E)+t[2]):64>b?l+((y&B|~y&E)+t[3]):l+((y^B^E)+t[4]),l|=0,l=l<<k[b]|l>>>32-k[b],l=l+m|0,F=m,m=E,E=B<<10|B>>>22,B=y,y=l;l=a[1]+T+E|0;a[1]=a[2]+C+m|0;a[2]=a[3]+N+F|0;a[3]=a[4]+ha+y|0;a[4]=a[0]+Q+B|0;a[0]=l},_doFinalize:function(){var c=this._data,e=c.words,b=8*this._nDataBytes,a=8*c.sigBytes;e[a>>>5]|=128<<24-a%32;e[(a+64>>>9<<4)+14]=(b<<8|b>>>24)&16711935|(b<<24|b>>>8)&4278255360;c.sigBytes=
4*(e.length+1);this._process();c=this._hash;e=c.words;for(b=0;5>b;b++)a=e[b],e[b]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;return c},clone:function(){var c=g.clone.call(this);c._hash=this._hash.clone();return c}});d.RIPEMD160=g._createHelper(k);d.HmacRIPEMD160=g._createHmacHelper(k)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});
f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,
t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|
0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},
parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=
a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);
this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(e){var d=e.words,p=e.sigBytes,q=this._map;e.clamp();e=[];for(var u=
0;u<p;u+=3)for(var v=(d[u>>>2]>>>24-u%4*8&255)<<16|(d[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|d[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<p;r++)e.push(q.charAt(v>>>6*(3-r)&63));if(d=q.charAt(64))for(;e.length%4;)e.push(d);return e.join("")},parse:function(e){var d=e.length,p=this._map,q=p.charAt(64);q&&(q=e.indexOf(q),-1!=q&&(d=q));for(var q=[],u=0,v=0;v<d;v++)if(v%4){var r=p.indexOf(e.charAt(v-1))<<v%4*2,c=p.indexOf(e.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();
(function(d){function k(c,b,a,f,t,h,J){c=c+(b&a|~b&f)+t+J;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,t,h,J){c=c+(b&f|a&~f)+t+J;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,t,h,J){c=c+(b^a^f)+t+J;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,t,h,J){c=c+(a^(b|~f))+t+J;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},
_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],J=d[b+3],q=d[b+4],v=d[b+5],u=d[b+6],r=d[b+7],x=d[b+8],C=d[b+9],y=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,J,22,c[3]);b=k(b,m,l,n,q,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,r,22,
c[7]);b=k(b,m,l,n,x,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,y,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,y,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,q,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,J,14,c[26]);m=e(m,l,n,b,x,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=
e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,r,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,x,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,q,11,c[37]);l=g(l,n,b,m,r,16,c[38]);m=g(m,l,n,b,y,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,J,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,r,10,c[49]);l=p(l,
n,b,m,E,15,c[50]);m=p(m,l,n,b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,J,10,c[53]);l=p(l,n,b,m,y,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,x,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,q,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/
4294967296);b[(f+64>>>9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,
p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var v=this.cfg,r=v.hasher.create(),c=g.create(),p=c.words,w=v.keySize,v=v.iterations;p.length<w;){b&&r.update(b);var b=r.update(d).finalize(e);r.reset();for(var a=1;a<v;a++)b=r.finalize(b),r.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,
q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,h){return this.create(this._ENC_XFORM_MODE,a,h)},createDecryptor:function(a,h){return this.create(this._DEC_XFORM_MODE,a,h)},init:function(a,h,f){this.cfg=this.cfg.extend(f);this._xformMode=a;this._key=h;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},
keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(t){return{encrypt:function(h,b,c){return("string"==typeof b?f:a).encrypt(t,h,b,c)},decrypt:function(h,b,c){return("string"==typeof b?f:a).decrypt(t,h,b,c)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,h,f){var b=this._iv;b?this._iv=d:b=this._prevBlock;for(var c=0;c<f;c++)a[h+c]^=b[c]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,h){return this.Encryptor.create(a,
h)},createDecryptor:function(a,h){return this.Decryptor.create(a,h)},init:function(a,h){this._cipher=a;this._iv=h}})).extend();w.Encryptor=w.extend({processBlock:function(a,h){var f=this._cipher,b=f.blockSize;x.call(this,a,h,b);f.encryptBlock(a,h);this._prevBlock=a.slice(h,h+b)}});w.Decryptor=w.extend({processBlock:function(a,h){var f=this._cipher,b=f.blockSize,c=a.slice(h,h+b);f.decryptBlock(a,h);x.call(this,a,h,b);this._prevBlock=c}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,h){h*=4;h-=a.sigBytes%
h;for(var f=h<<24|h<<16|h<<8|h,b=[],c=0;c<h;c+=4)b.push(f);h=p.create(b,h);a.concat(h)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,h=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var f=a.createEncryptor;else f=a.createDecryptor,this._minBufferSize=1;this._mode=f.call(a,this,h&&h.words)},_doProcessBlock:function(a,h){this._mode.processBlock(a,h)},_doFinalize:function(){var a=
this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var h=this._process(!0)}else h=this._process(!0),a.unpad(h);return h},blockSize:4});var b=e.CipherParams=g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var h=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(h):h).toString(u)},parse:function(a){a=u.parse(a);var h=a.words;
if(1398893684==h[0]&&1701076831==h[1]){var f=p.create(h.slice(2,4));h.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:f})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),encrypt:function(a,h,f,c){c=this.cfg.extend(c);var d=a.createEncryptor(f,c);h=d.finalize(h);d=d.cfg;return b.create({ciphertext:h,key:f,iv:d.iv,algorithm:a,mode:d.mode,padding:d.padding,blockSize:a.blockSize,formatter:c.format})},decrypt:function(a,h,f,b){b=this.cfg.extend(b);h=this._parse(h,b.format);return a.createDecryptor(f,
b).finalize(h.ciphertext)},_parse:function(a,h){return"string"==typeof a?h.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,h,f,c){c||(c=p.random(8));a=v.create({keySize:h+f}).compute(a,c);f=p.create(a.words.slice(h),4*f);a.sigBytes=4*h;return b.create({key:a,iv:f,salt:c})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(f,h,b,c){c=this.cfg.extend(c);b=c.kdf.execute(b,f.keySize,f.ivSize);c.iv=b.iv;f=a.encrypt.call(this,f,h,b.key,c);f.mixIn(b);return f},decrypt:function(f,
h,b,c){c=this.cfg.extend(c);h=this._parse(h,c.format);b=c.kdf.execute(b,f.keySize,f.ivSize,h.salt);c.iv=b.iv;return a.decrypt.call(this,f,h,b.key,c)}})}();(function(){function d(){for(var d=this._S,e=this._i,g=this._j,r=0,c=0;4>c;c++){var e=(e+1)%256,g=(g+d[e])%256,p=d[e];d[e]=d[g];d[g]=p;r|=d[(d[e]+d[g])%256]<<24-8*c}this._i=e;this._j=g;return r}var k=y,e=k.lib.StreamCipher,g=k.algo,p=g.RC4=e.extend({_doReset:function(){for(var d=this._key,e=d.words,d=d.sigBytes,g=this._S=[],r=0;256>r;r++)g[r]=r;
for(var c=r=0;256>r;r++){var p=r%d,c=(c+g[r]+(e[p>>>2]>>>24-p%4*8&255))%256,p=g[r];g[r]=g[c];g[c]=p}this._i=this._j=0},_doProcessBlock:function(e,g){e[g]^=d.call(this)},keySize:8,ivSize:0});k.RC4=e._createHelper(p);g=g.RC4Drop=p.extend({cfg:p.cfg.extend({drop:192}),_doReset:function(){p._doReset.call(this);for(var e=this.cfg.drop;0<e;e--)d.call(this)}});k.RC4Drop=e._createHelper(g)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;
a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:
4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);
return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;
for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=
0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),
init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,
p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();return d}})})();(function(){function d(){return p.create.apply(p,
arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,
944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),
d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,
2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,
1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,d){for(var e=this._hash.words,b=e[0],a=e[1],f=e[2],t=e[3],h=e[4],J=e[5],g=e[6],e=e[7],q=b.high,r=b.low,
p=a.high,k=a.low,C=f.high,y=f.low,F=t.high,D=t.low,B=h.high,E=h.low,m=J.high,l=J.low,n=g.high,da=g.low,la=e.high,ea=e.low,K=q,G=r,X=p,V=k,Y=C,W=y,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],z=U.high,A=U.low,U=(z>>>19|A<<13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-
7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^(L>>>18|H<<14)^(L<<23|H>>>9))+(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>
0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}r=b.low=r+G;b.high=q+K+(r>>>0<G>>>0?1:0);k=a.low=k+V;a.high=p+X+(k>>>0<V>>>0?1:0);y=f.low=y+W;f.high=C+Y+(y>>>0<W>>>0?1:0);D=t.low=D+Z;t.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>0?1:0);l=J.low=l+aa;J.high=m+fa+(l>>>0<aa>>>0?1:0);da=g.low=da+ba;g.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=
ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,e=c.words,d=8*this._nDataBytes,b=8*c.sigBytes;e[b>>>5]|=128<<24-b%32;e[(b+128>>>10<<5)+30]=Math.floor(d/4294967296);e[(b+128>>>10<<5)+31]=d;c.sigBytes=4*e.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);k.HmacSHA512=e._createHmacHelper(g)})();(function(){var d=y,k=d.x64,e=k.Word,g=k.WordArray,k=d.algo,
p=k.SHA512,k=k.SHA384=p.extend({_doReset:function(){this._hash=new g.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var e=p._doFinalize.call(this);e.sigBytes-=16;return e}});d.SHA384=p._createHelper(k);d.HmacSHA384=p._createHmacHelper(k)})();y=y||
function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-
f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<
24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},
w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,
t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(f,t){for(var h=this._hash.words,b=h[0],c=h[1],e=h[2],d=h[3],g=h[4],
w=h[5],q=h[6],v=h[7],r=0;64>r;r++){if(16>r)a[r]=f[t+r]|0;else{var p=a[r-15],k=a[r-2];a[r]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+a[r-7]+((k<<15|k>>>17)^(k<<13|k>>>19)^k>>>10)+a[r-16]}p=v+((g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25))+(g&w^~g&q)+u[r]+a[r];k=((b<<30|b>>>2)^(b<<19|b>>>13)^(b<<10|b>>>22))+(b&c^b&e^c&e);v=q;q=w;w=g;g=d+p|0;d=e;e=c;c=b;b=p+k|0}h[0]=h[0]+b|0;h[1]=h[1]+c|0;h[2]=h[2]+e|0;h[3]=h[3]+d|0;h[4]=h[4]+g|0;h[5]=h[5]+w|0;h[6]=h[6]+q|0;h[7]=h[7]+v|0},_doFinalize:function(){var a=this._data,
t=a.words,h=8*this._nDataBytes,b=8*a.sigBytes;t[b>>>5]|=128<<24-b%32;t[(b+64>>>9<<4)+14]=d.floor(h/4294967296);t[(b+64>>>9<<4)+15]=h;a.sigBytes=4*t.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=
function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},
concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],t=0;t<
a;t+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++){var b=f[h>>>2]>>>24-h%4*8&255;t.push((b>>>4).toString(16));t.push((b&15).toString(16))}return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h+=2)t[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(t,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var t=[],h=0;h<a;h++)t.push(String.fromCharCode(f[h>>>
2]>>>24-h%4*8&255));return t.join("")},parse:function(a){for(var f=a.length,t=[],h=0;h<f;h++)t[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(t,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=
x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,t=f.words,h=f.sigBytes,b=this.blockSize,c=h/(4*b),c=a?d.ceil(c):d.max((c|0)-this._minBufferSize,0);a=c*b;h=d.min(4*a,h);if(a){for(var e=0;e<a;e+=b)this._doProcessBlock(t,e);e=t.splice(0,a);f.sigBytes-=h}return new u.init(e,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);
this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,t){return(new a.init(t)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){function k(c,b,a,f,t,h,e){c=c+(b&a|~b&f)+t+e;return(c<<h|c>>>32-h)+
b}function e(c,b,a,f,t,h,e){c=c+(b&f|a&~f)+t+e;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,t,h,e){c=c+(b^a^f)+t+e;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,t,h,e){c=c+(a^(b|~f))+t+e;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|
t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],J=d[b+3],q=d[b+4],v=d[b+5],r=d[b+6],u=d[b+7],x=d[b+8],C=d[b+9],y=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,J,22,c[3]);b=k(b,m,l,n,q,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,r,17,c[6]);m=k(m,l,n,b,u,22,c[7]);b=k(b,m,l,n,x,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,y,17,c[10]);m=k(m,
l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,r,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,y,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,q,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,J,14,c[26]);m=e(m,l,n,b,x,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,u,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,
v,4,c[32]);n=g(n,b,m,l,x,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,q,11,c[37]);l=g(l,n,b,m,u,16,c[38]);m=g(m,l,n,b,y,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,J,16,c[42]);m=g(m,l,n,b,r,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,u,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,J,10,
c[53]);l=p(l,n,b,m,y,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,x,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,r,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,q,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;
b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(e,d){e=this._hasher=new e.init;"string"==typeof d&&(d=k.parse(d));
var p=e.blockSize,q=4*p;d.sigBytes>q&&(d=e.finalize(d));d.clamp();e=this._oKey=d.clone();d=this._iKey=d.clone();for(var u=e.words,v=d.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;e.sigBytes=d.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib=
{},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=
q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,t=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var b=0;b<a;b++)f[h+b>>>2]|=(t[b>>>2]>>>24-b%4*8&255)<<24-(h+b)%4*8;else if(65535<t.length)for(b=0;b<a;b+=4)f[h+b>>>2]=t[b>>>2];else f.push.apply(f,t);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=
d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,
f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=
q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();
return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=
e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();
return d}})})();(function(){function d(){return p.create.apply(p,arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,
633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),
d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,
3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,
3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,d){for(var e=this._hash.words,
b=e[0],a=e[1],f=e[2],t=e[3],h=e[4],J=e[5],g=e[6],e=e[7],q=b.high,r=b.low,p=a.high,k=a.low,C=f.high,y=f.low,F=t.high,D=t.low,B=h.high,E=h.low,m=J.high,l=J.low,n=g.high,da=g.low,la=e.high,ea=e.low,K=q,G=r,X=p,V=k,Y=C,W=y,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],z=U.high,A=U.low,U=(z>>>19|A<<
13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^(L>>>18|H<<14)^(L<<23|H>>>9))+
(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}r=b.low=r+G;b.high=q+K+(r>>>0<G>>>0?1:0);k=a.low=k+V;a.high=p+X+(k>>>0<V>>>0?1:0);y=f.low=y+W;f.high=C+Y+(y>>>0<W>>>0?1:0);D=t.low=D+Z;t.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>0?1:0);l=J.low=l+aa;J.high=m+fa+
(l>>>0<aa>>>0?1:0);da=g.low=da+ba;g.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,d=c.words,e=8*this._nDataBytes,b=8*c.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+128>>>10<<5)+30]=Math.floor(e/4294967296);d[(b+128>>>10<<5)+31]=e;c.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);k.HmacSHA512=e._createHmacHelper(g)})();
(function(){var d=y,k=d.x64,e=k.Word,g=k.WordArray,k=d.algo,p=k.SHA512,k=k.SHA384=p.extend({_doReset:function(){this._hash=new g.init([new e.init(3418070365,3238371032),new e.init(1654270250,914150663),new e.init(2438529370,812702999),new e.init(355462360,4144912697),new e.init(1731405415,4290775857),new e.init(2394180231,1750603025),new e.init(3675008525,1694076839),new e.init(1203062813,3204075428)])},_doFinalize:function(){var d=p._doFinalize.call(this);d.sigBytes-=16;return d}});d.SHA384=p._createHelper(k);
d.HmacSHA384=p._createHmacHelper(k)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);
return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&
(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>
2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&
15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=
h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,
t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(f,b){for(var h=this._hash.words,c=h[0],
d=h[1],e=h[2],g=h[3],r=h[4],v=h[5],q=h[6],w=h[7],p=0;64>p;p++){if(16>p)a[p]=f[b+p]|0;else{var k=a[p-15],x=a[p-2];a[p]=((k<<25|k>>>7)^(k<<14|k>>>18)^k>>>3)+a[p-7]+((x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10)+a[p-16]}k=w+((r<<26|r>>>6)^(r<<21|r>>>11)^(r<<7|r>>>25))+(r&v^~r&q)+u[p]+a[p];x=((c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22))+(c&d^c&e^d&e);w=q;q=v;v=r;r=g+k|0;g=e;e=d;d=c;c=k+x|0}h[0]=h[0]+c|0;h[1]=h[1]+d|0;h[2]=h[2]+e|0;h[3]=h[3]+g|0;h[4]=h[4]+r|0;h[5]=h[5]+v|0;h[6]=h[6]+q|0;h[7]=h[7]+w|0},_doFinalize:function(){var a=
this._data,b=a.words,h=8*this._nDataBytes,c=8*a.sigBytes;b[c>>>5]|=128<<24-c%32;b[(c+64>>>9<<4)+14]=d.floor(h/4294967296);b[(c+64>>>9<<4)+15]=h;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.lib.WordArray,e=d.algo,g=e.SHA256,e=e.SHA224=g.extend({_doReset:function(){this._hash=new k.init([3238371032,914150663,812702999,
4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var d=g._doFinalize.call(this);d.sigBytes-=4;return d}});d.SHA224=g._createHelper(e);d.HmacSHA224=g._createHmacHelper(e)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=
1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,
arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=
this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*
d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*
8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));
this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},
reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,
e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();return d}})})();(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,q=k.x64.Word,e=k.algo,u=[],v=[],r=[],c=1,x=0,w=
0;24>w;w++){u[c+5*x]=(w+1)*(w+2)/2%64;var b=(2*c+3*x)%5,c=x%5,x=b}for(c=0;5>c;c++)for(x=0;5>x;x++)v[c+5*x]=x+(2*c+3*x)%5*5;c=1;for(x=0;24>x;x++){for(var a=b=w=0;7>a;a++){if(c&1){var f=(1<<a)-1;32>f?b^=1<<f:w^=1<<f-32}c=c&128?c<<1^113:c<<1}r[x]=q.create(w,b)}for(var t=[],c=0;25>c;c++)t[c]=q.create();e=e.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),_doReset:function(){for(var a=this._state=[],f=0;25>f;f++)a[f]=new q.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,
f){for(var b=this._state,c=this.blockSize/2,d=0;d<c;d++){var e=a[f+2*d],g=a[f+2*d+1],e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=b[d];w.high^=g;w.low^=e}for(c=0;24>c;c++){for(d=0;5>d;d++){var q=e=0;for(a=0;5>a;a++)w=b[d+5*a],e^=w.high,q^=w.low;w=t[d];w.high=e;w.low=q}for(d=0;5>d;d++)for(w=t[(d+4)%5],e=t[(d+1)%5],g=e.high,a=e.low,e=w.high^(g<<1|a>>>31),q=w.low^(a<<1|g>>>31),a=0;5>a;a++)w=b[d+5*a],w.high^=e,w.low^=q;for(g=1;25>g;g++)w=b[g],d=
w.high,w=w.low,a=u[g],32>a?(e=d<<a|w>>>32-a,q=w<<a|d>>>32-a):(e=w<<a-32|d>>>64-a,q=d<<a-32|w>>>64-a),w=t[v[g]],w.high=e,w.low=q;w=t[0];d=b[0];w.high=d.high;w.low=d.low;for(d=0;5>d;d++)for(a=0;5>a;a++)g=d+5*a,w=b[g],e=t[g],g=t[(d+1)%5+5*a],q=t[(d+2)%5+5*a],w.high=e.high^~g.high&q.high,w.low=e.low^~g.low&q.low;w=b[0];d=r[c];w.high^=d.high;w.low^=d.low}},_doFinalize:function(){var a=this._data,f=a.words,b=8*a.sigBytes,t=32*this.blockSize;f[b>>>5]|=1<<24-b%32;f[(d.ceil((b+1)/t)*t>>>5)-1]|=128;a.sigBytes=
4*f.length;this._process();for(var a=this._state,f=this.cfg.outputLength/8,b=f/8,t=[],c=0;c<b;c++){var e=a[c],w=e.high,e=e.low,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;t.push(e);t.push(w)}return new g.init(t,f)},clone:function(){for(var a=p.clone.call(this),f=a._state=this._state.slice(0),b=0;25>b;b++)f[b]=f[b].clone();return a}});k.SHA3=p._createHelper(e);k.HmacSHA3=p._createHmacHelper(e)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=
function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=
q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=
d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,
f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=
q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();
return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,t)).finalize(f)}}});var b=
e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<v;r++)e[r]=e[r].clone();
return d}})})();(function(){function d(){return p.create.apply(p,arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),d(2162078206,991336113),d(2614888103,
633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,1546045734),d(1294757372,1522805485),
d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),d(1537002063,2003034995),d(1747873779,
3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,365543100),d(1126000580,2618297676),d(1288033470,
3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,d){for(var e=this._hash.words,
b=e[0],a=e[1],f=e[2],t=e[3],h=e[4],g=e[5],r=e[6],e=e[7],q=b.high,p=b.low,k=a.high,y=a.low,C=f.high,N=f.low,F=t.high,D=t.low,B=h.high,E=h.low,m=g.high,l=g.low,n=r.high,da=r.low,la=e.high,ea=e.low,K=q,G=p,X=k,V=y,Y=C,W=N,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],z=U.high,A=U.low,U=(z>>>19|A<<
13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^(L>>>18|H<<14)^(L<<23|H>>>9))+
(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}p=b.low=p+G;b.high=q+K+(p>>>0<G>>>0?1:0);y=a.low=y+V;a.high=k+X+(y>>>0<V>>>0?1:0);N=f.low=N+W;f.high=C+Y+(N>>>0<W>>>0?1:0);D=t.low=D+Z;t.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>0?1:0);l=g.low=l+aa;g.high=m+fa+
(l>>>0<aa>>>0?1:0);da=r.low=da+ba;r.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,d=c.words,e=8*this._nDataBytes,b=8*c.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+128>>>10<<5)+30]=Math.floor(e/4294967296);d[(b+128>>>10<<5)+31]=e;c.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);k.HmacSHA512=e._createHmacHelper(g)})();
y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},
u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-
f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<
24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},
w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);
a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,t){return(new b.HMAC.init(a,
t)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],r=0;r<e;r++){var c=d[r];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),v=e.length,r=0;r<
v;r++)e[r]=e[r].clone();return d}})})();(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,q=k.x64.Word,e=k.algo,u=[],v=[],r=[],c=1,x=0,w=0;24>w;w++){u[c+5*x]=(w+1)*(w+2)/2%64;var b=(2*c+3*x)%5,c=x%5,x=b}for(c=0;5>c;c++)for(x=0;5>x;x++)v[c+5*x]=x+(2*c+3*x)%5*5;c=1;for(x=0;24>x;x++){for(var a=b=w=0;7>a;a++){if(c&1){var f=(1<<a)-1;32>f?b^=1<<f:w^=1<<f-32}c=c&128?c<<1^113:c<<1}r[x]=q.create(w,b)}for(var t=[],c=0;25>c;c++)t[c]=q.create();e=e.SHA3=p.extend({cfg:p.cfg.extend({outputLength:512}),
_doReset:function(){for(var a=this._state=[],f=0;25>f;f++)a[f]=new q.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(a,f){for(var b=this._state,c=this.blockSize/2,d=0;d<c;d++){var e=a[f+2*d],g=a[f+2*d+1],e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360,g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,w=b[d];w.high^=g;w.low^=e}for(c=0;24>c;c++){for(d=0;5>d;d++){var q=e=0;for(a=0;5>a;a++)w=b[d+5*a],e^=w.high,q^=w.low;w=t[d];w.high=e;w.low=q}for(d=0;5>d;d++)for(w=t[(d+
4)%5],e=t[(d+1)%5],g=e.high,a=e.low,e=w.high^(g<<1|a>>>31),q=w.low^(a<<1|g>>>31),a=0;5>a;a++)w=b[d+5*a],w.high^=e,w.low^=q;for(g=1;25>g;g++)w=b[g],d=w.high,w=w.low,a=u[g],32>a?(e=d<<a|w>>>32-a,q=w<<a|d>>>32-a):(e=w<<a-32|d>>>64-a,q=d<<a-32|w>>>64-a),w=t[v[g]],w.high=e,w.low=q;w=t[0];d=b[0];w.high=d.high;w.low=d.low;for(d=0;5>d;d++)for(a=0;5>a;a++)g=d+5*a,w=b[g],e=t[g],g=t[(d+1)%5+5*a],q=t[(d+2)%5+5*a],w.high=e.high^~g.high&q.high,w.low=e.low^~g.low&q.low;w=b[0];d=r[c];w.high^=d.high;w.low^=d.low}},
_doFinalize:function(){var a=this._data,f=a.words,b=8*a.sigBytes,t=32*this.blockSize;f[b>>>5]|=1<<24-b%32;f[(d.ceil((b+1)/t)*t>>>5)-1]|=128;a.sigBytes=4*f.length;this._process();for(var a=this._state,f=this.cfg.outputLength/8,b=f/8,t=[],c=0;c<b;c++){var e=a[c],w=e.high,e=e.low,w=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360,e=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;t.push(e);t.push(w)}return new g.init(t,f)},clone:function(){for(var a=p.clone.call(this),f=a._state=this._state.slice(0),b=
0;25>b;b++)f[b]=f[b].clone();return a}});k.SHA3=p._createHelper(e);k.HmacSHA3=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;
d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,
arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>
2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;
for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<
24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=
this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},
finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=d.words,p=d.sigBytes,q=this._map;d.clamp();d=[];for(var k=0;k<p;k+=3)for(var v=(g[k>>>2]>>>24-k%4*8&255)<<16|(g[k+1>>>2]>>>24-(k+1)%
4*8&255)<<8|g[k+2>>>2]>>>24-(k+2)%4*8&255,r=0;4>r&&k+.75*r<p;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,
b,a,f,t,h,d){c=c+(b&a|~b&f)+t+d;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,t,h,d){c=c+(b&f|a&~f)+t+d;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,t,h,d){c=c+(b^a^f)+t+d;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,t,h,d){c=c+(a^(b|~f))+t+d;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,
b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],r=d[b+3],q=d[b+4],v=d[b+5],u=d[b+6],x=d[b+7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,r,22,c[3]);b=k(b,m,l,n,q,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);
n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,q,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,r,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,
b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,q,11,c[37]);l=g(l,n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,r,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,
b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,r,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,q,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/4294967296);b[(f+64>>>
9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,
hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var v=this.cfg,r=v.hasher.create(),c=g.create(),k=c.words,w=v.keySize,v=v.iterations;k.length<w;){b&&r.update(b);var b=r.update(d).finalize(e);r.reset();for(var a=1;a<v;a++)b=r.finalize(b),r.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,
v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,f){return this.create(this._ENC_XFORM_MODE,a,f)},createDecryptor:function(a,f){return this.create(this._DEC_XFORM_MODE,a,f)},init:function(a,f,b){this.cfg=this.cfg.extend(b);this._xformMode=a;this._key=f;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,
_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(h,c,d){return("string"==typeof c?f:a).encrypt(b,h,c,d)},decrypt:function(h,c,d){return("string"==typeof c?f:a).decrypt(b,h,c,d)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,f,b){var c=this._iv;c?this._iv=d:c=this._prevBlock;for(var e=0;e<b;e++)a[f+e]^=c[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,f){return this.Encryptor.create(a,f)},createDecryptor:function(a,
f){return this.Decryptor.create(a,f)},init:function(a,f){this._cipher=a;this._iv=f}})).extend();w.Encryptor=w.extend({processBlock:function(a,f){var b=this._cipher,c=b.blockSize;x.call(this,a,f,c);b.encryptBlock(a,f);this._prevBlock=a.slice(f,f+c)}});w.Decryptor=w.extend({processBlock:function(a,f){var b=this._cipher,c=b.blockSize,d=a.slice(f,f+c);b.decryptBlock(a,f);x.call(this,a,f,c);this._prevBlock=d}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,f){f*=4;f-=a.sigBytes%f;for(var b=f<<24|f<<16|
f<<8|f,c=[],d=0;d<f;d+=4)c.push(b);f=p.create(c,f);a.concat(f)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,f=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var b=a.createEncryptor;else b=a.createDecryptor,this._minBufferSize=1;this._mode=b.call(a,this,f&&f.words)},_doProcessBlock:function(a,f){this._mode.processBlock(a,f)},_doFinalize:function(){var a=this.cfg.padding;
if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var f=this._process(!0)}else f=this._process(!0),a.unpad(f);return f},blockSize:4});var b=e.CipherParams=g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var f=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(f):f).toString(u)},parse:function(a){a=u.parse(a);var f=a.words;if(1398893684==
f[0]&&1701076831==f[1]){var c=p.create(f.slice(2,4));f.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:c})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),encrypt:function(a,f,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);f=e.finalize(f);e=e.cfg;return b.create({ciphertext:f,key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,f,b,c){c=this.cfg.extend(c);f=this._parse(f,c.format);return a.createDecryptor(b,
c).finalize(f.ciphertext)},_parse:function(a,f){return"string"==typeof a?f.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,f,c,d){d||(d=p.random(8));a=v.create({keySize:f+c}).compute(a,d);c=p.create(a.words.slice(f),4*c);a.sigBytes=4*f;return b.create({key:a,iv:c,salt:d})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(f,b,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,f.keySize,f.ivSize);d.iv=c.iv;f=a.encrypt.call(this,f,b,c.key,d);f.mixIn(c);return f},decrypt:function(f,
b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);c=d.kdf.execute(c,f.keySize,f.ivSize,b.salt);d.iv=c.iv;return a.decrypt.call(this,f,b,c.key,d)}})}();(function(){function d(b,a){a&=this._lBlock>>>b^this._rBlock;this._rBlock^=a;this._lBlock^=a<<b}function k(b,a){a&=this._rBlock>>>b^this._lBlock;this._lBlock^=a;this._rBlock^=a<<b}var e=y,g=e.lib,p=g.WordArray,g=g.BlockCipher,q=e.algo,u=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,
46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],v=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],r=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,
134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,
3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,
184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,
402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,
5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,
23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,
458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,
1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,
32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,
110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,
128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,
6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,
320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,
2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,
2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],x=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],w=q.DES=g.extend({_doReset:function(){for(var b=this._key.words,a=[],f=0;56>f;f++){var c=u[f]-1;a[f]=b[c>>>5]>>>31-c%32&1}b=this._subKeys=[];for(c=0;16>c;c++){for(var h=b[c]=[],d=r[c],f=0;24>f;f++)h[f/6|0]|=
a[(v[f]-1+d)%28]<<31-f%6,h[4+(f/6|0)]|=a[28+(v[f+24]-1+d)%28]<<31-f%6;h[0]=h[0]<<1|h[0]>>>31;for(f=1;7>f;f++)h[f]>>>=4*(f-1)+3;h[7]=h[7]<<5|h[7]>>>27}a=this._invSubKeys=[];for(f=0;16>f;f++)a[f]=b[15-f]},encryptBlock:function(b,a){this._doCryptBlock(b,a,this._subKeys)},decryptBlock:function(b,a){this._doCryptBlock(b,a,this._invSubKeys)},_doCryptBlock:function(b,a,f){this._lBlock=b[a];this._rBlock=b[a+1];d.call(this,4,252645135);d.call(this,16,65535);k.call(this,2,858993459);k.call(this,8,16711935);
d.call(this,1,1431655765);for(var t=0;16>t;t++){for(var h=f[t],e=this._lBlock,g=this._rBlock,r=0,w=0;8>w;w++)r|=c[w][((g^h[w])&x[w])>>>0];this._lBlock=g;this._rBlock=e^r}f=this._lBlock;this._lBlock=this._rBlock;this._rBlock=f;d.call(this,1,1431655765);k.call(this,8,16711935);k.call(this,2,858993459);d.call(this,16,65535);d.call(this,4,252645135);b[a]=this._lBlock;b[a+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});e.DES=g._createHelper(w);q=q.TripleDES=g.extend({_doReset:function(){var b=this._key.words;
this._des1=w.createEncryptor(p.create(b.slice(0,2)));this._des2=w.createEncryptor(p.create(b.slice(2,4)));this._des3=w.createEncryptor(p.create(b.slice(4,6)))},encryptBlock:function(b,a){this._des1.encryptBlock(b,a);this._des2.decryptBlock(b,a);this._des3.encryptBlock(b,a)},decryptBlock:function(b,a){this._des3.decryptBlock(b,a);this._des2.encryptBlock(b,a);this._des1.decryptBlock(b,a)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=g._createHelper(q)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},
q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,
f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=
q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h+=2)b[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(b,f/2)}},c=v.Latin1=
{stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++)b.push(String.fromCharCode(f[h>>>2]>>>24-h%4*8&255));return b.join("")},parse:function(a){for(var f=a.length,b=[],h=0;h<f;h++)b[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(b,f)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(f){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=
new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var f=this._data,b=f.words,h=f.sigBytes,c=this.blockSize,e=h/(4*c),e=a?d.ceil(e):d.max((e|0)-this._minBufferSize,0);a=e*c;h=d.min(4*a,h);if(a){for(var g=0;g<a;g+=c)this._doProcessBlock(b,g);g=b.splice(0,a);f.sigBytes-=h}return new u.init(g,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=
w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(f,b){return(new a.init(b)).finalize(f)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(d){for(var k=
y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(f,b){for(var h=this._hash.words,c=h[0],d=h[1],e=h[2],g=h[3],w=h[4],r=h[5],v=h[6],q=h[7],k=0;64>k;k++){if(16>k)a[k]=f[b+k]|0;else{var p=a[k-15],
x=a[k-2];a[k]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+a[k-7]+((x<<15|x>>>17)^(x<<13|x>>>19)^x>>>10)+a[k-16]}p=q+((w<<26|w>>>6)^(w<<21|w>>>11)^(w<<7|w>>>25))+(w&r^~w&v)+u[k]+a[k];x=((c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22))+(c&d^c&e^d&e);q=v;v=r;r=w;w=g+p|0;g=e;e=d;d=c;c=p+x|0}h[0]=h[0]+c|0;h[1]=h[1]+d|0;h[2]=h[2]+e|0;h[3]=h[3]+g|0;h[4]=h[4]+w|0;h[5]=h[5]+r|0;h[6]=h[6]+v|0;h[7]=h[7]+q|0},_doFinalize:function(){var a=this._data,b=a.words,h=8*this._nDataBytes,c=8*a.sigBytes;b[c>>>5]|=128<<24-c%32;b[(c+
64>>>9<<4)+14]=d.floor(h/4294967296);b[(c+64>>>9<<4)+15]=h;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();
g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var f=new p;a&&f.mixIn(a);
f.hasOwnProperty("init")||(f.init=function(){f.$super.init.apply(this,arguments)});f.init.prototype=f;f.$super=this;return f},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var f in a)a.hasOwnProperty(f)&&(this[f]=a[f]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,f){a=this.words=a||[];this.sigBytes=f!=k?f:4*a.length},toString:function(a){return(a||
r).stringify(this)},concat:function(a){var f=this.words,b=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var c=0;c<a;c++)f[h+c>>>2]|=(b[c>>>2]>>>24-c%4*8&255)<<24-(h+c)%4*8;else if(65535<b.length)for(c=0;c<a;c+=4)f[h+c>>>2]=b[c>>>2];else f.push.apply(f,b);this.sigBytes+=a;return this},clamp:function(){var a=this.words,f=this.sigBytes;a[f>>>2]&=4294967295<<32-f%4*8;a.length=d.ceil(f/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var f=
[],b=0;b<a;b+=4)f.push(4294967296*d.random()|0);return new u.init(f,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var f=a.words;a=a.sigBytes;for(var b=[],h=0;h<a;h++){var c=f[h>>>2]>>>24-h%4*8&255;b.push((c>>>4).toString(16));b.push((c&15).toString(16))}return b.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h+=2)c[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++)c.push(String.fromCharCode(b[h>>>
2]>>>24-h%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h++)c[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=
x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var w=0;w<a;w+=e)this._doProcessBlock(c,w);w=c.splice(0,a);b.sigBytes-=h}return new u.init(w,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);
this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=
d.words,k=d.sigBytes,q=this._map;d.clamp();d=[];for(var u=0;u<k;u+=3)for(var v=(g[u>>>2]>>>24-u%4*8&255)<<16|(g[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|g[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<k;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>
2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,b,a,f,d,h,e){c=c+(b&a|~b&f)+d+e;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,d,h,e){c=c+(b&f|a&~f)+d+e;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,d,h,e){c=c+(b^a^f)+d+e;return(c<<h|c>>>32-h)+b}function p(c,b,a,f,d,h,e){c=c+(a^(b|~f))+d+e;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*
d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],r=d[b+3],v=d[b+4],q=d[b+5],u=d[b+6],x=d[b+7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=
k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,r,22,c[3]);b=k(b,m,l,n,v,7,c[4]);n=k(n,b,m,l,q,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,q,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,v,
20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,r,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,q,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,v,11,c[37]);l=g(l,n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,r,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);
n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,q,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,r,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,v,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+
n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var t=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});
q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var v=this.cfg,r=v.hasher.create(),c=g.create(),k=c.words,w=v.keySize,v=v.iterations;k.length<w;){b&&r.update(b);var b=r.update(d).finalize(e);r.reset();for(var a=1;a<v;a++)b=r.finalize(b),r.reset();c.concat(b)}c.sigBytes=4*w;return c}});
d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,a,b)},init:function(a,b,f){this.cfg=this.cfg.extend(f);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);
this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(h,c,d){return("string"==typeof c?f:a).encrypt(b,h,c,d)},decrypt:function(h,c,d){return("string"==typeof c?f:a).decrypt(b,h,c,d)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,b,
f){var c=this._iv;c?this._iv=d:c=this._prevBlock;for(var e=0;e<f;e++)a[b+e]^=c[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();w.Encryptor=w.extend({processBlock:function(a,b){var f=this._cipher,c=f.blockSize;x.call(this,a,b,c);f.encryptBlock(a,b);this._prevBlock=a.slice(b,b+c)}});w.Decryptor=w.extend({processBlock:function(a,
b){var f=this._cipher,c=f.blockSize,d=a.slice(b,b+c);f.decryptBlock(a,b);x.call(this,a,b,c);this._prevBlock=d}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,b){b*=4;b-=a.sigBytes%b;for(var f=b<<24|b<<16|b<<8|b,c=[],d=0;d<b;d+=4)c.push(f);b=p.create(c,b);a.concat(b)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var f=
a.createEncryptor;else f=a.createDecryptor,this._minBufferSize=1;this._mode=f.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var b=e.CipherParams=g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format=
{}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(b):b).toString(u)},parse:function(a){a=u.parse(a);var f=a.words;if(1398893684==f[0]&&1701076831==f[1]){var c=p.create(f.slice(2,4));f.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:c})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),encrypt:function(a,f,c,d){d=this.cfg.extend(d);var e=a.createEncryptor(c,d);f=e.finalize(f);e=e.cfg;return b.create({ciphertext:f,
key:c,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,f,c){c=this.cfg.extend(c);b=this._parse(b,c.format);return a.createDecryptor(f,c).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,f,c,d){d||(d=p.random(8));a=v.create({keySize:f+c}).compute(a,d);c=p.create(a.words.slice(f),4*c);a.sigBytes=4*f;return b.create({key:a,iv:c,salt:d})}},f=e.PasswordBasedCipher=
a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(b,f,c,d){d=this.cfg.extend(d);c=d.kdf.execute(c,b.keySize,b.ivSize);d.iv=c.iv;b=a.encrypt.call(this,b,f,c.key,d);b.mixIn(c);return b},decrypt:function(b,f,c,d){d=this.cfg.extend(d);f=this._parse(f,d.format);c=d.kdf.execute(c,b.keySize,b.ivSize,f.salt);d.iv=c.iv;return a.decrypt.call(this,b,f,c.key,d)}})}();(function(){function d(){for(var d=this._X,e=this._C,c=0;8>c;c++)p[c]=e[c];e[0]=e[0]+1295307597+this._b|0;e[1]=e[1]+3545052371+(e[0]>>>0<p[0]>>>
0?1:0)|0;e[2]=e[2]+886263092+(e[1]>>>0<p[1]>>>0?1:0)|0;e[3]=e[3]+1295307597+(e[2]>>>0<p[2]>>>0?1:0)|0;e[4]=e[4]+3545052371+(e[3]>>>0<p[3]>>>0?1:0)|0;e[5]=e[5]+886263092+(e[4]>>>0<p[4]>>>0?1:0)|0;e[6]=e[6]+1295307597+(e[5]>>>0<p[5]>>>0?1:0)|0;e[7]=e[7]+3545052371+(e[6]>>>0<p[6]>>>0?1:0)|0;this._b=e[7]>>>0<p[7]>>>0?1:0;for(c=0;8>c;c++){var g=d[c]+e[c],k=g&65535,b=g>>>16;q[c]=((k*k>>>17)+k*b>>>15)+b*b^((g&4294901760)*g|0)+((g&65535)*g|0)}d[0]=q[0]+(q[7]<<16|q[7]>>>16)+(q[6]<<16|q[6]>>>16)|0;d[1]=q[1]+
(q[0]<<8|q[0]>>>24)+q[7]|0;d[2]=q[2]+(q[1]<<16|q[1]>>>16)+(q[0]<<16|q[0]>>>16)|0;d[3]=q[3]+(q[2]<<8|q[2]>>>24)+q[1]|0;d[4]=q[4]+(q[3]<<16|q[3]>>>16)+(q[2]<<16|q[2]>>>16)|0;d[5]=q[5]+(q[4]<<8|q[4]>>>24)+q[3]|0;d[6]=q[6]+(q[5]<<16|q[5]>>>16)+(q[4]<<16|q[4]>>>16)|0;d[7]=q[7]+(q[6]<<8|q[6]>>>24)+q[5]|0}var k=y,e=k.lib.StreamCipher,g=[],p=[],q=[],u=k.algo.RabbitLegacy=e.extend({_doReset:function(){for(var e=this._key.words,g=this.cfg.iv,c=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<
16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],e=this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535],k=this._b=0;4>k;k++)d.call(this);for(k=0;8>k;k++)e[k]^=c[k+4&7];if(g){var c=g.words,g=c[0],c=c[1],g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,c=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,k=g>>>16|c&4294901760,q=c<<16|g&65535;e[0]^=g;e[1]^=k;e[2]^=c;e[3]^=q;
e[4]^=g;e[5]^=k;e[6]^=c;e[7]^=q;for(k=0;4>k;k++)d.call(this)}},_doProcessBlock:function(e,k){var c=this._X;d.call(this);g[0]=c[0]^c[5]>>>16^c[3]<<16;g[1]=c[2]^c[7]>>>16^c[5]<<16;g[2]=c[4]^c[1]>>>16^c[7]<<16;g[3]=c[6]^c[3]>>>16^c[1]<<16;for(c=0;4>c;c++)g[c]=(g[c]<<8|g[c]>>>24)&16711935|(g[c]<<24|g[c]>>>8)&4278255360,e[k+c]^=g[c]},blockSize:4,ivSize:2});k.RabbitLegacy=e._createHelper(u)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;
a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:
4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var d=0;d<a;d++)b[h+d>>>2]|=(c[d>>>2]>>>24-d%4*8&255)<<24-(h+d)%4*8;else if(65535<c.length)for(d=0;d<a;d+=4)b[h+d>>>2]=c[d>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);
return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++){var d=b[h>>>2]>>>24-h%4*8&255;c.push((d>>>4).toString(16));c.push((d&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h+=2)c[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;
for(var c=[],h=0;h<a;h++)c.push(String.fromCharCode(b[h>>>2]>>>24-h%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h++)c[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=
0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),
init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(f,c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,
g=k.Hasher,p=[],k=d.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var g=this._hash.words,k=g[0],c=g[1],x=g[2],w=g[3],b=g[4],a=0;80>a;a++){if(16>a)p[a]=d[e+a]|0;else{var f=p[a-3]^p[a-8]^p[a-14]^p[a-16];p[a]=f<<1|f>>>31}f=(k<<5|k>>>27)+b+p[a];f=20>a?f+((c&x|~c&w)+1518500249):40>a?f+((c^x^w)+1859775393):60>a?f+((c&x|c&w|x&w)-1894007588):f+((c^x^w)-899497514);b=w;w=x;x=c<<30|c>>>2;c=k;k=f}g[0]=
g[0]+k|0;g[1]=g[1]+c|0;g[2]=g[2]+x|0;g[3]=g[3]+w|0;g[4]=g[4]+b|0},_doFinalize:function(){var d=this._data,e=d.words,g=8*this._nDataBytes,k=8*d.sigBytes;e[k>>>5]|=128<<24-k%32;e[(k+64>>>9<<4)+14]=Math.floor(g/4294967296);e[(k+64>>>9<<4)+15]=g;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d}});d.SHA1=g._createHelper(k);d.HmacSHA1=g._createHmacHelper(k)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,
g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();
(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.HMAC,q=k.PBKDF2=e.extend({cfg:e.extend({keySize:4,hasher:k.SHA1,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){var k=this.cfg;d=p.create(k.hasher,d);for(var c=g.create(),q=g.create([1]),w=c.words,b=q.words,a=k.keySize,k=k.iterations;w.length<a;){var f=d.update(e).finalize(q);d.reset();for(var t=f.words,h=t.length,J=f,y=1;y<k;y++){J=d.finalize(J);d.reset();for(var sa=J.words,ha=0;ha<h;ha++)t[ha]^=sa[ha]}c.concat(f);
b[0]++}c.sigBytes=4*a;return c}});d.PBKDF2=function(d,e,g){return q.create(g).compute(d,e)}})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=
a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var d=0;d<a;d++)b[h+d>>>2]|=(c[d>>>2]>>>24-d%4*8&255)<<24-(h+d)%4*8;else if(65535<c.length)for(d=0;d<a;d+=4)b[h+d>>>2]=c[d>>>2];else b.push.apply(b,
c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++){var d=b[h>>>2]>>>24-h%4*8&255;c.push((d>>>4).toString(16));c.push((d&15).toString(16))}return c.join("")},
parse:function(a){for(var b=a.length,c=[],h=0;h<b;h+=2)c[h>>>3]|=parseInt(a.substr(h,2),16)<<24-h%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++)c.push(String.fromCharCode(b[h>>>2]>>>24-h%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],h=0;h<b;h++)c[h>>>2]|=(a.charCodeAt(h)&255)<<24-h%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=
h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(f,
c){return(new b.HMAC.init(a,c)).finalize(f)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib,e=k.WordArray,g=k.Hasher,p=[],k=d.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var g=this._hash.words,k=g[0],c=g[1],x=g[2],w=g[3],b=g[4],a=0;80>a;a++){if(16>a)p[a]=d[e+a]|0;else{var f=p[a-3]^p[a-8]^p[a-14]^p[a-16];p[a]=f<<1|f>>>31}f=(k<<5|k>>>27)+b+p[a];f=20>a?f+((c&x|~c&w)+1518500249):
40>a?f+((c^x^w)+1859775393):60>a?f+((c&x|c&w|x&w)-1894007588):f+((c^x^w)-899497514);b=w;w=x;x=c<<30|c>>>2;c=k;k=f}g[0]=g[0]+k|0;g[1]=g[1]+c|0;g[2]=g[2]+x|0;g[3]=g[3]+w|0;g[4]=g[4]+b|0},_doFinalize:function(){var d=this._data,e=d.words,g=8*this._nDataBytes,k=8*d.sigBytes;e[k>>>5]|=128<<24-k%32;e[(k+64>>>9<<4)+14]=Math.floor(g/4294967296);e[(k+64>>>9<<4)+15]=g;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d}});d.SHA1=
g._createHelper(k);d.HmacSHA1=g._createHmacHelper(k)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);
return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,h=this.sigBytes;a=a.sigBytes;this.clamp();if(h%4)for(var d=0;d<a;d++)b[h+d>>>2]|=(c[d>>>2]>>>24-d%4*8&255)<<24-(h+d)%4*8;else if(65535<c.length)for(d=0;d<a;d+=4)b[h+d>>>2]=c[d>>>
2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],h=0;h<a;h++){var d=b[h>>>2]>>>24-h%4*8&255;c.push((d>>>4).toString(16));c.push((d&
15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=
h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,
d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=d.words,k=d.sigBytes,q=this._map;d.clamp();d=[];for(var u=0;u<k;u+=3)for(var v=(g[u>>>2]>>>24-u%4*8&255)<<16|(g[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|g[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<k;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=
p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,b,a,f,d,h,e){c=c+(b&a|~b&f)+d+e;return(c<<h|c>>>32-h)+b}function e(c,b,a,f,d,h,e){c=c+(b&f|a&~f)+d+e;return(c<<h|c>>>32-h)+b}function g(c,b,a,f,d,h,e){c=c+(b^a^f)+d+e;return(c<<h|c>>>32-
h)+b}function p(c,b,a,f,d,h,e){c=c+(a^(b|~f))+d+e;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],q=d[b+3],r=d[b+4],v=d[b+5],u=d[b+6],x=d[b+
7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,q,22,c[3]);b=k(b,m,l,n,r,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,u,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);
n=e(n,b,m,l,u,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,r,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,q,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,r,11,c[37]);l=g(l,
n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,q,16,c[42]);m=g(m,l,n,b,u,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,q,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,u,15,c[58]);m=p(m,l,
n,b,B,21,c[59]);b=p(b,m,l,n,r,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var e=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;
for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var k=this.cfg,p=k.hasher.create(),c=g.create(),x=c.words,w=k.keySize,
k=k.iterations;x.length<w;){b&&p.update(b);var b=p.update(d).finalize(e);p.reset();for(var a=1;a<k;a++)b=p.finalize(b),p.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,
a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(c,d,e){return("string"==typeof d?f:a).encrypt(b,c,d,e)},decrypt:function(c,d,e){return("string"==typeof d?f:a).decrypt(b,
c,d,e)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,b,c){var f=this._iv;f?this._iv=d:f=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=f[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();w.Encryptor=w.extend({processBlock:function(a,b){var c=this._cipher,
f=c.blockSize;x.call(this,a,b,f);c.encryptBlock(a,b);this._prevBlock=a.slice(b,b+f)}});w.Decryptor=w.extend({processBlock:function(a,b){var c=this._cipher,f=c.blockSize,d=a.slice(b,b+f);c.decryptBlock(a,b);x.call(this,a,b,f);this._prevBlock=d}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,b){b*=4;b-=a.sigBytes%b;for(var c=b<<24|b<<16|b<<8|b,f=[],d=0;d<b;d+=4)f.push(c);b=p.create(f,b);a.concat(b)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,
padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var b=e.CipherParams=
g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(b):b).toString(u)},parse:function(a){a=u.parse(a);var c=a.words;if(1398893684==c[0]&&1701076831==c[1]){var f=p.create(c.slice(2,4));c.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:f})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),
encrypt:function(a,c,f,d){d=this.cfg.extend(d);var e=a.createEncryptor(f,d);c=e.finalize(c);e=e.cfg;return b.create({ciphertext:c,key:f,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:d.format})},decrypt:function(a,b,c,f){f=this.cfg.extend(f);b=this._parse(b,f.format);return a.createDecryptor(c,f).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,c,f,d){d||(d=p.random(8));a=v.create({keySize:c+
f}).compute(a,d);f=p.create(a.words.slice(c),4*f);a.sigBytes=4*c;return b.create({key:a,iv:f,salt:d})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(b,c,f,d){d=this.cfg.extend(d);f=d.kdf.execute(f,b.keySize,b.ivSize);d.iv=f.iv;b=a.encrypt.call(this,b,c,f.key,d);b.mixIn(f);return b},decrypt:function(b,c,f,d){d=this.cfg.extend(d);c=this._parse(c,d.format);f=d.kdf.execute(f,b.keySize,b.ivSize,c.salt);d.iv=f.iv;return a.decrypt.call(this,b,c,f.key,d)}})}();(function(){function d(){for(var d=
this._X,e=this._C,c=0;8>c;c++)p[c]=e[c];e[0]=e[0]+1295307597+this._b|0;e[1]=e[1]+3545052371+(e[0]>>>0<p[0]>>>0?1:0)|0;e[2]=e[2]+886263092+(e[1]>>>0<p[1]>>>0?1:0)|0;e[3]=e[3]+1295307597+(e[2]>>>0<p[2]>>>0?1:0)|0;e[4]=e[4]+3545052371+(e[3]>>>0<p[3]>>>0?1:0)|0;e[5]=e[5]+886263092+(e[4]>>>0<p[4]>>>0?1:0)|0;e[6]=e[6]+1295307597+(e[5]>>>0<p[5]>>>0?1:0)|0;e[7]=e[7]+3545052371+(e[6]>>>0<p[6]>>>0?1:0)|0;this._b=e[7]>>>0<p[7]>>>0?1:0;for(c=0;8>c;c++){var g=d[c]+e[c],k=g&65535,b=g>>>16;q[c]=((k*k>>>17)+k*b>>>
15)+b*b^((g&4294901760)*g|0)+((g&65535)*g|0)}d[0]=q[0]+(q[7]<<16|q[7]>>>16)+(q[6]<<16|q[6]>>>16)|0;d[1]=q[1]+(q[0]<<8|q[0]>>>24)+q[7]|0;d[2]=q[2]+(q[1]<<16|q[1]>>>16)+(q[0]<<16|q[0]>>>16)|0;d[3]=q[3]+(q[2]<<8|q[2]>>>24)+q[1]|0;d[4]=q[4]+(q[3]<<16|q[3]>>>16)+(q[2]<<16|q[2]>>>16)|0;d[5]=q[5]+(q[4]<<8|q[4]>>>24)+q[3]|0;d[6]=q[6]+(q[5]<<16|q[5]>>>16)+(q[4]<<16|q[4]>>>16)|0;d[7]=q[7]+(q[6]<<8|q[6]>>>24)+q[5]|0}var k=y,e=k.lib.StreamCipher,g=[],p=[],q=[],u=k.algo.Rabbit=e.extend({_doReset:function(){for(var e=
this._key.words,g=this.cfg.iv,c=0;4>c;c++)e[c]=(e[c]<<8|e[c]>>>24)&16711935|(e[c]<<24|e[c]>>>8)&4278255360;for(var k=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],e=this._C=[e[2]<<16|e[2]>>>16,e[0]&4294901760|e[1]&65535,e[3]<<16|e[3]>>>16,e[1]&4294901760|e[2]&65535,e[0]<<16|e[0]>>>16,e[2]&4294901760|e[3]&65535,e[1]<<16|e[1]>>>16,e[3]&4294901760|e[0]&65535],c=this._b=0;4>c;c++)d.call(this);for(c=0;8>c;c++)e[c]^=k[c+4&7];if(g){var c=g.words,
g=c[0],c=c[1],g=(g<<8|g>>>24)&16711935|(g<<24|g>>>8)&4278255360,c=(c<<8|c>>>24)&16711935|(c<<24|c>>>8)&4278255360,k=g>>>16|c&4294901760,p=c<<16|g&65535;e[0]^=g;e[1]^=k;e[2]^=c;e[3]^=p;e[4]^=g;e[5]^=k;e[6]^=c;e[7]^=p;for(c=0;4>c;c++)d.call(this)}},_doProcessBlock:function(e,k){var c=this._X;d.call(this);g[0]=c[0]^c[5]>>>16^c[3]<<16;g[1]=c[2]^c[7]>>>16^c[5]<<16;g[2]=c[4]^c[1]>>>16^c[7]<<16;g[3]=c[6]^c[3]>>>16^c[1]<<16;for(c=0;4>c;c++)g[c]=(g[c]<<8|g[c]>>>24)&16711935|(g[c]<<24|g[c]>>>8)&4278255360,
e[k+c]^=g[c]},blockSize:4,ivSize:2});k.Rabbit=e._createHelper(u)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&
(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},
clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=
a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,h=b.sigBytes,e=this.blockSize,g=h/(4*e),g=a?d.ceil(g):d.max((g|0)-this._minBufferSize,0);a=g*e;h=d.min(4*a,h);if(a){for(var k=0;k<a;k+=e)this._doProcessBlock(c,k);k=c.splice(0,a);b.sigBytes-=
h}return new u.init(k,h)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,
d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,k=k.x64={};k.Word=g.extend({init:function(d,e){this.high=d;this.low=e}});k.WordArray=g.extend({init:function(e,g){e=this.words=e||[];this.sigBytes=g!=d?g:8*e.length},toX32:function(){for(var d=this.words,e=d.length,g=[],k=0;k<e;k++){var c=d[k];g.push(c.high);g.push(c.low)}return p.create(g,this.sigBytes)},clone:function(){for(var d=g.clone.call(this),e=d.words=this.words.slice(0),
k=e.length,p=0;p<k;p++)e[p]=e[p].clone();return d}})})();(function(){function d(){return p.create.apply(p,arguments)}for(var k=y,e=k.lib.Hasher,g=k.x64,p=g.Word,q=g.WordArray,g=k.algo,u=[d(1116352408,3609767458),d(1899447441,602891725),d(3049323471,3964484399),d(3921009573,2173295548),d(961987163,4081628472),d(1508970993,3053834265),d(2453635748,2937671579),d(2870763221,3664609560),d(3624381080,2734883394),d(310598401,1164996542),d(607225278,1323610764),d(1426881987,3590304994),d(1925078388,4068182383),
d(2162078206,991336113),d(2614888103,633803317),d(3248222580,3479774868),d(3835390401,2666613458),d(4022224774,944711139),d(264347078,2341262773),d(604807628,2007800933),d(770255983,1495990901),d(1249150122,1856431235),d(1555081692,3175218132),d(1996064986,2198950837),d(2554220882,3999719339),d(2821834349,766784016),d(2952996808,2566594879),d(3210313671,3203337956),d(3336571891,1034457026),d(3584528711,2466948901),d(113926993,3758326383),d(338241895,168717936),d(666307205,1188179964),d(773529912,
1546045734),d(1294757372,1522805485),d(1396182291,2643833823),d(1695183700,2343527390),d(1986661051,1014477480),d(2177026350,1206759142),d(2456956037,344077627),d(2730485921,1290863460),d(2820302411,3158454273),d(3259730800,3505952657),d(3345764771,106217008),d(3516065817,3606008344),d(3600352804,1432725776),d(4094571909,1467031594),d(275423344,851169720),d(430227734,3100823752),d(506948616,1363258195),d(659060556,3750685593),d(883997877,3785050280),d(958139571,3318307427),d(1322822218,3812723403),
d(1537002063,2003034995),d(1747873779,3602036899),d(1955562222,1575990012),d(2024104815,1125592928),d(2227730452,2716904306),d(2361852424,442776044),d(2428436474,593698344),d(2756734187,3733110249),d(3204031479,2999351573),d(3329325298,3815920427),d(3391569614,3928383900),d(3515267271,566280711),d(3940187606,3454069534),d(4118630271,4000239992),d(116418474,1914138554),d(174292421,2731055270),d(289380356,3203993006),d(460393269,320620315),d(685471733,587496836),d(852142971,1086792851),d(1017036298,
365543100),d(1126000580,2618297676),d(1288033470,3409855158),d(1501505948,4234509866),d(1607167915,987167468),d(1816402316,1246189591)],v=[],r=0;80>r;r++)v[r]=d();g=g.SHA512=e.extend({_doReset:function(){this._hash=new q.init([new p.init(1779033703,4089235720),new p.init(3144134277,2227873595),new p.init(1013904242,4271175723),new p.init(2773480762,1595750129),new p.init(1359893119,2917565137),new p.init(2600822924,725511199),new p.init(528734635,4215389547),new p.init(1541459225,327033209)])},_doProcessBlock:function(c,
d){for(var e=this._hash.words,b=e[0],a=e[1],f=e[2],g=e[3],h=e[4],k=e[5],p=e[6],e=e[7],q=b.high,r=b.low,y=a.high,T=a.low,C=f.high,N=f.low,F=g.high,D=g.low,B=h.high,E=h.low,m=k.high,l=k.low,n=p.high,da=p.low,la=e.high,ea=e.low,K=q,G=r,X=y,V=T,Y=C,W=N,ia=F,Z=D,L=B,H=E,fa=m,aa=l,ga=n,ba=da,ja=la,ca=ea,M=0;80>M;M++){var R=v[M];if(16>M)var I=R.high=c[d+2*M]|0,z=R.low=c[d+2*M+1]|0;else{var I=v[M-15],z=I.high,O=I.low,I=(z>>>1|O<<31)^(z>>>8|O<<24)^z>>>7,O=(O>>>1|z<<31)^(O>>>8|z<<24)^(O>>>7|z<<25),U=v[M-2],
z=U.high,A=U.low,U=(z>>>19|A<<13)^(z<<3|A>>>29)^z>>>6,A=(A>>>19|z<<13)^(A<<3|z>>>29)^(A>>>6|z<<26),z=v[M-7],ka=z.high,S=v[M-16],P=S.high,S=S.low,z=O+z.low,I=I+ka+(z>>>0<O>>>0?1:0),z=z+A,I=I+U+(z>>>0<A>>>0?1:0),z=z+S,I=I+P+(z>>>0<S>>>0?1:0);R.high=I;R.low=z}var ka=L&fa^~L&ga,S=H&aa^~H&ba,R=K&X^K&Y^X&Y,na=G&V^G&W^V&W,O=(K>>>28|G<<4)^(K<<30|G>>>2)^(K<<25|G>>>7),U=(G>>>28|K<<4)^(G<<30|K>>>2)^(G<<25|K>>>7),A=u[M],oa=A.high,ma=A.low,A=ca+((H>>>14|L<<18)^(H>>>18|L<<14)^(H<<23|L>>>9)),P=ja+((L>>>14|H<<18)^
(L>>>18|H<<14)^(L<<23|H>>>9))+(A>>>0<ca>>>0?1:0),A=A+S,P=P+ka+(A>>>0<S>>>0?1:0),A=A+ma,P=P+oa+(A>>>0<ma>>>0?1:0),A=A+z,P=P+I+(A>>>0<z>>>0?1:0),z=U+na,R=O+R+(z>>>0<U>>>0?1:0),ja=ga,ca=ba,ga=fa,ba=aa,fa=L,aa=H,H=Z+A|0,L=ia+P+(H>>>0<Z>>>0?1:0)|0,ia=Y,Z=W,Y=X,W=V,X=K,V=G,G=A+z|0,K=P+R+(G>>>0<A>>>0?1:0)|0}r=b.low=r+G;b.high=q+K+(r>>>0<G>>>0?1:0);T=a.low=T+V;a.high=y+X+(T>>>0<V>>>0?1:0);N=f.low=N+W;f.high=C+Y+(N>>>0<W>>>0?1:0);D=g.low=D+Z;g.high=F+ia+(D>>>0<Z>>>0?1:0);E=h.low=E+H;h.high=B+L+(E>>>0<H>>>
0?1:0);l=k.low=l+aa;k.high=m+fa+(l>>>0<aa>>>0?1:0);da=p.low=da+ba;p.high=n+ga+(da>>>0<ba>>>0?1:0);ea=e.low=ea+ca;e.high=la+ja+(ea>>>0<ca>>>0?1:0)},_doFinalize:function(){var c=this._data,d=c.words,e=8*this._nDataBytes,b=8*c.sigBytes;d[b>>>5]|=128<<24-b%32;d[(b+128>>>10<<5)+30]=Math.floor(e/4294967296);d[(b+128>>>10<<5)+31]=e;c.sigBytes=4*d.length;this._process();return this._hash.toX32()},clone:function(){var c=e.clone.call(this);c._hash=this._hash.clone();return c},blockSize:32});k.SHA512=e._createHelper(g);
k.HmacSHA512=e._createHmacHelper(g)})();(function(){var d=y,k=d.enc.Utf8;d.algo.HMAC=d.lib.Base.extend({init:function(d,g){d=this._hasher=new d.init;"string"==typeof g&&(g=k.parse(g));var p=d.blockSize,q=4*p;g.sigBytes>q&&(g=d.finalize(g));g.clamp();d=this._oKey=g.clone();g=this._iKey=g.clone();for(var u=d.words,v=g.words,r=0;r<p;r++)u[r]^=1549556828,v[r]^=909522486;d.sigBytes=g.sigBytes=q;this.reset()},reset:function(){var d=this._hasher;d.reset();d.update(this._iKey)},update:function(d){this._hasher.update(d);
return this},finalize:function(d){var g=this._hasher;d=g.finalize(d);g.reset();return g.finalize(this._oKey.clone().concat(d))}})})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>
2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&
15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");
}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=
e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,
d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(){var d=y,k=d.lib.WordArray;d.enc.Base64={stringify:function(d){var g=d.words,k=d.sigBytes,q=this._map;d.clamp();d=[];for(var u=0;u<k;u+=3)for(var v=(g[u>>>2]>>>24-u%4*8&255)<<16|(g[u+1>>>2]>>>24-(u+1)%4*8&255)<<8|g[u+2>>>2]>>>24-(u+2)%4*8&255,r=0;4>r&&u+.75*r<k;r++)d.push(q.charAt(v>>>6*(3-r)&63));if(g=q.charAt(64))for(;d.length%4;)d.push(g);return d.join("")},parse:function(d){var g=d.length,p=this._map,q=
p.charAt(64);q&&(q=d.indexOf(q),-1!=q&&(g=q));for(var q=[],u=0,v=0;v<g;v++)if(v%4){var r=p.indexOf(d.charAt(v-1))<<v%4*2,c=p.indexOf(d.charAt(v))>>>6-v%4*2;q[u>>>2]|=(r|c)<<24-u%4*8;u++}return k.create(q,u)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d"}})();(function(d){function k(c,b,a,d,e,h,g){c=c+(b&a|~b&d)+e+g;return(c<<h|c>>>32-h)+b}function e(c,b,a,d,e,h,g){c=c+(b&d|a&~d)+e+g;return(c<<h|c>>>32-h)+b}function g(c,b,a,d,e,h,g){c=c+(b^a^d)+e+g;return(c<<h|c>>>32-
h)+b}function p(c,b,a,d,e,h,g){c=c+(a^(b|~d))+e+g;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,b){for(var a=0;16>a;a++){var f=b+a,t=d[f];d[f]=(t<<8|t>>>24)&16711935|(t<<24|t>>>8)&4278255360}var a=this._hash.words,f=d[b+0],t=d[b+1],h=d[b+2],q=d[b+3],r=d[b+4],u=d[b+5],v=d[b+6],x=d[b+
7],y=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,t,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,q,22,c[3]);b=k(b,m,l,n,r,7,c[4]);n=k(n,b,m,l,u,12,c[5]);l=k(l,n,b,m,v,17,c[6]);m=k(m,l,n,b,x,22,c[7]);b=k(b,m,l,n,y,7,c[8]);n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,t,5,c[16]);
n=e(n,b,m,l,v,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,u,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,r,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,q,14,c[26]);m=e(m,l,n,b,y,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,b,m,x,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,u,4,c[32]);n=g(n,b,m,l,y,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,t,4,c[36]);n=g(n,b,m,l,r,11,c[37]);l=g(l,
n,b,m,x,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,q,16,c[42]);m=g(m,l,n,b,v,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,x,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,b,u,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,q,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,t,21,c[55]);b=p(b,m,l,n,y,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,v,15,c[58]);m=p(m,l,
n,b,B,21,c[59]);b=p(b,m,l,n,r,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var e=d.floor(a/4294967296);b[(f+64>>>9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;
for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);(function(){var d=y,k=d.lib,e=k.Base,g=k.WordArray,k=d.algo,p=k.EvpKDF=e.extend({cfg:e.extend({keySize:4,hasher:k.MD5,iterations:1}),init:function(d){this.cfg=this.cfg.extend(d)},compute:function(d,e){for(var k=this.cfg,p=k.hasher.create(),c=g.create(),x=c.words,w=k.keySize,
k=k.iterations;x.length<w;){b&&p.update(b);var b=p.update(d).finalize(e);p.reset();for(var a=1;a<k;a++)b=p.finalize(b),p.reset();c.concat(b)}c.sigBytes=4*w;return c}});d.EvpKDF=function(d,e,g){return p.create(g).compute(d,e)}})();y.lib.Cipher||function(d){var k=y,e=k.lib,g=e.Base,p=e.WordArray,q=e.BufferedBlockAlgorithm,u=k.enc.Base64,v=k.algo.EvpKDF,r=e.Cipher=q.extend({cfg:g.extend(),createEncryptor:function(a,b){return this.create(this._ENC_XFORM_MODE,a,b)},createDecryptor:function(a,b){return this.create(this._DEC_XFORM_MODE,
a,b)},init:function(a,b,c){this.cfg=this.cfg.extend(c);this._xformMode=a;this._key=b;this.reset()},reset:function(){q.reset.call(this);this._doReset()},process:function(a){this._append(a);return this._process()},finalize:function(a){a&&this._append(a);return this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(b){return{encrypt:function(c,d,e){return("string"==typeof d?f:a).encrypt(b,c,d,e)},decrypt:function(c,d,e){return("string"==typeof d?f:a).decrypt(b,
c,d,e)}}}});e.StreamCipher=r.extend({_doFinalize:function(){return this._process(!0)},blockSize:1});var c=k.mode={},x=function(a,b,c){var f=this._iv;f?this._iv=d:f=this._prevBlock;for(var e=0;e<c;e++)a[b+e]^=f[e]},w=(e.BlockCipherMode=g.extend({createEncryptor:function(a,b){return this.Encryptor.create(a,b)},createDecryptor:function(a,b){return this.Decryptor.create(a,b)},init:function(a,b){this._cipher=a;this._iv=b}})).extend();w.Encryptor=w.extend({processBlock:function(a,b){var c=this._cipher,
d=c.blockSize;x.call(this,a,b,d);c.encryptBlock(a,b);this._prevBlock=a.slice(b,b+d)}});w.Decryptor=w.extend({processBlock:function(a,b){var c=this._cipher,d=c.blockSize,f=a.slice(b,b+d);c.decryptBlock(a,b);x.call(this,a,b,d);this._prevBlock=f}});c=c.CBC=w;w=(k.pad={}).Pkcs7={pad:function(a,b){b*=4;b-=a.sigBytes%b;for(var c=b<<24|b<<16|b<<8|b,d=[],f=0;f<b;f+=4)d.push(c);b=p.create(d,b);a.concat(b)},unpad:function(a){a.sigBytes-=a.words[a.sigBytes-1>>>2]&255}};e.BlockCipher=r.extend({cfg:r.cfg.extend({mode:c,
padding:w}),reset:function(){r.reset.call(this);var a=this.cfg,b=a.iv,a=a.mode;if(this._xformMode==this._ENC_XFORM_MODE)var c=a.createEncryptor;else c=a.createDecryptor,this._minBufferSize=1;this._mode=c.call(a,this,b&&b.words)},_doProcessBlock:function(a,b){this._mode.processBlock(a,b)},_doFinalize:function(){var a=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){a.pad(this._data,this.blockSize);var b=this._process(!0)}else b=this._process(!0),a.unpad(b);return b},blockSize:4});var b=e.CipherParams=
g.extend({init:function(a){this.mixIn(a)},toString:function(a){return(a||this.formatter).stringify(this)}}),c=(k.format={}).OpenSSL={stringify:function(a){var b=a.ciphertext;a=a.salt;return(a?p.create([1398893684,1701076831]).concat(a).concat(b):b).toString(u)},parse:function(a){a=u.parse(a);var c=a.words;if(1398893684==c[0]&&1701076831==c[1]){var d=p.create(c.slice(2,4));c.splice(0,4);a.sigBytes-=16}return b.create({ciphertext:a,salt:d})}},a=e.SerializableCipher=g.extend({cfg:g.extend({format:c}),
encrypt:function(a,c,d,f){f=this.cfg.extend(f);var e=a.createEncryptor(d,f);c=e.finalize(c);e=e.cfg;return b.create({ciphertext:c,key:d,iv:e.iv,algorithm:a,mode:e.mode,padding:e.padding,blockSize:a.blockSize,formatter:f.format})},decrypt:function(a,b,c,d){d=this.cfg.extend(d);b=this._parse(b,d.format);return a.createDecryptor(c,d).finalize(b.ciphertext)},_parse:function(a,b){return"string"==typeof a?b.parse(a,this):a}}),k=(k.kdf={}).OpenSSL={execute:function(a,c,d,f){f||(f=p.random(8));a=v.create({keySize:c+
d}).compute(a,f);d=p.create(a.words.slice(c),4*d);a.sigBytes=4*c;return b.create({key:a,iv:d,salt:f})}},f=e.PasswordBasedCipher=a.extend({cfg:a.cfg.extend({kdf:k}),encrypt:function(b,c,d,f){f=this.cfg.extend(f);d=f.kdf.execute(d,b.keySize,b.ivSize);f.iv=d.iv;b=a.encrypt.call(this,b,c,d.key,f);b.mixIn(d);return b},decrypt:function(b,c,d,f){f=this.cfg.extend(f);c=this._parse(c,f.format);d=f.kdf.execute(d,b.keySize,b.ivSize,c.salt);f.iv=d.iv;return a.decrypt.call(this,b,c,d.key,f)}})}();(function(){for(var d=
y,k=d.lib.BlockCipher,e=d.algo,g=[],p=[],q=[],u=[],v=[],r=[],c=[],x=[],w=[],b=[],a=[],f=0;256>f;f++)a[f]=128>f?f<<1:f<<1^283;for(var t=0,h=0,f=0;256>f;f++){var J=h^h<<1^h<<2^h<<3^h<<4,J=J>>>8^J&255^99;g[t]=J;p[J]=t;var ra=a[t],sa=a[ra],ha=a[sa],Q=257*a[J]^16843008*J;q[t]=Q<<24|Q>>>8;u[t]=Q<<16|Q>>>16;v[t]=Q<<8|Q>>>24;r[t]=Q;Q=16843009*ha^65537*sa^257*ra^16843008*t;c[J]=Q<<24|Q>>>8;x[J]=Q<<16|Q>>>16;w[J]=Q<<8|Q>>>24;b[J]=Q;t?(t=ra^a[a[a[ha^ra]]],h^=a[a[h]]):t=h=1}var T=[0,1,2,4,8,16,32,64,128,27,54],
e=e.AES=k.extend({_doReset:function(){for(var a=this._key,d=a.words,f=a.sigBytes/4,a=4*((this._nRounds=f+6)+1),e=this._keySchedule=[],h=0;h<a;h++)if(h<f)e[h]=d[h];else{var k=e[h-1];h%f?6<f&&4==h%f&&(k=g[k>>>24]<<24|g[k>>>16&255]<<16|g[k>>>8&255]<<8|g[k&255]):(k=k<<8|k>>>24,k=g[k>>>24]<<24|g[k>>>16&255]<<16|g[k>>>8&255]<<8|g[k&255],k^=T[h/f|0]<<24);e[h]=e[h-f]^k}d=this._invKeySchedule=[];for(f=0;f<a;f++)h=a-f,k=f%4?e[h]:e[h-4],d[f]=4>f||4>=h?k:c[g[k>>>24]]^x[g[k>>>16&255]]^w[g[k>>>8&255]]^b[g[k&255]]},
encryptBlock:function(a,b){this._doCryptBlock(a,b,this._keySchedule,q,u,v,r,g)},decryptBlock:function(a,d){var f=a[d+1];a[d+1]=a[d+3];a[d+3]=f;this._doCryptBlock(a,d,this._invKeySchedule,c,x,w,b,p);f=a[d+1];a[d+1]=a[d+3];a[d+3]=f},_doCryptBlock:function(a,b,c,d,f,e,h,g){for(var k=this._nRounds,p=a[b]^c[0],t=a[b+1]^c[1],q=a[b+2]^c[2],r=a[b+3]^c[3],u=4,w=1;w<k;w++)var v=d[p>>>24]^f[t>>>16&255]^e[q>>>8&255]^h[r&255]^c[u++],x=d[t>>>24]^f[q>>>16&255]^e[r>>>8&255]^h[p&255]^c[u++],y=d[q>>>24]^f[r>>>16&255]^
e[p>>>8&255]^h[t&255]^c[u++],r=d[r>>>24]^f[p>>>16&255]^e[t>>>8&255]^h[q&255]^c[u++],p=v,t=x,q=y;v=(g[p>>>24]<<24|g[t>>>16&255]<<16|g[q>>>8&255]<<8|g[r&255])^c[u++];x=(g[t>>>24]<<24|g[q>>>16&255]<<16|g[r>>>8&255]<<8|g[p&255])^c[u++];y=(g[q>>>24]<<24|g[r>>>16&255]<<16|g[p>>>8&255]<<8|g[t&255])^c[u++];r=(g[r>>>24]<<24|g[p>>>16&255]<<16|g[t>>>8&255]<<8|g[q&255])^c[u++];a[b]=v;a[b+1]=x;a[b+2]=y;a[b+3]=r},keySize:8});d.AES=k._createHelper(e)})();y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base=
{extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,
b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=
q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1=
{stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=
new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=
w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(d){function k(c,
b,a,d,e,h,g){c=c+(b&a|~b&d)+e+g;return(c<<h|c>>>32-h)+b}function e(c,b,a,d,e,h,g){c=c+(b&d|a&~d)+e+g;return(c<<h|c>>>32-h)+b}function g(c,b,a,d,e,h,g){c=c+(b^a^d)+e+g;return(c<<h|c>>>32-h)+b}function p(c,b,a,d,e,h,g){c=c+(a^(b|~d))+e+g;return(c<<h|c>>>32-h)+b}for(var q=y,u=q.lib,v=u.WordArray,r=u.Hasher,u=q.algo,c=[],x=0;64>x;x++)c[x]=4294967296*d.abs(d.sin(x+1))|0;u=u.MD5=r.extend({_doReset:function(){this._hash=new v.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(d,
b){for(var a=0;16>a;a++){var f=b+a,q=d[f];d[f]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}var a=this._hash.words,f=d[b+0],q=d[b+1],h=d[b+2],r=d[b+3],u=d[b+4],v=d[b+5],x=d[b+6],y=d[b+7],T=d[b+8],C=d[b+9],N=d[b+10],F=d[b+11],D=d[b+12],B=d[b+13],E=d[b+14];d=d[b+15];b=a[0];var m=a[1],l=a[2],n=a[3];b=k(b,m,l,n,f,7,c[0]);n=k(n,b,m,l,q,12,c[1]);l=k(l,n,b,m,h,17,c[2]);m=k(m,l,n,b,r,22,c[3]);b=k(b,m,l,n,u,7,c[4]);n=k(n,b,m,l,v,12,c[5]);l=k(l,n,b,m,x,17,c[6]);m=k(m,l,n,b,y,22,c[7]);b=k(b,m,l,n,T,7,c[8]);
n=k(n,b,m,l,C,12,c[9]);l=k(l,n,b,m,N,17,c[10]);m=k(m,l,n,b,F,22,c[11]);b=k(b,m,l,n,D,7,c[12]);n=k(n,b,m,l,B,12,c[13]);l=k(l,n,b,m,E,17,c[14]);m=k(m,l,n,b,d,22,c[15]);b=e(b,m,l,n,q,5,c[16]);n=e(n,b,m,l,x,9,c[17]);l=e(l,n,b,m,F,14,c[18]);m=e(m,l,n,b,f,20,c[19]);b=e(b,m,l,n,v,5,c[20]);n=e(n,b,m,l,N,9,c[21]);l=e(l,n,b,m,d,14,c[22]);m=e(m,l,n,b,u,20,c[23]);b=e(b,m,l,n,C,5,c[24]);n=e(n,b,m,l,E,9,c[25]);l=e(l,n,b,m,r,14,c[26]);m=e(m,l,n,b,T,20,c[27]);b=e(b,m,l,n,B,5,c[28]);n=e(n,b,m,l,h,9,c[29]);l=e(l,n,
b,m,y,14,c[30]);m=e(m,l,n,b,D,20,c[31]);b=g(b,m,l,n,v,4,c[32]);n=g(n,b,m,l,T,11,c[33]);l=g(l,n,b,m,F,16,c[34]);m=g(m,l,n,b,E,23,c[35]);b=g(b,m,l,n,q,4,c[36]);n=g(n,b,m,l,u,11,c[37]);l=g(l,n,b,m,y,16,c[38]);m=g(m,l,n,b,N,23,c[39]);b=g(b,m,l,n,B,4,c[40]);n=g(n,b,m,l,f,11,c[41]);l=g(l,n,b,m,r,16,c[42]);m=g(m,l,n,b,x,23,c[43]);b=g(b,m,l,n,C,4,c[44]);n=g(n,b,m,l,D,11,c[45]);l=g(l,n,b,m,d,16,c[46]);m=g(m,l,n,b,h,23,c[47]);b=p(b,m,l,n,f,6,c[48]);n=p(n,b,m,l,y,10,c[49]);l=p(l,n,b,m,E,15,c[50]);m=p(m,l,n,
b,v,21,c[51]);b=p(b,m,l,n,D,6,c[52]);n=p(n,b,m,l,r,10,c[53]);l=p(l,n,b,m,N,15,c[54]);m=p(m,l,n,b,q,21,c[55]);b=p(b,m,l,n,T,6,c[56]);n=p(n,b,m,l,d,10,c[57]);l=p(l,n,b,m,x,15,c[58]);m=p(m,l,n,b,B,21,c[59]);b=p(b,m,l,n,u,6,c[60]);n=p(n,b,m,l,F,10,c[61]);l=p(l,n,b,m,h,15,c[62]);m=p(m,l,n,b,C,21,c[63]);a[0]=a[0]+b|0;a[1]=a[1]+m|0;a[2]=a[2]+l|0;a[3]=a[3]+n|0},_doFinalize:function(){var c=this._data,b=c.words,a=8*this._nDataBytes,f=8*c.sigBytes;b[f>>>5]|=128<<24-f%32;var e=d.floor(a/4294967296);b[(f+64>>>
9<<4)+15]=(e<<8|e>>>24)&16711935|(e<<24|e>>>8)&4278255360;b[(f+64>>>9<<4)+14]=(a<<8|a>>>24)&16711935|(a<<24|a>>>8)&4278255360;c.sigBytes=4*(b.length+1);this._process();c=this._hash;b=c.words;for(a=0;4>a;a++)f=b[a],b[a]=(f<<8|f>>>24)&16711935|(f<<24|f>>>8)&4278255360;return c},clone:function(){var c=r.clone.call(this);c._hash=this._hash.clone();return c}});q.MD5=r._createHelper(u);q.HmacMD5=r._createHmacHelper(u)})(Math);y=y||function(d,k){var e={},g=e.lib={},p=function(){},q=g.Base={extend:function(a){p.prototype=
this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=
b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=
this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,b/2)}},c=v.Latin1={stringify:function(a){var b=
a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=q.extend({reset:function(){this._data=
new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();return a},_minBufferSize:0});g.Hasher=
w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=e.algo={};return e}(Math);(function(){var d=
y,k=d.lib,e=k.WordArray,g=k.Hasher,p=[],k=d.algo.SHA1=g.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(d,e){for(var g=this._hash.words,k=g[0],c=g[1],x=g[2],w=g[3],b=g[4],a=0;80>a;a++){if(16>a)p[a]=d[e+a]|0;else{var f=p[a-3]^p[a-8]^p[a-14]^p[a-16];p[a]=f<<1|f>>>31}f=(k<<5|k>>>27)+b+p[a];f=20>a?f+((c&x|~c&w)+1518500249):40>a?f+((c^x^w)+1859775393):60>a?f+((c&x|c&w|x&w)-1894007588):f+((c^x^w)-899497514);b=w;w=x;x=c<<
30|c>>>2;c=k;k=f}g[0]=g[0]+k|0;g[1]=g[1]+c|0;g[2]=g[2]+x|0;g[3]=g[3]+w|0;g[4]=g[4]+b|0},_doFinalize:function(){var d=this._data,e=d.words,g=8*this._nDataBytes,k=8*d.sigBytes;e[k>>>5]|=128<<24-k%32;e[(k+64>>>9<<4)+14]=Math.floor(g/4294967296);e[(k+64>>>9<<4)+15]=g;d.sigBytes=4*e.length;this._process();return this._hash},clone:function(){var d=g.clone.call(this);d._hash=this._hash.clone();return d}});d.SHA1=g._createHelper(k);d.HmacSHA1=g._createHmacHelper(k)})();y=y||function(d,k){var e={},g=e.lib=
{},p=function(){},q=g.Base={extend:function(a){p.prototype=this;var b=new p;a&&b.mixIn(a);b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)});b.init.prototype=b;b.$super=this;return b},create:function(){var a=this.extend();a.init.apply(a,arguments);return a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},u=g.WordArray=
q.extend({init:function(a,b){a=this.words=a||[];this.sigBytes=b!=k?b:4*a.length},toString:function(a){return(a||r).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;a=a.sigBytes;this.clamp();if(d%4)for(var e=0;e<a;e++)b[d+e>>>2]|=(c[e>>>2]>>>24-e%4*8&255)<<24-(d+e)%4*8;else if(65535<c.length)for(e=0;e<a;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);this.sigBytes+=a;return this},clamp:function(){var a=this.words,b=this.sigBytes;a[b>>>2]&=4294967295<<32-b%4*8;a.length=
d.ceil(b/4)},clone:function(){var a=q.clone.call(this);a.words=this.words.slice(0);return a},random:function(a){for(var b=[],c=0;c<a;c+=4)b.push(4294967296*d.random()|0);return new u.init(b,a)}}),v=e.enc={},r=v.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++){var e=b[d>>>2]>>>24-d%4*8&255;c.push((e>>>4).toString(16));c.push((e&15).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-d%8*4;return new u.init(c,
b/2)}},c=v.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;d<a;d++)c.push(String.fromCharCode(b[d>>>2]>>>24-d%4*8&255));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;d<b;d++)c[d>>>2]|=(a.charCodeAt(d)&255)<<24-d%4*8;return new u.init(c,b)}},x=v.Utf8={stringify:function(a){try{return decodeURIComponent(escape(c.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data");}},parse:function(a){return c.parse(unescape(encodeURIComponent(a)))}},w=g.BufferedBlockAlgorithm=
q.extend({reset:function(){this._data=new u.init;this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=x.parse(a));this._data.concat(a);this._nDataBytes+=a.sigBytes},_process:function(a){var b=this._data,c=b.words,e=b.sigBytes,g=this.blockSize,k=e/(4*g),k=a?d.ceil(k):d.max((k|0)-this._minBufferSize,0);a=k*g;e=d.min(4*a,e);if(a){for(var p=0;p<a;p+=g)this._doProcessBlock(c,p);p=c.splice(0,a);b.sigBytes-=e}return new u.init(p,e)},clone:function(){var a=q.clone.call(this);a._data=this._data.clone();
return a},_minBufferSize:0});g.Hasher=w.extend({cfg:q.extend(),init:function(a){this.cfg=this.cfg.extend(a);this.reset()},reset:function(){w.reset.call(this);this._doReset()},update:function(a){this._append(a);this._process();return this},finalize:function(a){a&&this._append(a);return this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return(new a.init(c)).finalize(b)}},_createHmacHelper:function(a){return function(c,d){return(new b.HMAC.init(a,d)).finalize(c)}}});var b=
e.algo={};return e}(Math);(function(d){for(var k=y,e=k.lib,g=e.WordArray,p=e.Hasher,e=k.algo,q=[],u=[],v=function(a){return 4294967296*(a-(a|0))|0},r=2,c=0;64>c;){var x;a:{x=r;for(var w=d.sqrt(x),b=2;b<=w;b++)if(!(x%b)){x=!1;break a}x=!0}x&&(8>c&&(q[c]=v(d.pow(r,.5))),u[c]=v(d.pow(r,1/3)),c++);r++}var a=[],e=e.SHA256=p.extend({_doReset:function(){this._hash=new g.init(q.slice(0))},_doProcessBlock:function(b,c){for(var d=this._hash.words,e=d[0],g=d[1],k=d[2],p=d[3],q=d[4],r=d[5],v=d[6],w=d[7],x=0;64>
x;x++){if(16>x)a[x]=b[c+x]|0;else{var y=a[x-15],B=a[x-2];a[x]=((y<<25|y>>>7)^(y<<14|y>>>18)^y>>>3)+a[x-7]+((B<<15|B>>>17)^(B<<13|B>>>19)^B>>>10)+a[x-16]}y=w+((q<<26|q>>>6)^(q<<21|q>>>11)^(q<<7|q>>>25))+(q&r^~q&v)+u[x]+a[x];B=((e<<30|e>>>2)^(e<<19|e>>>13)^(e<<10|e>>>22))+(e&g^e&k^g&k);w=v;v=r;r=q;q=p+y|0;p=k;k=g;g=e;e=y+B|0}d[0]=d[0]+e|0;d[1]=d[1]+g|0;d[2]=d[2]+k|0;d[3]=d[3]+p|0;d[4]=d[4]+q|0;d[5]=d[5]+r|0;d[6]=d[6]+v|0;d[7]=d[7]+w|0},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,
e=8*a.sigBytes;b[e>>>5]|=128<<24-e%32;b[(e+64>>>9<<4)+14]=d.floor(c/4294967296);b[(e+64>>>9<<4)+15]=c;a.sigBytes=4*b.length;this._process();return this._hash},clone:function(){var a=p.clone.call(this);a._hash=this._hash.clone();return a}});k.SHA256=p._createHelper(e);k.HmacSHA256=p._createHmacHelper(e)})(Math);(function(){var d=y,k=d.lib.WordArray,e=d.algo,g=e.SHA256,e=e.SHA224=g.extend({_doReset:function(){this._hash=new k.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,
3204075428])},_doFinalize:function(){var d=g._doFinalize.call(this);d.sigBytes-=4;return d}});d.SHA224=g._createHelper(e);d.HmacSHA224=g._createHmacHelper(e)})();return y})});
/* ******** */
/*
 2013-2015 Amazon.com. All Rights Reserved.
 Long.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 Derived from goog.math.Long from the Closure Library
 see: https://github.com/dcodeIO/Long.js for details
 ByteBuffer.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/ByteBuffer.js for details
 ProtoBuf.js (c) 2013 Daniel Wirtz <dcode@dcode.io>
 Released under the Apache License, Version 2.0
 see: https://github.com/dcodeIO/ProtoBuf.js for details
*/
(function(C){var n=window.AmazonUIPageJS||window.P,F=n._namespace||n.attributeErrors,A=F?F("CampfireDCMetrics_AUIBuild",""):n;A.guardFatal?A.guardFatal(C)(A,window):A.execute(function(){C(A,window)})})(function(C,n,F){C.when("Long","ByteBuffer","ProtoBuf").register("3p-Dcm",function(A,f,B){(function(f){function d(a){this.totalElapsedTime=this.lastUpdatedTime=this.totalSamplesCount=this.runningCount=0;this.allowRunningTimers=a||!1;return this}function m(a,b,e,c){if("COUNTER"!==c&&"TIMER"!==c&&"STRING"!==
c&&"CLICKSTREAM"!==c)throw"MetricDataPoint: Type not Recognized";if(0>e)throw"MetricDataPoint: samples \x3c 0";this.name=a;this.value=b;this.samples=e;this.type=c;return this}function a(){try{return"localStorage"in n&&null!==n.localStorage&&localStorage}catch(a){return!1}}function c(a,b,e,c){this.program=a;this.source=b;this.dataPoints=e;this.timeStamp=c}function e(a,e,c,k,u){b(e);b(c);var p=e+"_"+c+"_DEVICE_CLIENT_METRICS_LOCAL_KEYS_"+a,l=k||f.MetricEventType.DEFAULT,z=u||!0,t={},q={},w={},E={},
n=function(a){b(a);a=q[a];null==a&&(a=new d(z));return a};this.updateLocalStorage=function(a){g.updateKeyValuePair(p,a,this.getDataPoint(a))};this.getProgram=function(){return e};this.getSource=function(){return c};this.getType=function(){return l};this.incrementCounter=function(a,e){e=e||1;b(a);h(e);t[a]=e+(t[a]&&null!=t[a]?t[a]:0);this.updateLocalStorage(a);return this};this.removeCounter=function(a){b(a);t[a]=null;this.updateLocalStorage(a);return this};this.addTimer=function(a,e,c){b(a);q[a]=
n(a).addTime(e,c);this.updateLocalStorage(a);return this};this.startTimer=function(a,e){b(a);if(q[a]&&null!=q[a]&&e&&0<q[a].runningCount)return this;q[a]=n(a).startTimer();return this};this.stopTimer=function(a){b(a);return null!=q[a]&&0<q[a].runningCount?(q[a].stopTimer(),this.updateLocalStorage(a),this):null};this.removeTimer=function(a){b(a);q[a]=null;this.updateLocalStorage(a);return this};this.appendStrings=function(a,e){b(a);e instanceof Array||(e=[e]);null==w[a]&&(w[a]=[]);w[a]=w[a].concat(e);
this.updateLocalStorage(a);return this};this.appendString=function(a,e){b(a);b(e);null==w[a]&&(w[a]=[]);w[a].push(e);this.updateLocalStorage(a);return this};this.removeString=function(a){w[a]=null;this.updateLocalStorage(a);return this};this.clear=function(){t={};q={};w={};g.clearLocalStorage(p);return this};this.addDataPoint=function(a){if(a&&null!=a){switch(a.type){case f.MetricDataPointType.COUNTER:this.incrementCounter(a.name,parseFloat(a.value));break;case f.MetricDataPointType.TIMER:l==f.MetricEventType.AGGREGATING?
this.addTimer(a.name,1E3*parseFloat(a.value),a.samples):l==f.MetricEventType.AVERAGING&&this.addTimer(a.name,1E3*parseFloat(a.value)*a.samples,a.samples);break;case f.MetricDataPointType.STRING:this.appendStrings(a.name,a.value);break;case f.MetricDataPointType.CLICKSTREAM:this.addClickStreamData(a.name,a.value);break;default:throw"Invalid MetricDataPointType";}return this}};this.addDataPoints=function(a){if(a instanceof Array)for(var b in a)this.addDataPoint(a[b]);return this};this.getDataPoint=
function(a){b(a);var e=null;a in t&&(e=new m(a,t[a].toString(),1,f.MetricDataPointType.COUNTER));if(a in q){if(null!=e)throw"Name Used For Multiple MetricDataPoint Types";if(l===f.MetricEventType.AGGREGATING)e=new m(a,q[a].getElapsedTime().toString()/1E3,q[a].getSamples(),f.MetricDataPointType.TIMER);else if(l===f.MetricEventType.AVERAGING)e=q[a].getElapsedTime()/q[a].getSamples(),e=new m(a,e.toString()/1E3,q[a].getSamples(),f.MetricDataPointType.TIMER);else throw"Unknown Metric Event Type";}if(a in
w){if(null!=e)throw"Name Used For Multiple MetricDataPoint Types";e=new m(a,w[a],1,f.MetricDataPointType.STRING)}if(a in E){if(null!=e)throw"Name Used For Multiple MetricDataPoint Types";e=new m(a,E[a],1,f.MetricDataPointType.CLICKSTREAM)}return e};this.getAllDataPoints=function(){var a=[],b;for(b in t)a.push(new m(b,t[b].toString(),1,f.MetricDataPointType.COUNTER));for(b in q)if(0!=q[b].getSamples()){var e;if(l===f.MetricEventType.AGGREGATING)e=new m(b,(q[b].getElapsedTime()/1E3).toString(),q[b].getSamples(),
f.MetricDataPointType.TIMER);else if(l===f.MetricEventType.AVERAGING)e=q[b].getElapsedTime()/q[b].getSamples(),e=new m(b,(e/1E3).toString(),q[b].getSamples(),f.MetricDataPointType.TIMER);else throw"Unknown Metric Event Type";a.push(e)}for(b in w)a.push(new m(b,w[b],1,f.MetricDataPointType.STRING));for(b in E)a.push(new m(b,E[b],1,f.MetricDataPointType.CLICKSTREAM));return a};this.addDataPoints(g.getValues(p));return this}var b=function(a){if(!a||null==a||"string"!=typeof a||0==a.length)throw"String formatted incorrectly";
},h=function(a){if(!a||null==a||a!==parseInt(a))throw"Int formatted incorrectly";},k=function(){var a=navigator.userAgent,b,e=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(e[1]))return b=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(b[1]||"");if("Chrome"===e[1]&&(b=a.match(/\bOPR\/(\d+)/),null!=b))return"Opera "+b[1];e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"];null!=(b=a.match(/version\/(\d+)/i))&&e.splice(1,1,b[1]);return e[0]},p=function(){var a=
navigator.userAgent,b,e=a.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(e[1]))return b=/\brv[ :]+(\d+)/g.exec(a)||[],"IE "+(b[1]||"");if("Chrome"===e[1]&&(b=a.match(/\bOPR\/(\d+)/),null!=b))return"Opera "+b[1];e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"];null!=(b=a.match(/version\/(\d+)/i))&&e.splice(1,1,b[1]);return e[1]},l=!0;d.prototype.startTimer=function(){var a=(new Date).getTime();0<this.runningCount&&(this.totalElapsedTime+=
this.runningCount*(a-this.lastUpdatedTime));this.lastUpdatedTime=a;this.runningCount++;return this};d.prototype.stopTimer=function(){var a=(new Date).getTime();0<this.runningCount&&(this.totalElapsedTime+=this.runningCount*(a-this.lastUpdatedTime),this.runningCount--,this.lastUpdatedTime=a,this.totalSamplesCount++);return this};d.prototype.addTime=function(a,b){this.totalElapsedTime+=a;this.totalSamplesCount+=b;return this};d.prototype.getElapsedTime=function(){if(!this.allowRunningTimers&&0<this.runningCount)throw"Cannot get elapsed time - "+
this.runningCount+" start calls not matched with stop.";return this.totalElapsedTime};d.prototype.getSamples=function(){return this.totalSamplesCount};d.prototype.getRunningTimersCount=function(){return this.runningCount};var g=function(){var b={};b.isLocalStorageEnabled=a();b.getValues=function(a){a=JSON.parse(localStorage.getItem(a));var b=[],e;for(e in a)null!=localStorage.getItem(a[e])&&b.push(JSON.parse(localStorage.getItem(a[e])));return b};b.updateKeys=function(a,b,e){if(this.isLocalStorageEnabled){e=
e||!1;var c=JSON.parse(localStorage.getItem(a));null==c&&(c=[]);if(-1!=c.indexOf(b)&&e){temp=[];for(var h in c)c[h]!==b&&_temp.push(c[h]);localStorage.setItem(a,JSON.stringify(_temp))}else-1!=c.indexOf(b)||e||(c.push(b),localStorage.setItem(a,JSON.stringify(c)))}};b.updateKeyValuePair=function(a,b,e){if(!b||null==b)throw"_Key cannot be null";e=e||null;this.updateKeys(a,b,null==e);null==e?localStorage.removeItem(b):localStorage.setItem(b,JSON.stringify(e))};b.clearLocalStorage=function(a){var b=JSON.parse(localStorage.getItem(a)),
e;for(e in b)localStorage.removeItem(b[e]);localStorage.removeItem(a)};return b}(),u=function(){var a=n.dcodeIO.ProtoBuf.loadProto("message MetricBatchMessage {                            required string deviceSerialNumber \x3d 1;                            optional string deviceType \x3d 2;                            optional string tag \x3d 3;                            repeated KeyValue metadata \x3d 4;                            repeated MetricEntryMessage metricEntry \x3d 5;                        }                        message MetricEntryMessage {                            required int64 timestamp \x3d 1;                            required string program \x3d 2;                            required string source \x3d 3;                            repeated DataPointMessage dataPoint \x3d 4;                        }                        message DataPointMessage {                            required string name \x3d 1;                            required string value \x3d 2;                            required int32 SampleSize \x3d 3;                                                        enum DataType {                                COUNTER \x3d 0;                                TIMER \x3d 1;                                DISCRETE \x3d 2;                                CLICKSTREAM \x3d 3;                            }                            required DataType type \x3d 4;                        }                        message KeyValue {                            required string key \x3d 1;                            required string value \x3d 2;                        }"),
b=a.result.MetricBatchMessage,e=a.result.MetricEntryMessage,c=a.result.DataPointMessage,h=a.result.KeyValue,g=function(a,b,e,c){a=new Uint8Array(a);var h=b();null==h?(b="x-credential-token",h=f.MetricsConfiguration.getSecondaryUrlEndpoint()):(b="x-amz-access-token",e=h,h=f.MetricsConfiguration.getPrimaryUrlEndpoint());var g=new XMLHttpRequest;g.open("POST",h,!0);g.setRequestHeader("Content-type","application/octect-stream");g.setRequestHeader(b,e);g.setRequestHeader("x-codec-version","1.0");g.setRequestHeader("x-codec-format",
"ProtocolBuffers");g.onreadystatechange=function(){l&&console.log("Response Status: "+g.status);"function"===typeof c&&c(g.status)};g.send(a);b=e="";for(h=0;h<a.length;h++)0==h%10&&(e+="\n"+b+"\n\n",b=""),e+=(1==a[h].toString(16).length?"0":"")+a[h].toString(16)+" ",b=10==a[h]||13==a[h]?b+"?  ":b+(String.fromCharCode(a[h])+"  ");e+="\n"+b;l&&console.log("Upload Metrics Request Sent")},k={packData:function(a,g,k,d){if(0!=a.length){var u=[],m=[],p;for(p in g)u.push(new h(p,g[p]));for(var x in a){g=
[];p=a[x];var l=p.dataPoints||[];if(0!=l.length){for(var r in l)if(l[r].type===f.MetricDataPointType.CLICKSTREAM)u.push(new h(l[r].name,l[r].value));else{var n;switch(l[r].type){case f.MetricDataPointType.COUNTER:n=c.DataType.COUNTER;break;case f.MetricDataPointType.TIMER:n=c.DataType.TIMER;break;case f.MetricDataPointType.STRING:n=c.DataType.DISCRETE;break;case f.MetricDataPointType.CLICKSTREAM:n=c.DataType.CLICKSTREAM;break;default:throw"PackData: Type Not Recognized";}g.push(new c(l[r].name,l[r].value.toString(),
l[r].samples,n))}m.push(new e(p.timeStamp,p.program,p.source,g))}}return(new b(k,d,"0",u,m)).encode().toArrayBuffer()}},publish:function(a,b,e,c,h,d){g(k.packData(a,b,e,c),h,c,d)}};return k}();f.MetricsConfiguration=function(){var a={primaryUrlEndpoint:"https://device-metrics-us.amazon.com:443/metricsBatch",secondaryUrlEndpoint:"https://device-metrics-us-2.amazon.com:443/metricsBatch"},e={maxBatchQueueCapacityBytes:5242880,maxBatchQueueEntries:2048,transmissionPeriodMillis:6E5},c={maxSizePerBatchBytes:65536,
maxBatchQueueEntries:2048,transmissionPeriodMillis:18E4},g={setPrimaryUrlEndpoint:function(a){b(a);g.networkConfiguration.primaryUrlEndpoint=a},setSecondaryUrlEndpoint:function(a){b(a);g.networkConfiguration.secondaryUrlEndpoint=a},getPrimaryUrlEndpoint:function(){return a.primaryUrlEndpoint},getSecondaryUrlEndpoint:function(){return a.secondaryUrlEndpoint},configureNormalPipeline:function(a,b,c){h(a);h(b);h(c);if(6E4>c)throw"If you really need to upload metrics more than once every minute, simply use a manual call to MetricsFactory.uploadMetrics()";
e.maxBatchQueueCapacityBytes=a;e.maxBatchQueueEntries=b;e.transmissionPeriodMillis=c},configureHighPipeline:function(a,b,e){h(a);h(b);h(e);if(6E4>e)throw"If you really need to upload metrics more than once every minute, simply use a manual call to MetricsFactory.uploadMetrics()";c.maxBatchQueueCapacityBytes=a;c.maxBatchQueueEntries=b;c.transmissionPeriodMillis=e},getMaxBatchQueueCapacityBytes:function(a){if(a===f.MetricPriority.NORMAL)return e.maxBatchQueueCapacityBytes;if(a===f.MetricPriority.HIGH)return c.maxBatchQueueCapacityBytes;
throw"Unrecognized priority: \x3c"+a+"\x3e";},getMaxBatchQueueEntries:function(a){if(a===f.MetricPriority.NORMAL)return e.maxBatchQueueEntries;if(a===f.MetricPriority.HIGH)return c.maxBatchQueueEntries;throw"Unrecognized priority: \x3c"+a+"\x3e";},getTransmissionPeriodMillis:function(a){if(a===f.MetricPriority.NORMAL)return e.transmissionPeriodMillis;if(a===f.MetricPriority.HIGH)return c.transmissionPeriodMillis;throw"Unrecognized priority: \x3c"+a+"\x3e";},setLogEnabled:function(a){l=a}};return g}();
f.MetricMetadata={MODEL:"model",PLATFORM:"platform",SOFTWARE_VERSION:"softwareVersion",COUNTRY_OF_RESIDENCE:"countryOfResidence",PREFERRED_MARKETPLACE:"MarketplaceID",DEVICE_LANGUAGE:"deviceLanguage",SESSION_ID:"Session",CUSTOMER_ID:"CustomerId",USER_AGENT:"HTTP_USER_AGENT",REMOTE_IP:"REMOTE_ADDR",PAGE_TYPE:"page-type",HIT_TYPE:"hitType",TEAM_NAME:"team-name",SITE_VARIANT:"site_variant",PAGE_ACTION:"page-action",SUB_PAGE_TYPE:"sub-page-type",PAGE_TYPE_ID:"page-type-id",TAB_ID:"tab-id",PAGE_ASSEMBLY_TYPE:"pageAssemblyType",
IS_CUSTOMER_HIT:"is-customer-hit",IS_PRIME_CUSTOMER:"is-prime-customer",GROUPING_ASIN:"groupingASIN",PRODUCT_GLID:"ProductGlId",IMPRESSION_PROGRAM_GROUP:"programGroup",IMPRESSION_TYPE:"impressionType",IMPRESSION_DATA:"impressionData",IMPRESSION_METADATA:"impressionMetadata",ECOMMERCE_PAGE_ACTION:"ecommerce-page-action",ORDER_DATA:"order-data",IS_PRIME_ELIGIBLE_ITEM:"is-prime-eligible-item",IS_GLANCE_VIEW:"is-glance-view",CUSTOMER_ID_KEY:"CMICustomerID",SESSION_ID_KEY:"CMISessionID",contains:function(a){for(var b in f.MetricMetadata)if(a===
f.MetricMetadata[b])return!0;return!1}};f.MetricPriority={NORMAL:"NORMAL",HIGH:"HIGH"};f.MetricEventType={AVERAGING:"AVERAGING",AGGREGATING:"AGGREGATING",DEFAULT:"AGGREGATING"};f.MetricDataPointType={COUNTER:"COUNTER",TIMER:"TIMER",STRING:"STRING",CLICKSTREAM:"CLICKSTREAM"};f.MetricsFactory=function(){var h={},g=null,d=null,m=null,v=!1,r={setDeviceTypeId:function(a){b(a);m=a},setDeviceSerialNumber:function(a){if("string"!==typeof a)throw"MetricsFactory: _deviceSerialNumber must be a function";d=a},
setOAuthTokenProvider:function(a){if("function"!==typeof a)throw"MetricsFactory: _ouathTokenProvider must be a function";g=a},createMetricEvent:function(a,b,c,h,g){return new e(a,b,c,h,g)},recordMetricEvent:function(a,b){if(!(a instanceof e))throw"MetricsFactory: _metricEvent must be an instance of MetricEvent";b=b||f.MetricPriority.NORMAL;var g=b===f.MetricPriority.HIGH?"METRICS_FACTORY_CRITICAL_RECORD_KEY":"METRICS_FACTORY_DEFAULT_RECORD_KEY",k=b===f.MetricPriority.HIGH?"METRICS_FACTORY_CRITICAL_COUNT_KEY":
"METRICS_FACTORY_DEFAULT_COUNT_KEY",d=b===f.MetricPriority.HIGH?"METRICS_FACTORY_CRITICAL_BUFFER_SIZE_KEY":"METRICS_FACTORY_DEFAULT_BUFFER_SIZE_KEY",m=a.getAllDataPoints();if(0<m.length){var p=JSON.parse(localStorage.getItem(g))||[],z=parseInt(localStorage.getItem(d)||"0")+(new Uint8Array(u.packData([a],h,"",""))).length,l=parseInt(localStorage.getItem(k)||"0")+m.length;z>f.MetricsConfiguration.getMaxBatchQueueCapacityBytes(b)||l>f.MetricsConfiguration.getMaxBatchQueueEntries(b)?v?n.setTimeout(function(){r.recordMetricEvent(a,
b)},1E4):(v=!0,B(function(b){b=JSON.parse(localStorage.getItem(g))||[];b.push(new c(a.getProgram(),a.getSource(),a.getAllDataPoints(),(new Date).getTime()/1E3));localStorage.setItem(g,JSON.stringify(b));localStorage.setItem(d,z-parseInt(localStorage.getItem(d)||"0"));localStorage.setItem(k,l-parseInt(localStorage.getItem(k)||"0"));a.clear();v=!1},[g])):(p.push(new c(a.getProgram(),a.getSource(),a.getAllDataPoints(),(new Date).getTime()/1E3)),localStorage.setItem(g,JSON.stringify(p)),localStorage.setItem(d,
z),localStorage.setItem(k,l),a.clear())}}},B=function(a,b){if(!m||null==m)throw"Failed to upload metrics: DeviceTypeId must be set.";if(null==d)throw"Failed to upload metrics: DeviceSerialNumber must be set.";if(!g||null==g)throw"Failed to upload metrics: OAuthTokenProvider must be set.";if(!(b instanceof Array))throw"Failed to upload metrics: _recordKeys must be an Array";var e=[],c;for(c in b)var k=JSON.parse(localStorage.getItem(b[c]))||[],e=e.concat(k);0<e.length?u.publish(e,h,d,m,g,function(e){if(200==
e)for(var c in b)localStorage.removeItem(b[c]);a&&a()}):v=!1};r.uploadMetrics=function(){v?n.setTimeout(r.uploadMetrics,1E4):(v=!0,B(function(){v=!1},["METRICS_FACTORY_DEFAULT_RECORD_KEY","METRICS_FACTORY_CRITICAL_RECORD_KEY"]))};r.addMetadata=function(a,b){if(!f.MetricMetadata.contains(a))throw"Unknown Metadata Key. Please add as Clickstream Event";h[a]=b};r.removeMetadata=function(a){h[a]=null};r.addMetadata(f.MetricMetadata.PLATFORM,k());r.addMetadata(f.MetricMetadata.SOFTWARE_VERSION,p());var z=
function(){if(a()){var b=parseInt(localStorage.getItem("TRANSMISSION_TIMESTAMP_NORMAL")||"0"),e=(new Date).getTime(),c=f.MetricsConfiguration.getTransmissionPeriodMillis(f.MetricPriority.NORMAL);e-b>c?v?(l&&console.log("Waiting: Normal Timer"),n.setTimeout(z,1E4)):(0<b&&(v=!0,B(function(){v=!1},["METRICS_FACTORY_DEFAULT_RECORD_KEY"])),localStorage.setItem("TRANSMISSION_TIMESTAMP_NORMAL",e),l&&console.log("Started Normal Timer"),n.setTimeout(z,c)):(n.setTimeout(z,c-(e-b)),l&&console.log("Restarted Normal Timer"))}},
t=function(){if(a()){var b=parseInt(localStorage.getItem("TRANSMISSION_TIMESTAMP_HIGH")||"0"),e=(new Date).getTime(),c=f.MetricsConfiguration.getTransmissionPeriodMillis(f.MetricPriority.HIGH);e-b>c?v?(l&&console.log("Waiting: High Timer"),n.setTimeout(t,1E4)):(0<b&&(v=!0,B(function(){v=!1},["METRICS_FACTORY_CRITICAL_RECORD_KEY"])),localStorage.setItem("TRANSMISSION_TIMESTAMP_HIGH",e),n.setTimeout(t,c),l&&console.log("Started High Timer")):(n.setTimeout(t,c-(e-b)),l&&console.log("Restarted High Timer"))}};
n.setTimeout(z,1E4);n.setTimeout(t,1E4);return r}()})(this);return this});C.register("Long",function(){(function(A){var f=function(a,b,c){a&&"object"===typeof a&&(b=a.high,c=a.unsigned,a=a.low);this.low=a|0;this.high=b|0;this.unsigned=!!c},B={},G={};f.fromInt=function(a,b){if(b){a>>>=0;if(0<=a&&256>a&&(b=G[a]))return b;b=new f(a,0>(a|0)?-1:0,!0);0<=a&&256>a&&(G[a]=b)}else{a|=0;if(-128<=a&&128>a&&(b=B[a]))return b;b=new f(a,0>a?-1:0,!1);-128<=a&&128>a&&(B[a]=b)}return b};f.fromNumber=function(e,b){b=
!!b;return isNaN(e)||!isFinite(e)?f.ZERO:!b&&e<=-a?f.MIN_SIGNED_VALUE:b&&0>=e?f.MIN_UNSIGNED_VALUE:!b&&e+1>=a?f.MAX_SIGNED_VALUE:b&&e>=m?f.MAX_UNSIGNED_VALUE:0>e?f.fromNumber(-e,!1).negate():new f(e%d|0,e/d|0,b)};f.fromBits=function(a,b,c){return new f(a,b,c)};f.from28Bits=function(a,b,c,k){return f.fromBits(a|b<<28,b>>>4|c<<24,k)};f.fromString=function(a,b,c){if(0==a.length)throw Error("number format error: empty string");if("NaN"===a||"Infinity"===a||"+Infinity"===a||"-Infinity"===a)return f.ZERO;
"number"===typeof b&&(c=b,b=!1);c=c||10;if(2>c||36<c)throw Error("radix out of range: "+c);if("-"==a.charAt(0))return f.fromString(a.substring(1),b,c).negate();if(0<=a.indexOf("-"))throw Error('number format error: interior "-" character: '+a);for(var k=f.fromNumber(Math.pow(c,8)),d=f.ZERO,m=0;m<a.length;m+=8){var g=Math.min(8,a.length-m),u=parseInt(a.substring(m,m+g),c);8>g?(g=f.fromNumber(Math.pow(c,g)),d=d.multiply(g).add(f.fromNumber(u))):(d=d.multiply(k),d=d.add(f.fromNumber(u)))}d.unsigned=
b;return d};var d=4294967296,m=d*d,a=m/2,c=f.fromInt(16777216);f.ZERO=f.fromInt(0);f.UZERO=f.fromInt(0,!0);f.ONE=f.fromInt(1);f.UONE=f.fromInt(1,!0);f.NEG_ONE=f.fromInt(-1);f.MAX_SIGNED_VALUE=f.fromBits(-1,2147483647,!1);f.MAX_UNSIGNED_VALUE=f.fromBits(-1,-1,!0);f.MAX_VALUE=f.MAX_SIGNED_VALUE;f.MIN_SIGNED_VALUE=f.fromBits(0,-2147483648,!1);f.MIN_UNSIGNED_VALUE=f.fromBits(0,0,!0);f.MIN_VALUE=f.MIN_SIGNED_VALUE;f.prototype.toInt=function(){return this.unsigned?this.low>>>0:this.low};f.prototype.toNumber=
function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)};f.prototype.toString=function(a){a=a||10;if(2>a||36<a)throw Error("radix out of range: "+a);if(this.isZero())return"0";var b;if(this.isNegative()){if(this.equals(f.MIN_SIGNED_VALUE)){b=f.fromNumber(a);var c=this.div(b);b=c.multiply(b).subtract(this);return c.toString(a)+b.toInt().toString(a)}return"-"+this.negate().toString(a)}c=f.fromNumber(Math.pow(a,6));b=this;for(var d="";;){var m=b.div(c),l=b.subtract(m.multiply(c)).toInt().toString(a);
b=m;if(b.isZero())return l+d;for(;6>l.length;)l="0"+l;d=""+l+d}};f.prototype.getHighBits=function(){return this.high};f.prototype.getHighBitsUnsigned=function(){return this.high>>>0};f.prototype.getLowBits=function(){return this.low};f.prototype.getLowBitsUnsigned=function(){return this.low>>>0};f.prototype.getNumBitsAbs=function(){if(this.isNegative())return this.equals(f.MIN_SIGNED_VALUE)?64:this.negate().getNumBitsAbs();for(var a=0!=this.high?this.high:this.low,b=31;0<b&&0==(a&1<<b);b--);return 0!=
this.high?b+33:b+1};f.prototype.isZero=function(){return 0==this.high&&0==this.low};f.prototype.isNegative=function(){return!this.unsigned&&0>this.high};f.prototype.isOdd=function(){return 1==(this.low&1)};f.prototype.isEven=function(){return 0==(this.low&1)};f.prototype.equals=function(a){return this.unsigned!=a.unsigned&&this.high>>>31!=a.high>>>31?!1:this.high==a.high&&this.low==a.low};f.prototype.notEquals=function(a){return!this.equals(a)};f.prototype.lessThan=function(a){return 0>this.compare(a)};
f.prototype.lessThanOrEqual=function(a){return 0>=this.compare(a)};f.prototype.greaterThan=function(a){return 0<this.compare(a)};f.prototype.greaterThanOrEqual=function(a){return 0<=this.compare(a)};f.prototype.compare=function(a){if(this.equals(a))return 0;var b=this.isNegative(),c=a.isNegative();return b&&!c?-1:!b&&c?1:this.unsigned?a.high>>>0>this.high>>>0||a.high==this.high&&a.low>>>0>this.low>>>0?-1:1:this.subtract(a).isNegative()?-1:1};f.prototype.negate=function(){return!this.unsigned&&this.equals(f.MIN_SIGNED_VALUE)?
f.MIN_SIGNED_VALUE:this.not().add(f.ONE)};f.prototype.add=function(a){var b=this.high>>>16,c=this.high&65535,d=this.low>>>16,m=a.high>>>16,l=a.high&65535,g=a.low>>>16;a=0+((this.low&65535)+(a.low&65535));g=0+(a>>>16)+(d+g);d=0+(g>>>16);d+=c+l;b=0+(d>>>16)+(b+m)&65535;return f.fromBits((g&65535)<<16|a&65535,b<<16|d&65535,this.unsigned)};f.prototype.subtract=function(a){return this.add(a.negate())};f.prototype.multiply=function(a){if(this.isZero()||a.isZero())return f.ZERO;if(this.equals(f.MIN_VALUE))return a.isOdd()?
f.MIN_VALUE:f.ZERO;if(a.equals(f.MIN_VALUE))return this.isOdd()?f.MIN_VALUE:f.ZERO;if(this.isNegative())return a.isNegative()?this.negate().multiply(a.negate()):this.negate().multiply(a).negate();if(a.isNegative())return this.multiply(a.negate()).negate();if(this.lessThan(c)&&a.lessThan(c))return f.fromNumber(this.toNumber()*a.toNumber(),this.unsigned);var b=this.high>>>16,h=this.high&65535,d=this.low>>>16,m=this.low&65535,l=a.high>>>16,g=a.high&65535,u=a.low>>>16;a=a.low&65535;var x,y,D,n;n=0+m*
a;D=0+(n>>>16)+d*a;y=0+(D>>>16);D=(D&65535)+m*u;y+=D>>>16;y+=h*a;x=0+(y>>>16);y=(y&65535)+d*u;x+=y>>>16;y=(y&65535)+m*g;x=x+(y>>>16)+(b*a+h*u+d*g+m*l)&65535;return f.fromBits((D&65535)<<16|n&65535,x<<16|y&65535,this.unsigned)};f.prototype.div=function(a){if(a.isZero())throw Error("division by zero");if(this.isZero())return this.unsigned?f.UZERO:f.ZERO;var b,c,d;if(this.equals(f.MIN_SIGNED_VALUE)){if(a.equals(f.ONE)||a.equals(f.NEG_ONE))return f.MIN_SIGNED_VALUE;if(a.equals(f.MIN_SIGNED_VALUE))return f.ONE;
b=this.shiftRight(1).div(a).shiftLeft(1);if(b.equals(f.ZERO))return a.isNegative()?f.ONE:f.NEG_ONE;c=this.subtract(a.multiply(b));return d=b.add(c.div(a))}if(a.equals(f.MIN_SIGNED_VALUE))return this.unsigned?f.UZERO:f.ZERO;if(this.isNegative())return a.isNegative()?this.negate().div(a.negate()):this.negate().div(a).negate();if(a.isNegative())return this.div(a.negate()).negate();d=f.ZERO;for(c=this;c.greaterThanOrEqual(a);){b=Math.max(1,Math.floor(c.toNumber()/a.toNumber()));for(var m=Math.ceil(Math.log(b)/
Math.LN2),m=48>=m?1:Math.pow(2,m-48),l=f.fromNumber(b,this.unsigned),g=l.multiply(a);g.isNegative()||g.greaterThan(c);)b-=m,l=f.fromNumber(b,this.unsigned),g=l.multiply(a);l.isZero()&&(l=f.ONE);d=d.add(l);c=c.subtract(g)}return d};f.prototype.modulo=function(a){return this.subtract(this.div(a).multiply(a))};f.prototype.not=function(){return f.fromBits(~this.low,~this.high,this.unsigned)};f.prototype.and=function(a){return f.fromBits(this.low&a.low,this.high&a.high,this.unsigned)};f.prototype.or=function(a){return f.fromBits(this.low|
a.low,this.high|a.high,this.unsigned)};f.prototype.xor=function(a){return f.fromBits(this.low^a.low,this.high^a.high,this.unsigned)};f.prototype.shiftLeft=function(a){a&=63;if(0==a)return this;var b=this.low;return 32>a?f.fromBits(b<<a,this.high<<a|b>>>32-a,this.unsigned):f.fromBits(0,b<<a-32,this.unsigned)};f.prototype.shiftRight=function(a){a&=63;if(0==a)return this;var b=this.high;return 32>a?f.fromBits(this.low>>>a|b<<32-a,b>>a,this.unsigned):f.fromBits(b>>a-32,0<=b?0:-1,this.unsigned)};f.prototype.shiftRightUnsigned=
function(a){a&=63;if(0==a)return this;var b=this.high;return 32>a?f.fromBits(this.low>>>a|b<<32-a,b>>>a,this.unsigned):32==a?f.fromBits(b,0,this.unsigned):f.fromBits(b>>>a-32,0,this.unsigned)};f.prototype.toSigned=function(){var a=this.clone();a.unsigned=!1;return a};f.prototype.toUnsigned=function(){var a=this.clone();a.unsigned=!0;return a};f.prototype.clone=function(){return new f(this.low,this.high,this.unsigned)};n.dcodeIO||(n.dcodeIO={});n.dcodeIO.Long=f})(this)});C.when("Long").register("ByteBuffer",
function(A){(function(f){n.dcodeIO||(n.dcodeIO={});n.dcodeIO.ByteBuffer=function(f){var n=null;if("function"===typeof require)try{n=null}catch(a){}var d=function(a,c,e){a="undefined"!==typeof a?parseInt(a,10):d.DEFAULT_CAPACITY;1>a&&(a=d.DEFAULT_CAPACITY);this.array=e?null:new ArrayBuffer(a);this.view=e?null:new DataView(this.array);this.offset=0;this.markedOffset=-1;this.length=0;this.littleEndian="undefined"!=typeof c?!!c:!1};d.VERSION="2.3.1";d.DEFAULT_CAPACITY=16;d.LITTLE_ENDIAN=!0;d.BIG_ENDIAN=
!1;d.Long=f||null;d.isByteBuffer=function(a){return a&&(a instanceof d||"object"===typeof a&&(null===a.array||a.array instanceof ArrayBuffer)&&(null===a.view||a.view instanceof DataView)&&"number"===typeof a.offset&&"number"===typeof a.markedOffset&&"number"===typeof a.length&&"boolean"===typeof a.littleEndian)};d.allocate=function(a,c){return new d(a,c)};d.wrap=function(a,c,e){"boolean"===typeof c&&(e=c,c="utf8");if("string"===typeof a)switch(c){case "base64":return d.decode64(a,e);case "hex":return d.decodeHex(a,
e);case "binary":return d.decodeBinary(a,e);default:return(new d(d.DEFAULT_CAPACITY,e)).writeUTF8String(a).flip()}if(n&&n.isBuffer(a)){c=(new Uint8Array(a)).buffer;if(c===a){c=new ArrayBuffer(a.length);for(var b=new Uint8Array(c),h=0,k=a.length;h<k;++h)b[h]=a[h]}a=c}if(null===a||"object"!==typeof a)throw Error("Cannot wrap null or non-object");if(d.isByteBuffer(a))return d.prototype.clone.call(a);a.array?a=a.array:a.buffer&&(a=a.buffer);if(!(a instanceof ArrayBuffer))throw Error("Cannot wrap buffer of type "+
typeof a+", "+a.constructor.name);c=new d(0,e,!0);c.array=a;c.view=0<c.array.byteLength?new DataView(c.array):null;c.offset=0;c.length=a.byteLength;return c};d.prototype.LE=function(a){this.littleEndian="undefined"!==typeof a?!!a:!0;return this};d.prototype.BE=function(a){this.littleEndian="undefined"!==typeof a?!a:!1;return this};d.prototype.resize=function(a){if(1>a)return!1;null===this.array&&(this.array=new ArrayBuffer(a),this.view=new DataView(this.array));if(this.array.byteLength<a){var c=new Uint8Array(this.array);
a=new ArrayBuffer(a);(new Uint8Array(a)).set(c);this.array=a;this.view=new DataView(a)}return this};d.prototype.slice=function(a,c){if(null==this.array)throw Error(this+" cannot be sliced: Already destroyed");"undefined"===typeof a&&(a=this.offset);"undefined"===typeof c&&(c=this.length);if(c<=a){var e=c;c=a;a=e}if(0>a||a>this.array.byteLength||1>c||c>this.array.byteLength)throw Error(this+" cannot be sliced: Index out of bounds (0-"+this.array.byteLength+" -\x3e "+a+"-"+c+")");e=this.clone();e.offset=
a;e.length=c;return e};d.prototype.ensureCapacity=function(a){return null===this.array?this.resize(a):this.array.byteLength<a?this.resize(2*this.array.byteLength>=a?2*this.array.byteLength:a):this};d.prototype.flip=function(){this.length=null==this.array?0:this.offset;this.offset=0;return this};d.prototype.mark=function(a){if(null==this.array)throw Error(this+" cannot be marked: Already destroyed");a="undefined"!==typeof a?parseInt(a,10):this.offset;if(0>a||a>this.array.byteLength)throw Error(this+
" cannot be marked: Offset to mark is less than 0 or bigger than the capacity ("+this.array.byteLength+"): "+a);this.markedOffset=a;return this};d.prototype.reset=function(){if(null===this.array)throw Error(this+" cannot be reset: Already destroyed");0<=this.markedOffset?(this.offset=this.markedOffset,this.markedOffset=-1):this.length=this.offset=0;return this};d.prototype.clone=function(){var a=new d(-1,this.littleEndian,!0);a.array=this.array;a.view=this.view;a.offset=this.offset;a.markedOffset=
this.markedOffset;a.length=this.length;return a};d.prototype.copy=function(){if(null==this.array)return this.clone();var a=new d(this.array.byteLength,this.littleEndian),c=new Uint8Array(this.array);(new Uint8Array(a.array)).set(c);a.offset=this.offset;a.markedOffset=this.markedOffset;a.length=this.length;return a};d.prototype.remaining=function(){return null===this.array?0:this.length-this.offset};d.prototype.capacity=function(){return null!=this.array?this.array.byteLength:0};d.prototype.compact=
function(){if(null==this.array)throw Error(this+" cannot be compacted: Already destroyed");this.offset>this.length&&this.flip();if(this.offset===this.length)return this.array=new ArrayBuffer(0),this.view=null,this;if(0===this.offset&&this.length===this.array.byteLength)return this;var a=new Uint8Array(this.array),c=new ArrayBuffer(this.length-this.offset);(new Uint8Array(c)).set(a.subarray(this.offset,this.length));this.array=c;this.markedOffset=this.markedOffset>=this.offset?this.markedOffset-this.offset:
-1;this.offset=0;this.length=this.array.byteLength;return this};d.prototype.destroy=function(){null!==this.array&&(this.view=this.array=null,this.offset=0,this.markedOffset=-1,this.length=0);return this};d.prototype.reverse=function(){if(null===this.array)throw Error(this+" cannot be reversed: Already destroyed");Array.prototype.reverse.call(new Uint8Array(this.array));var a=this.offset;this.offset=this.array.byteLength-this.length;this.markedOffset=-1;this.length=this.array.byteLength-a;this.view=
new DataView(this.array);return this};d.prototype.append=function(a,c){a instanceof d||(a=d.wrap(a));if(null===a.array)throw Error(a+" cannot be appended to "+this+": Already destroyed");var e=a.length-a.offset;if(0==e)return this;0>e&&(a=a.clone().flip(),e=a.length-a.offset);c="undefined"!==typeof c?c:(this.offset+=e)-e;this.ensureCapacity(c+e);e=new Uint8Array(a.array);(new Uint8Array(this.array)).set(e.subarray(a.offset,a.length),c);return this};d.prototype.prepend=function(a,c){a instanceof d||
(a=d.wrap(a));if(null===a.array)throw a+" cannot be prepended to "+this+": Already destroyed";var e=a.length-a.offset;if(0==e)return this;0>e&&(a=a.clone().flip(),e=a.length-a.offset);var b="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var h=e-c;0<h?(this.ensureCapacity(this.length+h),this.append(this,e),this.offset+=h,this.length+=h,this.append(a,0)):this.append(a,c-e);b&&(this.offset-=e);return this};d.prototype.writeInt8=function(a,c){c="undefined"!=typeof c?c:(this.offset+=1)-
1;this.ensureCapacity(c+1);this.view.setInt8(c,a);return this};d.prototype.readInt8=function(a){a="undefined"!==typeof a?a:(this.offset+=1)-1;if(a>=this.array.byteLength)throw Error("Cannot read int8 from "+this+" at "+a+": Capacity overflow");return this.view.getInt8(a)};d.prototype.writeByte=d.prototype.writeInt8;d.prototype.readByte=d.prototype.readInt8;d.prototype.writeUint8=function(a,c){c="undefined"!==typeof c?c:(this.offset+=1)-1;this.ensureCapacity(c+1);this.view.setUint8(c,a);return this};
d.prototype.readUint8=function(a){a="undefined"!==typeof a?a:(this.offset+=1)-1;if(a+1>this.array.byteLength)throw Error("Cannot read uint8 from "+this+" at "+a+": Capacity overflow");return this.view.getUint8(a)};d.prototype.writeInt16=function(a,c){c="undefined"!==typeof c?c:(this.offset+=2)-2;this.ensureCapacity(c+2);this.view.setInt16(c,a,this.littleEndian);return this};d.prototype.readInt16=function(a){a="undefined"!==typeof a?a:(this.offset+=2)-2;if(a+2>this.array.byteLength)throw Error("Cannot read int16 from "+
this+" at "+a+": Capacity overflow");return this.view.getInt16(a,this.littleEndian)};d.prototype.writeShort=d.prototype.writeInt16;d.prototype.readShort=d.prototype.readInt16;d.prototype.writeUint16=function(a,c){c="undefined"!==typeof c?c:(this.offset+=2)-2;this.ensureCapacity(c+2);this.view.setUint16(c,a,this.littleEndian);return this};d.prototype.readUint16=function(a){a="undefined"!==typeof a?a:(this.offset+=2)-2;if(a+2>this.array.byteLength)throw Error("Cannot read int16 from "+this+" at "+a+
": Capacity overflow");return this.view.getUint16(a,this.littleEndian)};d.prototype.writeInt32=function(a,c){c="undefined"!==typeof c?c:(this.offset+=4)-4;this.ensureCapacity(c+4);this.view.setInt32(c,a,this.littleEndian);return this};d.prototype.readInt32=function(a){a="undefined"!==typeof a?a:(this.offset+=4)-4;if(a+4>this.array.byteLength)throw Error("Cannot read int32 from "+this+" at "+a+": Capacity overflow");return this.view.getInt32(a,this.littleEndian)};d.prototype.writeInt=d.prototype.writeInt32;
d.prototype.readInt=d.prototype.readInt32;d.prototype.writeUint32=function(a,c){c="undefined"!=typeof c?c:(this.offset+=4)-4;this.ensureCapacity(c+4);this.view.setUint32(c,a,this.littleEndian);return this};d.prototype.readUint32=function(a){a="undefined"!==typeof a?a:(this.offset+=4)-4;if(a+4>this.array.byteLength)throw Error("Cannot read uint32 from "+this+" at "+a+": Capacity overflow");return this.view.getUint32(a,this.littleEndian)};d.prototype.writeFloat32=function(a,c){c="undefined"!==typeof c?
c:(this.offset+=4)-4;this.ensureCapacity(c+4);this.view.setFloat32(c,a,this.littleEndian);return this};d.prototype.readFloat32=function(a){a="undefined"!==typeof a?a:(this.offset+=4)-4;if(null===this.array||a+4>this.array.byteLength)throw Error("Cannot read float32 from "+this+" at "+a+": Capacity overflow");return this.view.getFloat32(a,this.littleEndian)};d.prototype.writeFloat=d.prototype.writeFloat32;d.prototype.readFloat=d.prototype.readFloat32;d.prototype.writeFloat64=function(a,c){c="undefined"!==
typeof c?c:(this.offset+=8)-8;this.ensureCapacity(c+8);this.view.setFloat64(c,a,this.littleEndian);return this};d.prototype.readFloat64=function(a){a="undefined"!==typeof a?a:(this.offset+=8)-8;if(null===this.array||a+8>this.array.byteLength)throw Error("Cannot read float64 from "+this+" at "+a+": Capacity overflow");return this.view.getFloat64(a,this.littleEndian)};d.prototype.writeDouble=d.prototype.writeFloat64;d.prototype.readDouble=d.prototype.readFloat64;f&&(d.prototype.writeInt64=function(a,
c){c="undefined"!==typeof c?c:(this.offset+=8)-8;"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!1));this.ensureCapacity(c+8);this.littleEndian?(this.view.setInt32(c,a.getLowBits(),!0),this.view.setInt32(c+4,a.getHighBits(),!0)):(this.view.setInt32(c,a.getHighBits(),!1),this.view.setInt32(c+4,a.getLowBits(),!1));return this},d.prototype.readInt64=function(a){a="undefined"!==typeof a?a:(this.offset+=8)-8;if(null===this.array||a+8>this.array.byteLength)throw this.offset-=8,Error("Cannot read int64 from "+
this+" at "+a+": Capacity overflow");return this.littleEndian?f.fromBits(this.view.getInt32(a,!0),this.view.getInt32(a+4,!0),!1):f.fromBits(this.view.getInt32(a+4,!1),this.view.getInt32(a,!1),!1)},d.prototype.writeUint64=function(a,c){c="undefined"!==typeof c?c:(this.offset+=8)-8;"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!0));this.ensureCapacity(c+8);this.littleEndian?(this.view.setUint32(c,a.getLowBitsUnsigned(),!0),this.view.setUint32(c+4,a.getHighBitsUnsigned(),!0)):(this.view.setUint32(c,
a.getHighBitsUnsigned(),!1),this.view.setUint32(c+4,a.getLowBitsUnsigned(),!1));return this},d.prototype.readUint64=function(a){a="undefined"!==typeof a?a:(this.offset+=8)-8;if(null===this.array||a+8>this.array.byteLength)throw this.offset-=8,Error("Cannot read int64 from "+this+" at "+a+": Capacity overflow");return this.littleEndian?f.fromBits(this.view.getUint32(a,!0),this.view.getUint32(a+4,!0),!0):f.fromBits(this.view.getUint32(a+4,!1),this.view.getUint32(a,!1),!0)},d.prototype.writeLong=d.prototype.writeInt64,
d.prototype.readLong=d.prototype.readInt64);d.MAX_VARINT32_BYTES=5;d.prototype.writeVarint32=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;a>>>=0;this.ensureCapacity(c+d.calculateVarint32(a));var b=this.view;b.setUint8(c,a|128);128<=a?(b.setUint8(c+1,a>>7|128),16384<=a?(b.setUint8(c+2,a>>14|128),2097152<=a?(b.setUint8(c+3,a>>21|128),268435456<=a?(b.setUint8(c+4,a>>28&127),a=5):(b.setUint8(c+3,b.getUint8(c+3)&127),a=4)):(b.setUint8(c+2,b.getUint8(c+2)&127),a=3)):
(b.setUint8(c+1,b.getUint8(c+1)&127),a=2)):(b.setUint8(c,b.getUint8(c)&127),a=1);return e?(this.offset+=a,this):a};d.prototype.readVarint32=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e=0,b,h=this.view,k=0;do b=h.getUint8(a+e),e<d.MAX_VARINT32_BYTES&&(k|=(b&127)<<7*e>>>0),++e;while(b&128);k|=0;return c?(this.offset+=e,k):{value:k,length:e}};d.prototype.writeZigZagVarint32=function(a,c){return this.writeVarint32(d.zigZagEncode32(a),c)};d.prototype.readZigZagVarint32=
function(a){a=this.readVarint32(a);return"object"===typeof a?(a.value=d.zigZagDecode32(a.value),a):d.zigZagDecode32(a)};d.MAX_VARINT64_BYTES=10;f&&(d.prototype.writeVarint64=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!1));var b=a.toInt()>>>0,h=a.shiftRightUnsigned(28).toInt()>>>0,k=a.shiftRightUnsigned(56).toInt()>>>0;a=d.calculateVarint64(a);this.ensureCapacity(c+a);var m=this.view;switch(a){case 10:m.setUint8(c+
9,k>>>7|128);case 9:m.setUint8(c+8,k|128);case 8:m.setUint8(c+7,h>>>21|128);case 7:m.setUint8(c+6,h>>>14|128);case 6:m.setUint8(c+5,h>>>7|128);case 5:m.setUint8(c+4,h|128);case 4:m.setUint8(c+3,b>>>21|128);case 3:m.setUint8(c+2,b>>>14|128);case 2:m.setUint8(c+1,b>>>7|128);case 1:m.setUint8(c+0,b|128)}m.setUint8(c+a-1,m.getUint8(c+a-1)&127);return e?(this.offset+=a,this):a},d.prototype.readVarint64=function(a){var c="undefined"===typeof a,e=a="undefined"!==typeof a?a:this.offset,b=this.view,h,d=0,
m=0,l;l=b.getUint8(a++);h=l&127;if(l&128&&(l=b.getUint8(a++),h|=(l&127)<<7,l&128&&(l=b.getUint8(a++),h|=(l&127)<<14,l&128&&(l=b.getUint8(a++),h|=(l&127)<<21,l&128&&(l=b.getUint8(a++),d=l&127,l&128&&(l=b.getUint8(a++),d|=(l&127)<<7,l&128&&(l=b.getUint8(a++),d|=(l&127)<<14,l&128&&(l=b.getUint8(a++),d|=(l&127)<<21,l&128&&(l=b.getUint8(a++),m=l&127,l&128&&(l=b.getUint8(a++),m|=(l&127)<<7,l&128))))))))))throw Error("Data must be corrupt: Buffer overrun");b=f.from28Bits(h,d,m,!1);return c?(this.offset=
a,b):{value:b,length:a-e}},d.prototype.writeZigZagVarint64=function(a,c){return this.writeVarint64(d.zigZagEncode64(a),c)},d.prototype.readZigZagVarint64=function(a){a=this.readVarint64(a);return"object"!==typeof a||a instanceof f?d.zigZagDecode64(a):(a.value=d.zigZagDecode64(a.value),a)});d.prototype.writeVarint=d.prototype.writeVarint32;d.prototype.readVarint=d.prototype.readVarint32;d.prototype.writeZigZagVarint=d.prototype.writeZigZagVarint32;d.prototype.readZigZagVarint=d.prototype.readZigZagVarint32;
d.calculateVarint32=function(a){a>>>=0;return 128>a?1:16384>a?2:2097152>a?3:268435456>a?4:5};f&&(d.calculateVarint64=function(a){"object"===typeof a&&a instanceof f||(a=f.fromNumber(a,!1));var c=a.toInt()>>>0,e=a.shiftRightUnsigned(28).toInt()>>>0;a=a.shiftRightUnsigned(56).toInt()>>>0;return 0==a?0==e?16384>c?128>c?1:2:2097152>c?3:4:16384>e?128>e?5:6:2097152>e?7:8:128>a?9:10});d.zigZagEncode32=function(a){return((a|=0)<<1^a>>31)>>>0};d.zigZagDecode32=function(a){return a>>>1^-(a&1)|0};f&&(d.zigZagEncode64=
function(a){"object"===typeof a&&a instanceof f?a.unsigned&&(a=a.toSigned()):a=f.fromNumber(a,!1);return a.shiftLeft(1).xor(a.shiftRight(63)).toUnsigned()},d.zigZagDecode64=function(a){"object"===typeof a&&a instanceof f?a.unsigned||(a=a.toUnsigned()):a=f.fromNumber(a,!0);return a.shiftRightUnsigned(1).xor(a.and(f.ONE).toSigned().negate()).toSigned()});d.decodeUTF8Char=function(a,c){var e=a.readUint8(c),b,h,d,m,f=c;if(0==(e&128))c+=1;else if(192==(e&224))b=a.readUint8(c+1),e=(e&31)<<6|b&63,c+=2;else if(224==
(e&240))b=a.readUint8(c+1),h=a.readUint8(c+2),e=(e&15)<<12|(b&63)<<6|h&63,c+=3;else if(240==(e&248))b=a.readUint8(c+1),h=a.readUint8(c+2),d=a.readUint8(c+3),e=(e&7)<<18|(b&63)<<12|(h&63)<<6|d&63,c+=4;else if(248==(e&252))b=a.readUint8(c+1),h=a.readUint8(c+2),d=a.readUint8(c+3),m=a.readUint8(c+4),e=(e&3)<<24|(b&63)<<18|(h&63)<<12|(d&63)<<6|m&63,c+=5;else if(252==(e&254))b=a.readUint8(c+1),h=a.readUint8(c+2),d=a.readUint8(c+3),m=a.readUint8(c+4),a=a.readUint8(c+5),e=(e&1)<<30|(b&63)<<24|(h&63)<<18|
(d&63)<<12|(m&63)<<6|a&63,c+=6;else throw Error("Cannot decode UTF8 character at offset "+c+": charCode (0x"+e.toString(16)+") is invalid");return{"char":e,length:c-f}};d.encodeUTF8Char=function(a,c,e){var b=e;if(0>a)throw Error("Cannot encode UTF8 character: charCode ("+a+") is negative");if(128>a)c.writeUint8(a&127,e),e+=1;else if(2048>a)c.writeUint8(a>>6&31|192,e).writeUint8(a&63|128,e+1),e+=2;else if(65536>a)c.writeUint8(a>>12&15|224,e).writeUint8(a>>6&63|128,e+1).writeUint8(a&63|128,e+2),e+=
3;else if(2097152>a)c.writeUint8(a>>18&7|240,e).writeUint8(a>>12&63|128,e+1).writeUint8(a>>6&63|128,e+2).writeUint8(a&63|128,e+3),e+=4;else if(67108864>a)c.writeUint8(a>>24&3|248,e).writeUint8(a>>18&63|128,e+1).writeUint8(a>>12&63|128,e+2).writeUint8(a>>6&63|128,e+3).writeUint8(a&63|128,e+4),e+=5;else if(2147483648>a)c.writeUint8(a>>30&1|252,e).writeUint8(a>>24&63|128,e+1).writeUint8(a>>18&63|128,e+2).writeUint8(a>>12&63|128,e+3).writeUint8(a>>6&63|128,e+4).writeUint8(a&63|128,e+5),e+=6;else throw Error("Cannot encode UTF8 character: charCode (0x"+
a.toString(16)+") is too large (\x3e\x3d 0x80000000)");return e-b};d.calculateUTF8Char=function(a){if(0>a)throw Error("Cannot calculate length of UTF8 character: charCode ("+a+") is negative");if(128>a)return 1;if(2048>a)return 2;if(65536>a)return 3;if(2097152>a)return 4;if(67108864>a)return 5;if(2147483648>a)return 6;throw Error("Cannot calculate length of UTF8 character: charCode (0x"+a.toString(16)+") is too large (\x3e\x3d 0x80000000)");};d.calculateUTF8String=function(a){a=""+a;for(var c=0,e=
0,b=a.length;e<b;++e)c+=d.calculateUTF8Char(a.charCodeAt(e));return c};var m="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",m=m+"";d.encode64=function(a){a instanceof d?a.length<a.offset&&(a=a.clone().flip()):a=d.wrap(a);var c,e,b,h,k=a.offset,f=0,l=[];do c=a.readUint8(k++),e=a.length>k?a.readUint8(k++):0,b=a.length>k?a.readUint8(k++):0,h=c<<16|e<<8|b,c=h>>18&63,e=h>>12&63,b=h>>6&63,h&=63,l[f++]=m.charAt(c)+m.charAt(e)+m.charAt(b)+m.charAt(h);while(k<a.length);k=l.join("");
a=(a.length-a.offset)%3;return(a?k.slice(0,a-3):k)+"\x3d\x3d\x3d".slice(a||3)};d.decode64=function(a,c){if("string"!==typeof a)throw Error("Illegal argument: Not a string");var e,b,h,k,f=0,l=new d(Math.ceil(a.length/3),c);do{e=m.indexOf(a.charAt(f++));b=m.indexOf(a.charAt(f++));c=m.indexOf(a.charAt(f++));k=m.indexOf(a.charAt(f++));if(0>e||0>b||0>c||0>k)throw Error("Illegal argument: Not a valid base64 encoded string");h=e<<18|b<<12|c<<6|k;e=h>>16&255;b=h>>8&255;h&=255;64==c?l.writeUint8(e):64==k?
l.writeUint8(e).writeUint8(b):l.writeUint8(e).writeUint8(b).writeUint8(h)}while(f<a.length);return l.flip()};d.encodeHex=function(a){a instanceof d?a.length<a.offset&&(a=a.clone().flip()):a=d.wrap(a);if(null===a.array)return"";for(var c,e=[],b=a.offset,h=a.length;b<h;++b)c=a.view.getUint8(b).toString(16).toUpperCase(),2>c.length&&(c="0"+c),e.push(c);return e.join("")};d.decodeHex=function(a,c){if("string"!==typeof a)throw Error("Illegal argument: Not a string");if(0!==a.length%2)throw Error("Illegal argument: Not a hex encoded string");
c=new d(a.length/2,c);for(var e=0,b=a.length;e<b;e+=2)c.writeUint8(parseInt(a.substring(e,e+2),16));return c.flip()};d.encodeBinary=function(a){a instanceof d?a.length<a.offset&&(a=a.clone().flip()):a=d.wrap(a);var c=[],e=a.view,b=a.offset;for(a=a.length;b<a;++b)c.push(String.fromCharCode(e.getUint8(b)));return c.join("")};d.decodeBinary=function(a,c){if("string"!==typeof a)throw Error("Illegal argument: Not a string");for(var e=a.length,b=new ArrayBuffer(e),h=new DataView(b),m,f=0;f<e;++f){if(255<
(m=a.charCodeAt(f)))throw Error("Illegal argument: Not a binary string (char code "+m+")");h.setUint8(f,m)}a=new d(e,c,!0);a.array=b;a.view=h;a.length=e;return a};d.prototype.writeUTF8String=function(a,c){var e="undefined"===typeof c,b=c="undefined"!==typeof c?c:this.offset,h=d.calculateUTF8String(a);this.ensureCapacity(c+h);for(var h=0,m=a.length;h<m;++h)c+=d.encodeUTF8Char(a.charCodeAt(h),this,c);return e?(this.offset=c,this):c-b};d.prototype.readUTF8String=function(a,c){var e="undefined"===typeof c;
c="undefined"!==typeof c?c:this.offset;for(var b,h="",m=c,f=0;f<a;++f)b=d.decodeUTF8Char(this,c),c+=b.length,h+=String.fromCharCode(b["char"]);return e?(this.offset=c,h):{string:h,length:c-m}};d.prototype.readUTF8StringBytes=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var b,h="",m=c;for(a=c+a;c<a;)b=d.decodeUTF8Char(this,c),c+=b.length,h+=String.fromCharCode(b["char"]);if(c!=a)throw Error("Actual string length differs from the specified: "+((c>a?"+":"")+c-a)+
" bytes");return e?(this.offset=c,h):{string:h,length:c-m}};d.prototype.writeLString=function(a,c){a=""+a;var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var b=d.encodeUTF8Char(a.length,this,c),b=b+this.writeUTF8String(a,c+b);return e?(this.offset+=b,this):b};d.prototype.readLString=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e=d.decodeUTF8Char(this,a);a=this.readUTF8String(e["char"],a+e.length);return c?(this.offset+=e.length+a.length,a.string):
{string:a.string,length:e.length+a.length}};d.prototype.writeVString=function(a,c){a=""+a;var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;var b=this.writeVarint32(d.calculateUTF8String(a),c),b=b+this.writeUTF8String(a,c+b);return e?(this.offset+=b,this):b};d.prototype.readVString=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e=this.readVarint32(a);a=this.readUTF8StringBytes(e.value,a+e.length);return c?(this.offset+=e.length+a.length,a.string):
{string:a.string,length:e.length+a.length}};d.prototype.writeCString=function(a,c){var e="undefined"===typeof c;c="undefined"!==typeof c?c:this.offset;a=this.writeUTF8String(""+a,c);this.writeUint8(0,c+a);return e?(this.offset+=a+1,this):a+1};d.prototype.readCString=function(a){var c="undefined"===typeof a;a="undefined"!==typeof a?a:this.offset;var e,b="",h=a;do e=d.decodeUTF8Char(this,a),a+=e.length,0!=e["char"]&&(b+=String.fromCharCode(e["char"]));while(0!=e["char"]);return c?(this.offset=a,b):
{string:b,length:a-h}};d.prototype.writeJSON=function(a,c,e){e="function"===typeof e?e:JSON.stringify;return this.writeLString(e(a),c)};d.prototype.readJSON=function(a,c){c="function"===typeof c?c:JSON.parse;a=this.readLString(a);return"string"===typeof a?c(a):{data:c(a.string),length:a.length}};d.prototype.toColumns=function(a){if(null===this.array)return"DESTROYED";a="undefined"!==typeof a?parseInt(a,10):16;1>a&&(a=16);for(var c="",e=[],b,h=this.view,c=0==this.offset&&0==this.length?c+"|":0==this.length?
c+"\x3e":0==this.offset?c+"\x3c":c+" ",d=0,m=this.array.byteLength;d<m;++d){if(0<d&&0==d%a){for(;c.length<3*a+1;)c+="   ";e.push(c);c=" "}b=h.getUint8(d).toString(16).toUpperCase();2>b.length&&(b="0"+b);c+=b;c=d+1==this.offset&&d+1==this.length?c+"|":d+1==this.offset?c+"\x3c":d+1==this.length?c+"\x3e":c+" "}" "!=c&&e.push(c);d=0;for(m=e.length;d<m;++d)for(;e[d].length<3*a+1;)e[d]+="   ";for(var f=0,c="",d=0,m=this.array.byteLength;d<m;++d)0<d&&0==d%a&&(e[f]+=" "+c,c="",f++),b=h.getUint8(d),c+=32<
b&&127>b?String.fromCharCode(b):".";""!=c&&(e[f]+=" "+c);return e.join("\n")};d.prototype.printDebug=function(a){"function"!==typeof a&&(a=console.log.bind(console));a((null!=this.array?"ByteBuffer(offset\x3d"+this.offset+",markedOffset\x3d"+this.markedOffset+",length\x3d"+this.length+",capacity\x3d"+this.array.byteLength+")":"ByteBuffer(DESTROYED)")+"\n-------------------------------------------------------------------\n"+this.toColumns()+"\n")};d.prototype.toHex=function(a){var c="",e=this.view,
b,h;if(a){if(null===this.array)return"DESTROYED";c=0==this.offset&&0==this.length?c+"|":0==this.length?c+"\x3e":0==this.offset?c+"\x3c":c+" ";b=0;for(h=this.array.byteLength;b<h;++b)a=e.getUint8(b).toString(16).toUpperCase(),2>a.length&&(a="0"+a),c+=a,c=b+1===this.offset&&b+1===this.length?c+"|":b+1==this.offset?c+"\x3c":b+1==this.length?c+"\x3e":c+" ";return c}return d.encodeHex(this)};d.prototype.toBinary=function(){return d.encodeBinary(this)};d.prototype.toBase64=function(){return null===this.array||
this.offset>=this.length?"":d.encode64(this)};d.prototype.toUTF8=function(){return null===this.array||this.offset>=this.length?"":this.readUTF8StringBytes(this.length-this.offset,this.offset).string};d.prototype.toString=function(a){switch(a||""){case "utf8":return this.toUTF8();case "base64":return this.toBase64();case "hex":return this.toHex();case "binary":return this.toBinary();case "debug":return this.toHex(!0);default:return null===this.array?"ByteBuffer(DESTROYED)":"ByteBuffer(offset\x3d"+
this.offset+",markedOffset\x3d"+this.markedOffset+",length\x3d"+this.length+",capacity\x3d"+this.array.byteLength+")"}};d.prototype.toArrayBuffer=function(a){if(null===this.array)return null;var c=this.clone();c.offset>c.length&&c.flip();var e=!1;if(0<c.offset||c.length<c.array.byteLength)c.compact(),e=!0;return a&&!e?c.copy().array:c.array};n&&(d.prototype.toBuffer=function(){if(null===this.array)return null;var a=this.offset,c=this.length;if(a>c)var e=a,a=c,c=e;return new n((new Uint8Array(this.array)).subarray(a,
c))});return d}(n.dcodeIO.Long)})(this)});C.when("ByteBuffer","Long").register("ProtoBuf",function(A,f){(function(f){n.dcodeIO||(n.dcodeIO={});n.dcodeIO.ProtoBuf=function(f){var d={VERSION:"2.2.1",WIRE_TYPES:{}};d.WIRE_TYPES.VARINT=0;d.WIRE_TYPES.BITS64=1;d.WIRE_TYPES.LDELIM=2;d.WIRE_TYPES.STARTGROUP=3;d.WIRE_TYPES.ENDGROUP=4;d.WIRE_TYPES.BITS32=5;d.TYPES={int32:{name:"int32",wireType:d.WIRE_TYPES.VARINT},uint32:{name:"uint32",wireType:d.WIRE_TYPES.VARINT},sint32:{name:"sint32",wireType:d.WIRE_TYPES.VARINT},
int64:{name:"int64",wireType:d.WIRE_TYPES.VARINT},uint64:{name:"uint64",wireType:d.WIRE_TYPES.VARINT},sint64:{name:"sint64",wireType:d.WIRE_TYPES.VARINT},bool:{name:"bool",wireType:d.WIRE_TYPES.VARINT},"double":{name:"double",wireType:d.WIRE_TYPES.BITS64},string:{name:"string",wireType:d.WIRE_TYPES.LDELIM},bytes:{name:"bytes",wireType:d.WIRE_TYPES.LDELIM},fixed32:{name:"fixed32",wireType:d.WIRE_TYPES.BITS32},sfixed32:{name:"sfixed32",wireType:d.WIRE_TYPES.BITS32},fixed64:{name:"fixed64",wireType:d.WIRE_TYPES.BITS64},
sfixed64:{name:"sfixed64",wireType:d.WIRE_TYPES.BITS64},"float":{name:"float",wireType:d.WIRE_TYPES.BITS32},"enum":{name:"enum",wireType:d.WIRE_TYPES.VARINT},message:{name:"message",wireType:d.WIRE_TYPES.LDELIM}};d.Long=f.Long;d.convertFieldsToCamelCase=!1;d.Util=function(){Object.create||(Object.create=function(a){function c(){}if(1<arguments.length)throw Error("Object.create implementation only accepts the first parameter.");c.prototype=a;return new c});var d={};d.IS_NODE=("undefined"===typeof n||
!n.window)&&"function"===typeof require&&"undefined"!==typeof process&&"function"===typeof process.nextTick;d.XHR=function(){for(var a=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}],c=null,e=0;e<a.length;e++){try{c=a[e]()}catch(b){continue}break}if(!c)throw Error("XMLHttpRequest is not supported");return c};d.fetch=function(a,c){c&&"function"!=
typeof c&&(c=null);if(d.IS_NODE)if(c)module.require("fs").readFile(a,function(a,e){a?c(null):c(""+e)});else try{return module.require("fs").readFileSync(a)}catch(b){return null}else{var e=d.XHR();e.open("GET",a,c?!0:!1);e.setRequestHeader("Accept","text/plain");"function"===typeof e.overrideMimeType&&e.overrideMimeType("text/plain");if(c)e.onreadystatechange=function(){4==e.readyState&&(200==e.status||0==e.status&&"string"===typeof e.responseText?c(e.responseText):c(null))},4!=e.readyState&&e.send(null);
else return e.send(null),200==e.status||0==e.status&&"string"===typeof e.responseText?e.responseText:null}};d.isArray=function(a){return a?a instanceof Array?!0:Array.isArray?Array.isArray(a):"[object Array]"===Object.prototype.toString.call(a):!1};return d}();d.Lang={OPEN:"{",CLOSE:"}",OPTOPEN:"[",OPTCLOSE:"]",OPTEND:",",EQUAL:"\x3d",END:";",STRINGOPEN:'"',STRINGCLOSE:'"',STRINGOPEN_SQ:"'",STRINGCLOSE_SQ:"'",COPTOPEN:"(",COPTCLOSE:")",DELIM:/[\s\{\}=;\[\],'"\(\)]/g,KEYWORD:/^(?:package|option|import|message|enum|extend|service|syntax|extensions)$/,
RULE:/^(?:required|optional|repeated)$/,TYPE:/^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/,NAME:/^[a-zA-Z_][a-zA-Z_0-9]*$/,OPTNAME:/^(?:[a-zA-Z][a-zA-Z_0-9]*|\([a-zA-Z][a-zA-Z_0-9]*\))$/,TYPEDEF:/^[a-zA-Z][a-zA-Z_0-9]*$/,TYPEREF:/^(?:\.?[a-zA-Z][a-zA-Z_0-9]*)+$/,FQTYPEREF:/^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/,NUMBER:/^-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+|([0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?))$/,NUMBER_DEC:/^(?:[1-9][0-9]*|0)$/,NUMBER_HEX:/^0x[0-9a-fA-F]+$/,
NUMBER_OCT:/^0[0-7]+$/,NUMBER_FLT:/^[0-9]*\.[0-9]+([Ee][+-]?[0-9]+)?$/,ID:/^(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,NEGID:/^\-?(?:[1-9][0-9]*|0|0x[0-9a-fA-F]+|0[0-7]+)$/,WHITESPACE:/\s/,STRING:/['"]([^'"\\]*(\\.[^"\\]*)*)['"]/g,BOOL:/^(?:true|false)$/i,ID_MIN:1,ID_MAX:536870911};d.DotProto={};d.DotProto.Tokenizer=function(d){var a=function(a){this.source=""+a;this.index=0;this.line=1;this.stack=[];this.readingString=!1;this.stringEndsWith=d.STRINGCLOSE};a.prototype._readString=function(){d.STRING.lastIndex=
this.index-1;var a;if(null!==(a=d.STRING.exec(this.source)))return a=a[1],this.index=d.STRING.lastIndex,this.stack.push(this.stringEndsWith),a;throw Error("Illegal string value at line "+this.line+", index "+this.index);};a.prototype.next=function(){if(0<this.stack.length)return this.stack.shift();if(this.index>=this.source.length)return null;if(this.readingString)return this.readingString=!1,this._readString();var a,e;do{for(a=!1;d.WHITESPACE.test(e=this.source.charAt(this.index));)if(this.index++,
"\n"===e&&this.line++,this.index===this.source.length)return null;if("/"===this.source.charAt(this.index))if("/"===this.source.charAt(++this.index)){for(;"\n"!==this.source.charAt(this.index);)if(this.index++,this.index==this.source.length)return null;this.index++;this.line++;a=!0}else if("*"===this.source.charAt(this.index)){for(e="";"*/"!==e+(e=this.source.charAt(this.index));)if(this.index++,"\n"===e&&this.line++,this.index===this.source.length)return null;this.index++;a=!0}else throw Error("Invalid comment at line "+
this.line+": /"+this.source.charAt(this.index)+" ('/' or '*' expected)");}while(a);if(this.index===this.source.length)return null;a=this.index;d.DELIM.lastIndex=0;if(d.DELIM.test(this.source.charAt(a)))a++;else for(a++;a<this.source.length&&!d.DELIM.test(this.source.charAt(a));)a++;a=this.source.substring(this.index,this.index=a);a===d.STRINGOPEN?(this.readingString=!0,this.stringEndsWith=d.STRINGCLOSE):a===d.STRINGOPEN_SQ&&(this.readingString=!0,this.stringEndsWith=d.STRINGCLOSE_SQ);return a};a.prototype.peek=
function(){if(0===this.stack.length){var a=this.next();if(null===a)return null;this.stack.push(a)}return this.stack[0]};a.prototype.toString=function(){return"Tokenizer("+this.index+"/"+this.source.length+" at line "+this.line+")"};return a}(d.Lang);d.DotProto.Parser=function(d,a,c){d=function(a){this.tn=new c(a)};d.prototype.parse=function(){var a={name:"[ROOT]","package":null,messages:[],enums:[],imports:[],options:{},services:[]},b,c=!0;do{b=this.tn.next();if(null==b)break;if("package"==b){if(!c)throw Error("Illegal package definition at line "+
this.tn.line+": Must be declared before the first message or enum");if(null!==a["package"])throw Error("Illegal package definition at line "+this.tn.line+": Package already declared");a["package"]=this._parsePackage(b)}else if("import"==b){if(!c)throw Error("Illegal import definition at line "+this.tn.line+": Must be declared before the first message or enum");a.imports.push(this._parseImport(b))}else if("message"===b)this._parseMessage(a,b),c=!1;else if("enum"===b)this._parseEnum(a,b),c=!1;else if("option"===
b){if(!c)throw Error("Illegal option definition at line "+this.tn.line+": Must be declared before the first message or enum");this._parseOption(a,b)}else if("service"===b)this._parseService(a,b);else if("extend"===b)this._parseExtend(a,b);else if("syntax"===b)this._parseIgnoredStatement(a,b);else throw Error("Illegal top level declaration at line "+this.tn.line+": "+b);}while(1);delete a.name;return a};d.prototype._parseNumber=function(c){var b=1;"-"==c.charAt(0)&&(b=-1,c=c.substring(1));if(a.NUMBER_DEC.test(c))return b*
parseInt(c,10);if(a.NUMBER_HEX.test(c))return b*parseInt(c.substring(2),16);if(a.NUMBER_OCT.test(c))return b*parseInt(c.substring(1),8);if(a.NUMBER_FLT.test(c))return b*parseFloat(c);throw Error("Illegal number value at line "+this.tn.line+": "+(0>b?"-":"")+c);};d.prototype._parseId=function(c,b){var d,f=1;"-"==c.charAt(0)&&(f=-1,c=c.substring(1));if(a.NUMBER_DEC.test(c))d=parseInt(c);else if(a.NUMBER_HEX.test(c))d=parseInt(c.substring(2),16);else if(a.NUMBER_OCT.test(c))d=parseInt(c.substring(1),
8);else throw Error("Illegal ID value at line "+this.tn.line+": "+(0>f?"-":"")+c);d=f*d|0;if(!b&&0>d)throw Error("Illegal ID range at line "+this.tn.line+": "+(0>f?"-":"")+c);return d};d.prototype._parsePackage=function(c){c=this.tn.next();if(!a.TYPEREF.test(c))throw Error("Illegal package name at line "+this.tn.line+": "+c);var b=c;c=this.tn.next();if(c!=a.END)throw Error("Illegal end of package definition at line "+this.tn.line+": "+c+" ('"+a.END+"' expected)");return b};d.prototype._parseImport=
function(c){c=this.tn.next();"public"===c&&(c=this.tn.next());if(c!==a.STRINGOPEN&&c!==a.STRINGOPEN_SQ)throw Error("Illegal begin of import value at line "+this.tn.line+": "+c+" ('"+a.STRINGOPEN+"' or '"+a.STRINGOPEN_SQ+"' expected)");var b=this.tn.next();c=this.tn.next();if(c!==this.tn.stringEndsWith)throw Error("Illegal end of import value at line "+this.tn.line+": "+c+" ('"+this.tn.stringEndsWith+"' expected)");c=this.tn.next();if(c!==a.END)throw Error("Illegal end of import definition at line "+
this.tn.line+": "+c+" ('"+a.END+"' expected)");return b};d.prototype._parseOption=function(c,b){b=this.tn.next();var d=!1;b==a.COPTOPEN&&(d=!0,b=this.tn.next());if(!a.NAME.test(b)&&!/google\.protobuf\./.test(b))throw Error("Illegal option name in message "+c.name+" at line "+this.tn.line+": "+b);var f=b;b=this.tn.next();if(d){if(b!==a.COPTCLOSE)throw Error("Illegal custom option name delimiter in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTCLOSE+"' expected)");f="("+
f+")";b=this.tn.next();a.FQTYPEREF.test(b)&&(f+=b,b=this.tn.next())}if(b!==a.EQUAL)throw Error("Illegal option operator in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+a.EQUAL+"' expected)");b=this.tn.next();if(b===a.STRINGOPEN||b===a.STRINGOPEN_SQ){if(d=this.tn.next(),b=this.tn.next(),b!==this.tn.stringEndsWith)throw Error("Illegal end of option value in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+this.tn.stringEndsWith+"' expected)");}else if(a.NUMBER.test(b))d=
this._parseNumber(b,!0);else if(a.TYPEREF.test(b))d=b;else throw Error("Illegal option value in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b);b=this.tn.next();if(b!==a.END)throw Error("Illegal end of option in message "+c.name+", option "+f+" at line "+this.tn.line+": "+b+" ('"+a.END+"' expected)");c.options[f]=d};d.prototype._parseIgnoredBlock=function(c,b){var d=this.tn.next();if(!a.TYPEREF.test(d))throw Error("Illegal "+b+" type in "+c.name+": "+d);var f=d,d=this.tn.next();if(d!==
a.OPEN)throw Error("Illegal OPEN in "+c.name+" after "+b+" "+f+" at line "+this.tn.line+": "+d);var m=1;do{d=this.tn.next();if(null===d)throw Error("Unexpected EOF in "+c.name+", "+b+" (ignored) at line "+this.tn.line+": "+f);if(d===a.OPEN)m++;else if(d===a.CLOSE&&(d=this.tn.peek(),d===a.END&&this.tn.next(),m--,0===m))break}while(1)};d.prototype._parseIgnoredStatement=function(c,b){var d;do{d=this.tn.next();if(null===d)throw Error("Unexpected EOF in "+c.name+", "+b+" (ignored) at line "+this.tn.line);
if(d===a.END)break}while(1)};d.prototype._parseService=function(c,b){b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal service name at line "+this.tn.line+": "+b);var d=b,f={name:d,rpc:{},options:{}};b=this.tn.next();if(b!==a.OPEN)throw Error("Illegal OPEN after service "+d+" at line "+this.tn.line+": "+b+" ('"+a.OPEN+"' expected)");do if(b=this.tn.next(),"option"===b)this._parseOption(f,b);else if("rpc"===b)this._parseServiceRPC(f,b);else if(b!==a.CLOSE)throw Error("Illegal type for service "+
d+" at line "+this.tn.line+": "+b);while(b!==a.CLOSE);c.services.push(f)};d.prototype._parseServiceRPC=function(c,b){var d=b;b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal RPC method name in service "+c.name+" at line "+this.tn.line+": "+b);var f=b,m={request:null,response:null,options:{}};b=this.tn.next();if(b!==a.COPTOPEN)throw Error("Illegal start of request type in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTOPEN+"' expected)");b=this.tn.next();if(!a.TYPEREF.test(b))throw Error("Illegal request type in RPC service "+
c.name+"#"+f+" at line "+this.tn.line+": "+b);m.request=b;b=this.tn.next();if(b!=a.COPTCLOSE)throw Error("Illegal end of request type in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTCLOSE+"' expected)");b=this.tn.next();if("returns"!==b.toLowerCase())throw Error("Illegal request/response delimiter in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('returns' expected)");b=this.tn.next();if(b!=a.COPTOPEN)throw Error("Illegal start of response type in RPC service "+
c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTOPEN+"' expected)");b=this.tn.next();m.response=b;b=this.tn.next();if(b!==a.COPTCLOSE)throw Error("Illegal end of response type in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.COPTCLOSE+"' expected)");b=this.tn.next();if(b===a.OPEN){do if(b=this.tn.next(),"option"===b)this._parseOption(m,b);else if(b!==a.CLOSE)throw Error("Illegal start of option in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('option' expected)");
while(b!==a.CLOSE);this.tn.peek()===a.END&&this.tn.next()}else if(b!==a.END)throw Error("Illegal method delimiter in RPC service "+c.name+"#"+f+" at line "+this.tn.line+": "+b+" ('"+a.END+"' or '"+a.OPEN+"' expected)");"undefined"===typeof c[d]&&(c[d]={});c[d][f]=m};d.prototype._parseMessage=function(c,b){var d={};b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal message name"+(c?" in message "+c.name:"")+" at line "+this.tn.line+": "+b);d.name=b;b=this.tn.next();if(b!=a.OPEN)throw Error("Illegal OPEN after message "+
d.name+" at line "+this.tn.line+": "+b+" ('"+a.OPEN+"' expected)");d.fields=[];d.enums=[];d.messages=[];d.options={};do if(b=this.tn.next(),b===a.CLOSE){b=this.tn.peek();b===a.END&&this.tn.next();break}else if(a.RULE.test(b))this._parseMessageField(d,b);else if("enum"===b)this._parseEnum(d,b);else if("message"===b)this._parseMessage(d,b);else if("option"===b)this._parseOption(d,b);else if("extensions"===b)d.extensions=this._parseExtensions(d,b);else if("extend"===b)this._parseExtend(d,b);else throw Error("Illegal token in message "+
d.name+" at line "+this.tn.line+": "+b+" (type or '"+a.CLOSE+"' expected)");while(1);c.messages.push(d);return d};d.prototype._parseMessageField=function(c,b){var d={};d.rule=b;b=this.tn.next();if(!a.TYPE.test(b)&&!a.TYPEREF.test(b))throw Error("Illegal field type in message "+c.name+" at line "+this.tn.line+": "+b);d.type=b;b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal field name in message "+c.name+" at line "+this.tn.line+": "+b);d.name=b;b=this.tn.next();if(b!==a.EQUAL)throw Error("Illegal field number operator in message "+
c.name+"#"+d.name+" at line "+this.tn.line+": "+b+" ('"+a.EQUAL+"' expected)");b=this.tn.next();try{d.id=this._parseId(b)}catch(f){throw Error("Illegal field id in message "+c.name+"#"+d.name+" at line "+this.tn.line+": "+b);}d.options={};b=this.tn.next();b===a.OPTOPEN&&(this._parseFieldOptions(c,d,b),b=this.tn.next());if(b!==a.END)throw Error("Illegal field delimiter in message "+c.name+"#"+d.name+" at line "+this.tn.line+": "+b+" ('"+a.END+"' expected)");c.fields.push(d)};d.prototype._parseFieldOptions=
function(c,b,d){var f=!0;do{d=this.tn.next();if(d===a.OPTCLOSE)break;else if(d===a.OPTEND){if(f)throw Error("Illegal start of message field options in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d);d=this.tn.next()}this._parseFieldOption(c,b,d);f=!1}while(1)};d.prototype._parseFieldOption=function(c,b,d){var f=!1;d===a.COPTOPEN&&(d=this.tn.next(),f=!0);if(!a.NAME.test(d))throw Error("Illegal field option in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d);var m=d;d=this.tn.next();
if(f){if(d!==a.COPTCLOSE)throw Error("Illegal custom field option name delimiter in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d+" (')' expected)");m="("+m+")";d=this.tn.next();a.FQTYPEREF.test(d)&&(m+=d,d=this.tn.next())}if(d!==a.EQUAL)throw Error("Illegal field option operation in message "+c.name+"#"+b.name+" at line "+this.tn.line+": "+d+" ('\x3d' expected)");d=this.tn.next();if(d===a.STRINGOPEN||d===a.STRINGOPEN_SQ){if(f=this.tn.next(),d=this.tn.next(),d!=this.tn.stringEndsWith)throw Error("Illegal end of field value in message "+
c.name+"#"+b.name+", option "+m+" at line "+this.tn.line+": "+d+" ('"+this.tn.stringEndsWith+"' expected)");}else if(a.NUMBER.test(d,!0))f=this._parseNumber(d,!0);else if(a.BOOL.test(d))f="true"===d.toLowerCase();else if(a.TYPEREF.test(d))f=d;else throw Error("Illegal field option value in message "+c.name+"#"+b.name+", option "+m+" at line "+this.tn.line+": "+d);b.options[m]=f};d.prototype._parseEnum=function(c,b){var d={};b=this.tn.next();if(!a.NAME.test(b))throw Error("Illegal enum name in message "+
c.name+" at line "+this.tn.line+": "+b);d.name=b;b=this.tn.next();if(b!==a.OPEN)throw Error("Illegal OPEN after enum "+d.name+" at line "+this.tn.line+": "+b);d.values=[];d.options={};do{b=this.tn.next();if(b===a.CLOSE){b=this.tn.peek();b===a.END&&this.tn.next();break}if("option"==b)this._parseOption(d,b);else{if(!a.NAME.test(b))throw Error("Illegal enum value name in enum "+d.name+" at line "+this.tn.line+": "+b);this._parseEnumValue(d,b)}}while(1);c.enums.push(d)};d.prototype._parseEnumValue=function(c,
b){var d={};d.name=b;b=this.tn.next();if(b!==a.EQUAL)throw Error("Illegal enum value operator in enum "+c.name+" at line "+this.tn.line+": "+b+" ('"+a.EQUAL+"' expected)");b=this.tn.next();try{d.id=this._parseId(b,!0)}catch(f){throw Error("Illegal enum value id in enum "+c.name+" at line "+this.tn.line+": "+b);}c.values.push(d);b=this.tn.next();b===a.OPTOPEN&&(this._parseFieldOptions(c,{options:{}},b),b=this.tn.next());if(b!==a.END)throw Error("Illegal enum value delimiter in enum "+c.name+" at line "+
this.tn.line+": "+b+" ('"+a.END+"' expected)");};d.prototype._parseExtensions=function(c,b){var d=[];b=this.tn.next();"min"===b?d.push(a.ID_MIN):"max"===b?d.push(a.ID_MAX):d.push(this._parseNumber(b));b=this.tn.next();if("to"!==b)throw"Illegal extensions delimiter in message "+c.name+" at line "+this.tn.line+" ('to' expected)";b=this.tn.next();"min"===b?d.push(a.ID_MIN):"max"===b?d.push(a.ID_MAX):d.push(this._parseNumber(b));b=this.tn.next();if(b!==a.END)throw Error("Illegal extension delimiter in message "+
c.name+" at line "+this.tn.line+": "+b+" ('"+a.END+"' expected)");return d};d.prototype._parseExtend=function(c,b){b=this.tn.next();if(!a.TYPEREF.test(b))throw Error("Illegal extended message name at line "+this.tn.line+": "+b);var d={};d.ref=b;d.fields=[];b=this.tn.next();if(b!==a.OPEN)throw Error("Illegal OPEN in extend "+d.name+" at line "+this.tn.line+": "+b+" ('"+a.OPEN+"' expected)");do if(b=this.tn.next(),b===a.CLOSE){b=this.tn.peek();b==a.END&&this.tn.next();break}else if(a.RULE.test(b))this._parseMessageField(d,
b);else throw Error("Illegal token in extend "+d.name+" at line "+this.tn.line+": "+b+" (rule or '"+a.CLOSE+"' expected)");while(1);c.messages.push(d);return d};d.prototype.toString=function(){return"Parser"};return d}(d,d.Lang,d.DotProto.Tokenizer);d.Reflect=function(d){var a={},c=function(a,b){this.parent=a;this.name=b};c.prototype.fqn=function(){var a=this.name,b=this;do{b=b.parent;if(null==b)break;a=b.name+"."+a}while(1);return a};c.prototype.toString=function(a){var c=this.fqn();a&&(this instanceof
b?c="Message "+c:this instanceof b.Field?c="Message.Field "+c:this instanceof k?c="Enum "+c:this instanceof k.Value?c="Enum.Value "+c:this instanceof p?c="Service "+c:this instanceof p.Method?c=this instanceof p.RPCMethod?"Service.RPCMethod "+c:"Service.Method "+c:this instanceof e&&(c="Namespace "+c));return c};c.prototype.build=function(){throw Error(this.toString(!0)+" cannot be built directly");};a.T=c;var e=function(a,b,d){c.call(this,a,b);this.children=[];this.options=d||{}};e.prototype=Object.create(c.prototype);
e.prototype.getChildren=function(a){a=a||null;if(null==a)return this.children.slice();for(var b=[],c=0;c<this.children.length;c++)this.children[c]instanceof a&&b.push(this.children[c]);return b};e.prototype.addChild=function(a){var c;if(c=this.getChild(a.name))if(c instanceof b.Field&&c.name!==c.originalName&&!this.hasChild(c.originalName))c.name=c.originalName;else if(a instanceof b.Field&&a.name!==a.originalName&&!this.hasChild(a.originalName))a.name=a.originalName;else throw Error("Duplicate name in namespace "+
this.toString(!0)+": "+a.name);this.children.push(a)};e.prototype.hasChild=function(a){var b;if("number"==typeof a)for(b=0;b<this.children.length;b++){if("undefined"!==typeof this.children[b].id&&this.children[b].id==a)return!0}else for(b=0;b<this.children.length;b++)if("undefined"!==typeof this.children[b].name&&this.children[b].name==a)return!0;return!1};e.prototype.getChild=function(a){var b;if("number"==typeof a)for(b=0;b<this.children.length;b++){if("undefined"!==typeof this.children[b].id&&
this.children[b].id==a)return this.children[b]}else for(b=0;b<this.children.length;b++)if("undefined"!==typeof this.children[b].name&&this.children[b].name==a)return this.children[b];return null};e.prototype.resolve=function(b,c){var d=b.split("."),e=this,f=0;if(""==d[f]){for(;null!=e.parent;)e=e.parent;f++}do{do{e=e.getChild(d[f]);if(!(e&&e instanceof a.T)||c&&e instanceof a.Message.Field){e=null;break}f++}while(f<d.length);if(null!=e)break;if(null!==this.parent)return this.parent.resolve(b,c)}while(null!=
e);return e};e.prototype.build=function(){for(var a={},b=this.getChildren(),c,d=0;d<b.length;d++)c=b[d],c instanceof e&&(a[c.name]=c.build());Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1});return a};e.prototype.buildOpt=function(){for(var a={},b=Object.keys(this.options),c=0;c<b.length;c++)a[b[c]]=this.options[b[c]];return a};e.prototype.getOption=function(a){return"undefined"==typeof a?this.options:"undefined"!=typeof this.options[a]?
this.options[a]:null};a.Namespace=e;var b=function(a,b,c){e.call(this,a,b,c);this.extensions=[d.Lang.ID_MIN,d.Lang.ID_MAX];this.clazz=null};b.prototype=Object.create(e.prototype);b.prototype.build=function(c){if(this.clazz&&!c)return this.clazz;c=function(b,c){function d(a,b){var c={},e;for(e in a)a.hasOwnProperty(e)&&(null===a[e]||"object"!==typeof a[e]?c[e]=a[e]:a[e]instanceof f?b&&(c[e]=a.toBuffer()):c[e]=d(a[e],b));return c}var e=c.getChildren(a.Message.Field),g=function(a){b.Builder.Message.call(this);
var c,d;for(c=0;c<e.length;c++)d=e[c],this[d.name]=d.repeated?[]:null;for(c=0;c<e.length;c++)if(d=e[c],"undefined"!=typeof d.options["default"])try{this.$set(d.name,d.options["default"])}catch(g){throw Error("[INTERNAL] "+g);}if(1!=arguments.length||"object"!=typeof a||"function"==typeof a.encode||b.Util.isArray(a)||a instanceof f||a instanceof ArrayBuffer||b.Long&&a instanceof b.Long)for(c=0;c<arguments.length;c++)c<e.length&&this.$set(e[c].name,arguments[c]);else for(d=Object.keys(a),c=0;c<d.length;c++)this.$set(d[c],
a[d[c]])};g.prototype=Object.create(b.Builder.Message.prototype);g.prototype.add=function(a,d,e){var f=c.getChild(a);if(!f)throw Error(this+"#"+a+" is undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));if(!f.repeated)throw Error(this+"#"+a+" is not a repeated field");null===this[f.name]&&(this[f.name]=[]);this[f.name].push(e?d:f.verifyValue(d,!0))};g.prototype.$add=g.prototype.add;g.prototype.set=function(a,d,e){var f=c.getChild(a);if(!f)throw Error(this+
"#"+a+" is not a field: undefined");if(!(f instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+f.toString(!0));this[f.name]=e?d:f.verifyValue(d)};g.prototype.$set=g.prototype.set;g.prototype.get=function(a){var d=c.getChild(a);if(!(d&&d instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: undefined");if(!(d instanceof b.Reflect.Message.Field))throw Error(this+"#"+a+" is not a field: "+d.toString(!0));return this[d.name]};g.prototype.$get=g.prototype.get;
for(var h=0;h<e.length;h++)(function(a){var b=a.originalName.replace(/(_[a-zA-Z])/g,function(a){return a.toUpperCase().replace("_","")}),b=b.substring(0,1).toUpperCase()+b.substring(1),d=a.originalName.replace(/([A-Z])/g,function(a){return"_"+a});c.hasChild("set"+b)||(g.prototype["set"+b]=function(b){this.$set(a.name,b)});c.hasChild("set_"+d)||(g.prototype["set_"+d]=function(b){this.$set(a.name,b)});c.hasChild("get"+b)||(g.prototype["get"+b]=function(){return this.$get(a.name)});c.hasChild("get_"+
d)||(g.prototype["get_"+d]=function(){return this.$get(a.name)})})(e[h]);g.prototype.encode=function(a){var b=!1;a||(a=new f,b=!0);var d=a.littleEndian;try{return c.encode(this,a.LE()),(b?a.flip():a).LE(d)}catch(e){throw a.LE(d),e;}};g.prototype.encodeDelimited=function(a){var b=!1;a||(a=new f,b=!0);try{var d=(new f).LE();c.encode(this,d).flip();a.writeVarint32(d.remaining());a.append(d);return b?a.flip():a}catch(e){throw e;}};g.prototype.encodeAB=function(){try{return this.encode().toArrayBuffer()}catch(a){throw a.encoded&&
(a.encoded=a.encoded.toArrayBuffer()),a;}};g.prototype.toArrayBuffer=g.prototype.encodeAB;g.prototype.encodeNB=function(){try{return this.encode().toBuffer()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBuffer()),a;}};g.prototype.toBuffer=g.prototype.encodeNB;g.prototype.encode64=function(){try{return this.encode().toBase64()}catch(a){throw a.encoded&&(a.encoded=a.encoded.toBase64()),a;}};g.prototype.toBase64=g.prototype.encode64;g.prototype.encodeHex=function(){try{return this.encode().toHex()}catch(a){throw a.encoded&&
(a.encoded=a.encoded.toHex()),a;}};g.prototype.toHex=g.prototype.encodeHex;g.prototype.toRaw=function(a){return d(this,!!a)};g.decode=function(a,b){if(null===a)throw Error("buffer must not be null");"string"===typeof a&&(a=f.wrap(a,b?b:"base64"));a=a instanceof f?a:f.wrap(a);b=a.littleEndian;try{var d=c.decode(a.LE());a.LE(b);return d}catch(e){throw a.LE(b),e;}};g.decodeDelimited=function(a,b){if(null===a)throw Error("buffer must not be null");"string"===typeof a&&(a=f.wrap(a,b?b:"base64"));a=a instanceof
f?a:f.wrap(a);b=a.readVarint32();var d=c.decode(a.slice(a.offset,a.offset+b).LE());a.offset+=b;return d};g.decode64=function(a){return g.decode(a,"base64")};g.decodeHex=function(a){return g.decode(a,"hex")};g.prototype.toString=function(){return c.toString()};Object.defineProperty&&Object.defineProperty(g,"$options",{value:c.buildOpt(),enumerable:!1,configurable:!1,writable:!1});return g}(d,this);for(var e=this.getChildren(),h=0;h<e.length;h++)if(e[h]instanceof k)c[e[h].name]=e[h].build();else if(e[h]instanceof
b)c[e[h].name]=e[h].build();else if(!(e[h]instanceof b.Field))throw Error("Illegal reflect child of "+this.toString(!0)+": "+e[h].toString(!0));return this.clazz=c};b.prototype.encode=function(a,c){for(var d=this.getChildren(b.Field),e=null,f=0;f<d.length;f++){var h=a.$get(d[f].name);d[f].required&&null===h?null===e&&(e=d[f]):d[f].encode(h,c)}if(null!==e)throw a=Error("Missing at least one required field for "+this.toString(!0)+": "+e),a.encoded=c,a;return c};b.prototype.encodeDelimitied=function(a,
b){var c=new f;this.encode(a,c);c.flip();b.writeVarint32(c.remaining());b.append(c);return b};b.prototype.decode=function(a,b){b="number"===typeof b?b:-1;for(var c=a.offset,e=new this.clazz;a.offset<c+b||-1==b&&0<a.remaining();){var f=a.readVarint32(),h=f&7,f=f>>3,k=this.getChild(f);if(k)k.repeated&&!k.options.packed?e.$add(k.name,k.decode(h,a),!0):e.$set(k.name,k.decode(h,a),!0);else switch(h){case d.WIRE_TYPES.VARINT:a.readVarint32();break;case d.WIRE_TYPES.BITS32:a.offset+=4;break;case d.WIRE_TYPES.BITS64:a.offset+=
8;break;case d.WIRE_TYPES.LDELIM:h=a.readVarint32();a.offset+=h;break;default:throw Error("Illegal wire type of unknown field "+f+" in "+this.toString(!0)+"#decode: "+h);}}a=this.getChildren(d.Reflect.Field);for(b=0;b<a.length;b++)if(a[b].required&&null===e[a[b].name])throw a=Error("Missing at least one required field for "+this.toString(!0)+": "+a[b].name),a.decoded=e,a;return e};a.Message=b;var h=function(a,b,e,f,h,k){c.call(this,a,f);this.required="required"==b;this.repeated="repeated"==b;this.type=
e;this.resolvedType=null;this.id=h;this.options=k||{};this.originalName=this.name;d.convertFieldsToCamelCase&&(this.name=this.name.replace(/_([a-zA-Z])/g,function(a,b){return b.toUpperCase()}))};h.prototype=Object.create(c.prototype);h.prototype.verifyValue=function(a,b){b=b||!1;if(null===a){if(this.required)throw Error("Illegal value for "+this.toString(!0)+": "+a+" (required)");return null}var c;if(this.repeated&&!b){d.Util.isArray(a)||(a=[a]);b=[];for(c=0;c<a.length;c++)b.push(this.verifyValue(a[c],
!0));return b}if(!this.repeated&&d.Util.isArray(a))throw Error("Illegal value for "+this.toString(!0)+": "+a+" (no array expected)");if(this.type==d.TYPES.int32||this.type==d.TYPES.sint32||this.type==d.TYPES.sfixed32)return isNaN(c=parseInt(a,10))?c:c|0;if(this.type==d.TYPES.uint32||this.type==d.TYPES.fixed32)return isNaN(c=parseInt(a,10))?c:c>>>0;if(d.Long){if(this.type==d.TYPES.int64||this.type==d.TYPES.sint64||this.type==d.TYPES.sfixed64)return"object"==typeof a&&a instanceof d.Long?a.unsigned?
a.toSigned():a:d.Long.fromNumber(a,!1);if(this.type==d.TYPES.uint64||this.type==d.TYPES.fixed64)return"object"==typeof a&&a instanceof d.Long?a.unsigned?a:a.toUnsigned():d.Long.fromNumber(a,!0)}if(this.type==d.TYPES.bool)return"string"===typeof a?"true"===a:!!a;if(this.type==d.TYPES["float"]||this.type==d.TYPES["double"])return parseFloat(a);if(this.type==d.TYPES.string)return""+a;if(this.type==d.TYPES.bytes)return a&&a instanceof f?a:f.wrap(a);if(this.type==d.TYPES["enum"]){b=this.resolvedType.getChildren(k.Value);
for(c=0;c<b.length;c++)if(b[c].name==a||b[c].id==a)return b[c].id;throw Error("Illegal value for "+this.toString(!0)+": "+a+" (not a valid enum value)");}if(this.type==d.TYPES.message){if("object"!==typeof a)throw Error("Illegal value for "+this.toString(!0)+": "+a+" (object expected)");return a instanceof this.resolvedType.clazz?a:new this.resolvedType.clazz(a)}throw Error("[INTERNAL] Illegal value for "+this.toString(!0)+": "+a+" (undefined type "+this.type+")");};h.prototype.encode=function(a,
b){a=this.verifyValue(a);if(null==this.type||"object"!=typeof this.type)throw Error("[INTERNAL] Unresolved type in "+this.toString(!0)+": "+this.type);if(null===a||this.repeated&&0==a.length)return b;try{if(this.repeated){var c;if(this.options.packed){b.writeVarint32(this.id<<3|d.WIRE_TYPES.LDELIM);b.ensureCapacity(b.offset+=1);var e=b.offset;for(c=0;c<a.length;c++)this.encodeValue(a[c],b);var h=b.offset-e,k=f.calculateVarint32(h);if(1<k){var l=b.slice(e,b.offset),e=e+(k-1);b.offset=e;b.append(l)}b.writeVarint32(h,
e-k)}else for(c=0;c<a.length;c++)b.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(a[c],b)}else b.writeVarint32(this.id<<3|this.type.wireType),this.encodeValue(a,b)}catch(p){throw Error("Illegal value for "+this.toString(!0)+": "+a+" ("+p+")");}return b};h.prototype.encodeValue=function(a,b){if(null!==a){if(this.type==d.TYPES.int32)0>a?b.writeVarint64(a):b.writeVarint32(a);else if(this.type==d.TYPES.uint32)b.writeVarint32(a);else if(this.type==d.TYPES.sint32)b.writeZigZagVarint32(a);
else if(this.type==d.TYPES.fixed32)b.writeUint32(a);else if(this.type==d.TYPES.sfixed32)b.writeInt32(a);else if(this.type==d.TYPES.int64||this.type==d.TYPES.uint64)b.writeVarint64(a);else if(this.type==d.TYPES.sint64)b.writeZigZagVarint64(a);else if(this.type==d.TYPES.fixed64)b.writeUint64(a);else if(this.type==d.TYPES.sfixed64)b.writeInt64(a);else if(this.type==d.TYPES.bool)"string"===typeof a?b.writeVarint32("false"===a.toLowerCase()?0:!!a):b.writeVarint32(a?1:0);else if(this.type==d.TYPES["enum"])b.writeVarint32(a);
else if(this.type==d.TYPES["float"])b.writeFloat32(a);else if(this.type==d.TYPES["double"])b.writeFloat64(a);else if(this.type==d.TYPES.string)b.writeVString(a);else if(this.type==d.TYPES.bytes)a.offset>a.length&&(b=b.clone().flip()),b.writeVarint32(a.remaining()),b.append(a);else if(this.type==d.TYPES.message){var c=(new f).LE();this.resolvedType.encode(a,c);b.writeVarint32(c.offset);b.append(c.flip())}else throw Error("[INTERNAL] Illegal value to encode in "+this.toString(!0)+": "+a+" (unknown type)");
return b}};h.prototype.decode=function(a,b,c){if(a!=this.type.wireType&&(c||a!=d.WIRE_TYPES.LDELIM||!this.repeated))throw Error("Illegal wire type for field "+this.toString(!0)+": "+a+" ("+this.type.wireType+" expected)");if(a==d.WIRE_TYPES.LDELIM&&this.repeated&&this.options.packed&&!c){a=b.readVarint32();a=b.offset+a;for(c=[];b.offset<a;)c.push(this.decode(this.type.wireType,b,!0));return c}if(this.type==d.TYPES.int32)return b.readVarint32()|0;if(this.type==d.TYPES.uint32)return b.readVarint32()>>>
0;if(this.type==d.TYPES.sint32)return b.readZigZagVarint32()|0;if(this.type==d.TYPES.fixed32)return b.readUint32()>>>0;if(this.type==d.TYPES.sfixed32)return b.readInt32()|0;if(this.type==d.TYPES.int64)return b.readVarint64();if(this.type==d.TYPES.uint64)return b.readVarint64().toUnsigned();if(this.type==d.TYPES.sint64)return b.readZigZagVarint64();if(this.type==d.TYPES.fixed64)return b.readUint64();if(this.type==d.TYPES.sfixed64)return b.readInt64();if(this.type==d.TYPES.bool)return!!b.readVarint32();
if(this.type==d.TYPES["enum"])return b.readVarint32();if(this.type==d.TYPES["float"])return b.readFloat();if(this.type==d.TYPES["double"])return b.readDouble();if(this.type==d.TYPES.string)return b.readVString();if(this.type==d.TYPES.bytes){a=b.readVarint32();if(b.remaining()<a)throw Error("Illegal number of bytes for "+this.toString(!0)+": "+a+" required but got only "+b.remaining());c=b.clone();c.length=c.offset+a;b.offset+=a;return c}if(this.type==d.TYPES.message)return a=b.readVarint32(),this.resolvedType.decode(b,
a);throw Error("[INTERNAL] Illegal wire type for "+this.toString(!0)+": "+a);};a.Message.Field=h;var k=function(a,b,c){e.call(this,a,b,c);this.object=null};k.prototype=Object.create(e.prototype);k.prototype.build=function(){for(var a={},b=this.getChildren(k.Value),c=0;c<b.length;c++)a[b[c].name]=b[c].id;Object.defineProperty&&Object.defineProperty(a,"$options",{value:this.buildOpt(),enumerable:!1,configurable:!1,writable:!1});return this.object=a};a.Enum=k;h=function(a,b,d){c.call(this,a,b);this.id=
d};h.prototype=Object.create(c.prototype);a.Enum.Value=h;var p=function(a,b,c){e.call(this,a,b,c);this.clazz=null};p.prototype=Object.create(e.prototype);p.prototype.build=function(b){return this.clazz&&!b?this.clazz:this.clazz=function(b,c){var d=function(a){b.Builder.Service.call(this);this.rpcImpl=a||function(a,b,c){setTimeout(c.bind(this,Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")),0)}};d.prototype=Object.create(b.Builder.Service.prototype);Object.defineProperty&&
(Object.defineProperty(d,"$options",{value:c.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(d.prototype,"$options",{value:d.$options,enumerable:!1,configurable:!1,writable:!1}));for(var e=c.getChildren(a.Service.RPCMethod),f=0;f<e.length;f++)(function(a){d.prototype[a.name]=function(b,d){try{b&&b instanceof a.resolvedRequestType.clazz||setTimeout(d.bind(this,Error("Illegal request type provided to service method "+c.name+"#"+a.name))),this.rpcImpl(a.fqn(),b,function(b,
e){if(b)d(b);else{try{e=a.resolvedResponseType.clazz.decode(e)}catch(f){}e&&e instanceof a.resolvedResponseType.clazz?d(null,e):d(Error("Illegal response type received in service method "+c.name+"#"+a.name))}})}catch(e){setTimeout(d.bind(this,e),0)}};d[a.name]=function(b,c,e){(new d(b))[a.name](c,e)};Object.defineProperty&&(Object.defineProperty(d[a.name],"$options",{value:a.buildOpt(),enumerable:!1,configurable:!1,writable:!1}),Object.defineProperty(d.prototype[a.name],"$options",{value:d[a.name].$options,
enumerable:!1,configurable:!1,writable:!1}))})(e[f]);return d}(d,this)};a.Service=p;var l=function(a,b,d){c.call(this,a,b);this.options=d||{}};l.prototype=Object.create(c.prototype);l.prototype.buildOpt=e.prototype.buildOpt;a.Service.Method=l;h=function(a,b,c,d,e){l.call(this,a,b,e);this.requestName=c;this.responseName=d;this.resolvedResponseType=this.resolvedRequestType=null};h.prototype=Object.create(l.prototype);a.Service.RPCMethod=h;return a}(d);d.Builder=function(d,a,c){var e=function(){this.ptr=
this.ns=new c.Namespace(null,"");this.resolved=!1;this.result=null;this.files={};this.importRoot=null};e.prototype.reset=function(){this.ptr=this.ns};e.prototype.define=function(b,d){if("string"!==typeof b||!a.TYPEREF.test(b))throw Error("Illegal package name: "+b);b=b.split(".");var e;for(e=0;e<b.length;e++)if(!a.NAME.test(b[e]))throw Error("Illegal package name: "+b[e]);for(e=0;e<b.length;e++)this.ptr.hasChild(b[e])||this.ptr.addChild(new c.Namespace(this.ptr,b[e],d)),this.ptr=this.ptr.getChild(b[e]);
return this};e.isValidMessage=function(b){if("string"!==typeof b.name||!a.NAME.test(b.name)||"undefined"!==typeof b.values||"undefined"!==typeof b.rpc)return!1;var c;if("undefined"!==typeof b.fields){if(!d.Util.isArray(b.fields))return!1;var f=[],p;for(c=0;c<b.fields.length;c++){if(!e.isValidMessageField(b.fields[c]))return!1;p=parseInt(b.fields[c].id,10);if(0<=f.indexOf(p))return!1;f.push(p)}}if("undefined"!==typeof b.enums){if(!d.Util.isArray(b.enums))return!1;for(c=0;c<b.enums.length;c++)if(!e.isValidEnum(b.enums[c]))return!1}if("undefined"!==
typeof b.messages){if(!d.Util.isArray(b.messages))return!1;for(c=0;c<b.messages.length;c++)if(!e.isValidMessage(b.messages[c])&&!e.isValidExtend(b.messages[c]))return!1}return"undefined"===typeof b.extensions||d.Util.isArray(b.extensions)&&2===b.extensions.length&&"number"===typeof b.extensions[0]&&"number"===typeof b.extensions[1]?!0:!1};e.isValidMessageField=function(b){if("string"!==typeof b.rule||"string"!==typeof b.name||"string"!==typeof b.type||"undefined"===typeof b.id||!(a.RULE.test(b.rule)&&
a.NAME.test(b.name)&&a.TYPEREF.test(b.type)&&a.ID.test(""+b.id)))return!1;if("undefined"!=typeof b.options){if("object"!=typeof b.options)return!1;for(var c=Object.keys(b.options),d=0;d<c.length;d++)if(!a.OPTNAME.test(c[d])||"string"!==typeof b.options[c[d]]&&"number"!==typeof b.options[c[d]]&&"boolean"!==typeof b.options[c[d]])return!1}return!0};e.isValidEnum=function(b){if("string"!==typeof b.name||!a.NAME.test(b.name)||"undefined"===typeof b.values||!d.Util.isArray(b.values)||0==b.values.length)return!1;
for(var c=0;c<b.values.length;c++)if("object"!=typeof b.values[c]||"string"!==typeof b.values[c].name||"undefined"===typeof b.values[c].id||!a.NAME.test(b.values[c].name)||!a.NEGID.test(""+b.values[c].id))return!1;return!0};e.prototype.create=function(b){if(b&&(d.Util.isArray(b)||(b=[b]),0!=b.length)){var f=[],k,p,l,g,n;for(f.push(b);0<f.length;){b=f.pop();if(d.Util.isArray(b))for(;0<b.length;)if(k=b.shift(),e.isValidMessage(k)){p=new c.Message(this.ptr,k.name,k.options);if(k.fields&&0<k.fields.length)for(g=
0;g<k.fields.length;g++){if(p.hasChild(k.fields[g].id))throw Error("Duplicate field id in message "+p.name+": "+k.fields[g].id);if(k.fields[g].options)for(l=Object.keys(k.fields[g].options),n=0;n<l.length;n++){if(!a.OPTNAME.test(l[n]))throw Error("Illegal field option name in message "+p.name+"#"+k.fields[g].name+": "+l[n]);if("string"!==typeof k.fields[g].options[l[n]]&&"number"!==typeof k.fields[g].options[l[n]]&&"boolean"!==typeof k.fields[g].options[l[n]])throw Error("Illegal field option value in message "+
p.name+"#"+k.fields[g].name+"#"+l[n]+": "+k.fields[g].options[l[n]]);}p.addChild(new c.Message.Field(p,k.fields[g].rule,k.fields[g].type,k.fields[g].name,k.fields[g].id,k.fields[g].options))}l=[];if("undefined"!==typeof k.enums&&0<k.enums.length)for(g=0;g<k.enums.length;g++)l.push(k.enums[g]);if(k.messages&&0<k.messages.length)for(g=0;g<k.messages.length;g++)l.push(k.messages[g]);k.extensions&&(p.extensions=k.extensions,p.extensions[0]<d.Lang.ID_MIN&&(p.extensions[0]=d.Lang.ID_MIN),p.extensions[1]>
d.Lang.ID_MAX&&(p.extensions[1]=d.Lang.ID_MAX));this.ptr.addChild(p);0<l.length&&(f.push(b),b=l,this.ptr=p)}else if(e.isValidEnum(k)){p=new c.Enum(this.ptr,k.name,k.options);for(g=0;g<k.values.length;g++)p.addChild(new c.Enum.Value(p,k.values[g].name,k.values[g].id));this.ptr.addChild(p)}else if(e.isValidService(k)){p=new c.Service(this.ptr,k.name,k.options);for(g in k.rpc)k.rpc.hasOwnProperty(g)&&p.addChild(new c.Service.RPCMethod(p,g,k.rpc[g].request,k.rpc[g].response,k.rpc[g].options));this.ptr.addChild(p)}else if(e.isValidExtend(k))if(p=
this.ptr.resolve(k.ref))for(g=0;g<k.fields.length;g++){if(p.hasChild(k.fields[g].id))throw Error("Duplicate extended field id in message "+p.name+": "+k.fields[g].id);if(k.fields[g].id<p.extensions[0]||k.fields[g].id>p.extensions[1])throw Error("Illegal extended field id in message "+p.name+": "+k.fields[g].id+" ("+p.extensions.join(" to ")+" expected)");p.addChild(new c.Message.Field(p,k.fields[g].rule,k.fields[g].type,k.fields[g].name,k.fields[g].id,k.fields[g].options))}else{if(!/\.?google\.protobuf\./.test(k.ref))throw Error("Extended message "+
k.ref+" is not defined");}else throw Error("Not a valid message, enum, service or extend definition: "+JSON.stringify(k));else throw Error("Not a valid namespace definition: "+JSON.stringify(b));this.ptr=this.ptr.parent}this.resolved=!1;this.result=null;return this}};e.isValidImport=function(a){return!/google\/protobuf\//.test(a)};e.prototype["import"]=function(a,c){if("string"===typeof c){d.Util.IS_NODE&&(c=module.require("path").resolve(c));if(this.files[c])return this.reset(),this;this.files[c]=
!0}if(a.imports&&0<a.imports.length){var f,p="/",l=!1;if("object"===typeof c){if(this.importRoot=c.root,l=!0,f=this.importRoot,c=c.file,0<=f.indexOf("\\")||0<=c.indexOf("\\"))p="\\"}else"string"===typeof c?this.importRoot?f=this.importRoot:0<=c.indexOf("/")?(f=c.replace(/\/[^\/]*$/,""),""===f&&(f="/")):0<=c.indexOf("\\")?(f=c.replace(/\\[^\\]*$/,""),p="\\"):f=".":f=null;for(var g=0;g<a.imports.length;g++)if("string"===typeof a.imports[g]){if(!f)throw Error("Cannot determine import root: File name is unknown");
var n=f+p+a.imports[g];if(e.isValidImport(n)){/\.proto$/i.test(n)&&!d.DotProto&&(n=n.replace(/\.proto$/,".json"));var x=d.Util.fetch(n);if(null===x)throw Error("Failed to import '"+n+"' in '"+c+"': File not found");if(/\.json$/i.test(n))this["import"](JSON.parse(x+""),n);else this["import"]((new d.DotProto.Parser(x+"")).parse(),n)}}else if(c)if(/\.(\w+)$/.test(c))this["import"](a.imports[g],c.replace(/^(.+)\.(\w+)$/,function(a,b,c){return b+"_import"+g+"."+c}));else this["import"](a.imports[g],c+
"_import"+g);else this["import"](a.imports[g]);l&&(this.importRoot=null)}a.messages&&(a["package"]&&this.define(a["package"],a.options),this.create(a.messages),this.reset());a.enums&&(a["package"]&&this.define(a["package"],a.options),this.create(a.enums),this.reset());a.services&&(a["package"]&&this.define(a["package"],a.options),this.create(a.services),this.reset());a["extends"]&&(a["package"]&&this.define(a["package"],a.options),this.create(a["extends"]),this.reset());return this};e.isValidService=
function(b){return"string"===typeof b.name&&a.NAME.test(b.name)&&"object"===typeof b.rpc?!0:!1};e.isValidExtend=function(b){if("string"!==typeof b.ref||!a.TYPEREF.test(b.name))return!1;var c;if("undefined"!==typeof b.fields){if(!d.Util.isArray(b.fields))return!1;var f=[],n;for(c=0;c<b.fields.length;c++){if(!e.isValidMessageField(b.fields[c]))return!1;n=parseInt(b.id,10);if(0<=f.indexOf(n))return!1;f.push(n)}}return!0};e.prototype.resolveAll=function(){var b;if(null!=this.ptr&&"object"!==typeof this.ptr.type){if(this.ptr instanceof
c.Namespace){b=this.ptr.getChildren();for(var e=0;e<b.length;e++)this.ptr=b[e],this.resolveAll()}else if(this.ptr instanceof c.Message.Field)if(a.TYPE.test(this.ptr.type))this.ptr.type=d.TYPES[this.ptr.type];else{if(!a.TYPEREF.test(this.ptr.type))throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);b=this.ptr.parent.resolve(this.ptr.type,!0);if(!b)throw Error("Unresolvable type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);this.ptr.resolvedType=b;if(b instanceof
c.Enum)this.ptr.type=d.TYPES["enum"];else if(b instanceof c.Message)this.ptr.type=d.TYPES.message;else throw Error("Illegal type reference in "+this.ptr.toString(!0)+": "+this.ptr.type);}else if(!(this.ptr instanceof d.Reflect.Enum.Value))if(this.ptr instanceof d.Reflect.Service.Method)if(this.ptr instanceof d.Reflect.Service.RPCMethod){b=this.ptr.parent.resolve(this.ptr.requestName);if(!(b&&b instanceof d.Reflect.Message))throw Error("Illegal request type reference in "+this.ptr.toString(!0)+": "+
this.ptr.requestName);this.ptr.resolvedRequestType=b;b=this.ptr.parent.resolve(this.ptr.responseName);if(!(b&&b instanceof d.Reflect.Message))throw Error("Illegal response type reference in "+this.ptr.toString(!0)+": "+this.ptr.responseName);this.ptr.resolvedResponseType=b}else throw Error("Illegal service method type in "+this.ptr.toString(!0));else throw Error("Illegal object type in namespace: "+typeof this.ptr+":"+this.ptr);this.reset()}};e.prototype.build=function(a){this.reset();this.resolved||
(this.resolveAll(),this.resolved=!0,this.result=null);null==this.result&&(this.result=this.ns.build());if(a){a=a.split(".");for(var c=this.result,d=0;d<a.length;d++)if(c[a[d]])c=c[a[d]];else{c=null;break}return c}return this.result};e.prototype.lookup=function(a){return a?this.ns.resolve(a):this.ns};e.prototype.toString=function(){return"Builder"};e.Message=function(){};e.Service=function(){};return e}(d,d.Lang,d.Reflect);d.loadProto=function(f,a,c){if("string"==typeof a||a&&"string"===typeof a.file&&
"string"===typeof a.root)c=a,a=null;return d.loadJson((new d.DotProto.Parser(f+"")).parse(),a,c)};d.protoFromString=d.loadProto;d.loadProtoFile=function(f,a,c){a&&"object"===typeof a?(c=a,a=null):a&&"function"===typeof a||(a=null);if(a)d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f,function(b){a(d.loadProto(b,c,f))});else{var e=d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f);return null!==e?d.protoFromString(e,c,f):null}};d.protoFromFile=d.loadProtoFile;d.newBuilder=function(f,a){var c=
new d.Builder;"undefined"!==typeof f&&null!==f&&c.define(f,a);return c};d.loadJson=function(f,a,c){if("string"===typeof a||a&&"string"===typeof a.file&&"string"===typeof a.root)c=a,a=null;a&&"object"===typeof a||(a=d.newBuilder());"string"===typeof f&&(f=JSON.parse(f));a["import"](f,c);a.resolveAll();a.build();return a};d.loadJsonFile=function(f,a,c){a&&"object"===typeof a?(c=a,a=null):a&&"function"===typeof a||(a=null);if(a)d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f,function(b){try{a(d.loadJson(JSON.parse(b),
c,f))}catch(e){a(e)}});else{var e=d.Util.fetch("object"===typeof f?f.root+"/"+f.file:f);return null!==e?d.loadJson(JSON.parse(e),c,f):null}};return d}(n.dcodeIO.ByteBuffer)})(this)})});
/* ******** */
(function(x){var p=window.AmazonUIPageJS||window.P,C=p._namespace||p.attributeErrors,k=C?C("CampfireJSJaC_AUIBuild",""):p;k.guardFatal?k.guardFatal(x)(k,window):k.execute(function(){x(k,window)})})(function(x,p,C){x.when("3p-JSJaC-Config","3p-JSJaC-Crypt").register("3p-JSJaC",function(k,A){function e(){}function f(){}function d(a){a&&a.httpbase&&(this._httpbase=a.httpbase);this.oDbg=a&&a.oDbg&&a.oDbg.log?a.oDbg:{log:function(){}};a&&a.timerval?this.setPollInterval(a.timerval):this.setPollInterval(k.JSJAC_TIMERVAL);
this._cookie_prefix=a&&a.cookie_prefix?a.cookie_prefix:"";this._connected=!1;this._events=[];this._keys=null;this._ID=0;this._inQ=[];this._pQueue=[];this._regIDs=[];this._req=[];this._status="intialized";this._errcnt=0;this._inactivity=k.JSJAC_INACTIVITY;this._sendRawCallbacks=[];this._serverName=this._serverIP="unknown"}function h(a,b,c){if(p==this)return new h(a,b,c);this.code=a;this.type=b;this.cond=c}function q(a,b,c,g,d){if(p==this)return new q(a,b,c,g,d);this.name=a;this.value=b;this.secs=c;
this.domain=g;this.path=d;this.write=function(){var a;this.secs?(a=new Date,a.setTime(a.getTime()+1E3*this.secs),a="; expires\x3d"+a.toGMTString()):a="";var b=this.domain?"; domain\x3d"+this.domain:"",c=this.path?"; path\x3d"+this.path:"; path\x3d/";document.cookie=this.getName()+"\x3d"+q._escape(this.getValue())+a+b+c};this.erase=function(){(new q(this.getName(),"",-1)).write()};this.getName=function(){return this.name};this.setName=function(a){this.name=a;return this};this.getValue=function(){return this.value};
this.setValue=function(a){this.value=a;return this};this.setDomain=function(a){this.domain=a;return this};this.setPath=function(a){this.path=a;return this}}function M(a){this.message=a;this.name="CookieException"}function n(a,b,c,g){var d=f.create("error","jsjac");d.documentElement.setAttribute("code",a);d.documentElement.setAttribute("type",b);c&&d.documentElement.appendChild(d.createElement(c)).setAttribute("xmlns",L);if(g)for(g=Array.prototype.slice.call(g),a=0;a<g.length;a++)d.documentElement.appendChild(g[a]);
return d.documentElement}function F(a){a&&a.appID&&(this._appID=a.appID);a&&a.apiKey&&(this._apiKey=a.apiKey);a&&a.apiSecret&&(this._apiSecret=a.apiSecret);this._perms="";this._session=C}function u(a){this.base=d;this.base(a);this._hold=k.JSJACHBC_MAX_HOLD;this._inactivity=0;this._last_requests={};this._pause=this._min_polling=this._last_rid=0;this._wait=a.wait||k.JSJACHBC_MAX_WAIT}function w(a){this.base=d;this.base(a);J=!1}function v(a){this._resource=this._domain=this._node="";"string"==typeof a?
(-1!=a.indexOf("@")&&(this.setNode(a.substring(0,a.indexOf("@"))),a=a.substring(a.indexOf("@")+1)),-1!=a.indexOf("/")&&(this.setResource(a.substring(a.indexOf("/")+1)),a=a.substring(0,a.indexOf("/"))),this.setDomain(a)):(this.setNode(a.node),this.setDomain(a.domain),this.setResource(a.resource))}function x(a){this.message=a;this.name="JSJaCJIDInvalidException"}function G(){}function r(a,b){var c=Math.random();this._k=[];this._k[0]=c.toString();b?this.oDbg=b:(this.oDbg={},this.oDbg.log=function(){});
if(a)for(c=1;c<k.JSJAC_NKEYS;c++)this._k[c]=a(this._k[c-1]),b.log(c+": "+this._k[c],4);this._indexAt=k.JSJAC_NKEYS-1;this.getKey=function(){return this._k[this._indexAt--]};this.lastKey=function(){return 0==this._indexAt};this.size=function(){return this._k.length};this._getSuspendVars=function(){return["_k","_indexAt"]}}function m(a){this.name=a;this.doc="undefined"!=typeof J&&J?f.create(a,N):f.create(a,"")}function y(){this.base=m;this.base("presence")}function z(){this.base=m;this.base("iq")}function B(){this.base=
m;this.base("message")}function t(a){this.base=d;this.base(a);this._ws=null;this.registerHandler("onerror",l.bind(this._cleanupWebSocket,this))}p.XDomainRequest&&document.all&&!p.atob&&(p.ieXDRToXHR=function(a){var b=a.XMLHttpRequest;a.XMLHttpRequest=function(){this.onreadystatechange=Object;this.xdr=this.xhr=null;this.readyState=0;this.status="";this.send=this.abort=this.setRequestHeader=this.getAllResponseHeaders=this.getResponseHeader=this.responseText=this.statusText=null;this.isxdr=!1;var a=
this;a.xdrLoadedBinded=function(){a.xdrLoaded()};a.xdrErrorBinded=function(){a.xdrError()};a.xdrProgressBinded=function(){a.xdrProgress()};a.xhrReadyStateChangedBinded=function(){a.xhrReadyStateChanged()}};XMLHttpRequest.prototype.open=function(c,g,d,e,f){0>g.indexOf(document.domain)&&0<g.indexOf("http-bind")?(null===this.xdr&&(this.xdr=new a.XDomainRequest),this.isxdr=!0,this.setXDRActive(),this.xdr.open(c,g)):(null===this.xhr&&(this.xhr=new b),this.isxdr=!1,this.setXHRActive(),this.xhr.open(c,g,
d,e,f))};XMLHttpRequest.prototype.xdrGetResponseHeader=function(a){return"Content-Type"===a&&""<this.xdr.contentType?this.xdr.contentType:""};XMLHttpRequest.prototype.xdrGetAllResponseHeaders=function(){return""<this.xdr.contentType?"Content-Type: "+this.xdr.contentType:""};XMLHttpRequest.prototype.xdrSetRequestHeader=function(a,b){};XMLHttpRequest.prototype.xdrLoaded=function(){if(null!==this.onreadystatechange){this.readyState=4;this.status=200;this.statusText="OK";this.responseText=this.xdr.responseText;
if(a.ActiveXObject){var b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(this.responseText);this.responseXML=b}this.onreadystatechange()}};XMLHttpRequest.prototype.xdrError=function(){null!==this.onreadystatechange&&(this.readyState=4,this.status=0,this.responseText=this.statusText="",this.onreadystatechange())};XMLHttpRequest.prototype.xdrProgress=function(){null!==this.onreadystatechange&&3!==this.status&&(this.status=this.readyState=3,this.statusText="",this.onreadystatechange())};
XMLHttpRequest.prototype.finalXDRRequest=function(){var a=this.xdr;delete a.onload;delete a.onerror;delete a.onprogress};XMLHttpRequest.prototype.sendXDR=function(a){var b=this.xdr;b.onload=this.xdrLoadedBinded;b.onerror=this.xdr.ontimeout=this.xdrErrorBinded;b.onprogress=this.xdrProgressBinded;this.responseText=null;this.xdr.send(a)};XMLHttpRequest.prototype.abortXDR=function(){this.finalXDRRequest();this.xdr.abort()};XMLHttpRequest.prototype.setXDRActive=function(){this.send=this.sendXDR;this.abort=
this.abortXDR;this.getResponseHeader=this.xdrGetResponseHeader;this.getAllResponseHeaders=this.xdrGetAllResponseHeaders;this.setRequestHeader=this.xdrSetRequestHeader};XMLHttpRequest.prototype.xhrGetResponseHeader=function(a){return this.xhr.getResponseHeader(a)};XMLHttpRequest.prototype.xhrGetAllResponseHeaders=function(){return this.xhr.getAllResponseHeaders()};XMLHttpRequest.prototype.xhrSetRequestHeader=function(a,b){return this.xhr.setRequestHeader(a,b)};XMLHttpRequest.prototype.xhrReadyStateChanged=
function(){if(null!==this.onreadystatechange&&this.readyState!==this.xhr.readyState){var a=this.xhr;this.readyState=a.readyState;4===this.readyState&&(this.status=a.status,this.statusText=a.statusText,this.responseText=a.responseText,this.responseXML=a.responseXML);this.onreadystatechange()}};XMLHttpRequest.prototype.finalXHRRequest=function(){delete this.xhr.onreadystatechange};XMLHttpRequest.prototype.abortXHR=function(){this.finalXHRRequest();this.xhr.abort()};XMLHttpRequest.prototype.sendXHR=
function(a){this.xhr.onreadystatechange=this.xhrReadyStateChangedBinded;this.xhr.send(a)};XMLHttpRequest.prototype.setXHRActive=function(){this.send=this.sendXHR;this.abort=this.abortXHR;this.getResponseHeader=this.xhrGetResponseHeader;this.getAllResponseHeaders=this.xhrGetAllResponseHeaders;this.setRequestHeader=this.xhrSetRequestHeader};a.ieXDRToXHR=C},p.ieXDRToXHR(p));Object.defineProperty(String.prototype,"htmlEnc",{enumerable:!1,value:function(){if(!this)return this;var a=this.replace(/&/g,"\x26amp;"),
a=a.replace(/</g,"\x26lt;"),a=a.replace(/>/g,"\x26gt;"),a=a.replace(/\"/g,"\x26quot;");return a=a.replace(/\n/g,"\x3cbr /\x3e")}});Object.defineProperty(String.prototype,"revertHtmlEnc",{enumerable:!1,value:function(){if(!this)return this;var a=this.replace(/&amp;/gi,"\x26"),a=a.replace(/&lt;/gi,"\x3c"),a=a.replace(/&gt;/gi,"\x3e"),a=a.replace(/&quot;/gi,'"');return a=a.replace(/<br( )?(\/)?>/gi,"\n")}});Date.jab2date=function(a){var b=new Date(Date.UTC(a.substr(0,4),a.substr(5,2)-1,a.substr(8,2),
a.substr(11,2),a.substr(14,2),a.substr(17,2)));if("Z"!=a.substr(a.length-6,1)){var c=new Date;c.setTime(0);c.setUTCHours(a.substr(a.length-5,2));c.setUTCMinutes(a.substr(a.length-2,2));"+"==a.substr(a.length-6,1)?b.setTime(b.getTime()-c.getTime()):"-"==a.substr(a.length-6,1)&&b.setTime(b.getTime()+c.getTime())}return b};Date.hrTime=function(a){return Date.jab2date(a).toLocaleString()};Date.prototype.jabberDate=function(){var a=function(a){return 10>a?"0"+a:a},b=this.getUTCFullYear()+"-",b=b+(a(this.getUTCMonth()+
1)+"-"),b=b+(a(this.getUTCDate())+"T"),b=b+(a(this.getUTCHours())+":"),b=b+(a(this.getUTCMinutes())+":");return b+=a(this.getUTCSeconds())+"Z"};Number.max=function(a,b){return a>b?a:b};Number.min=function(a,b){return a<b?a:b};e.create=function(){try{if(p.XMLHttpRequest){var a=new XMLHttpRequest;null===a.readyState&&(a.readyState=1,a.addEventListener("load",function(){a.readyState=4;if("function"==typeof a.onreadystatechange)a.onreadystatechange()},!1));return a}if(p.ActiveXObject)return new ActiveXObject(e.getPrefix()+
".XmlHttp")}catch(b){}throw Error("Your browser does not support XmlHttp objects");};e.getPrefix=function(){if(e.prefix)return e.prefix;for(var a=["MSXML2","Microsoft","MSXML","MSXML3"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b]+".XmlHttp"),e.prefix=a[b]}catch(c){}throw Error("Could not find an installed XML parser");};f.create=function(a,b){a=a||"foo";b=b||"";try{var c;document.implementation&&document.implementation.createDocument?(c=document.implementation.createDocument(b,a,null),null===
c.readyState&&(c.readyState=1,c.addEventListener("load",function(){c.readyState=4;if("function"==typeof c.onreadystatechange)c.onreadystatechange()},!1))):p.ActiveXObject&&(c=new ActiveXObject(f.getPrefix()+".DomDocument"));if(!c.documentElement||c.documentElement.tagName!=a||c.documentElement.namespaceURI&&c.documentElement.namespaceURI!=b)try{""!==b?c.appendChild(c.createElement(a)).setAttribute("xmlns",b):c.appendChild(c.createElement(a))}catch(g){c=document.implementation.createDocument(b,a,null),
null===c.documentElement&&c.appendChild(c.createElement(a)),""!==b&&c.documentElement.getAttribute("xmlns")!=b&&c.documentElement.setAttribute("xmlns",b)}return c}catch(g){}throw Error("Your browser does not support XmlDocument objects");};f.getPrefix=function(){if(f.prefix)return f.prefix;for(var a=["MSXML2","Microsoft","MSXML","MSXML3"],b=0;b<a.length;b++)try{return new ActiveXObject(a[b]+".DomDocument"),f.prefix=a[b]}catch(c){}throw Error("Could not find an installed XML parser");};"undefined"!=
typeof Document&&p.DOMParser&&(Document.prototype.loadXML=function(a){for(a=(new DOMParser).parseFromString(a,"text/xml");this.hasChildNodes();)this.removeChild(this.lastChild);for(var b=0;b<a.childNodes.length;b++)this.appendChild(this.importNode(a.childNodes[b],!0))});p.XMLSerializer&&p.Node&&Node.prototype&&Node.prototype.__defineGetter__&&(XMLDocument.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}),Document.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}),
Node.prototype.__defineGetter__("xml",function(){return(new XMLSerializer).serializeToString(this)}));var l={Version:"1.4",require:function(a){document.write('\x3cscript type\x3d"text/javascript" src\x3d"'+a+'"\x3e\x3c/script\x3e')},load:function(){var a="xmlextras jsextras crypt JSJaCConfig JSJaCConstants JSJaCCookie JSJaCJSON JSJaCJID JSJaCBuilder JSJaCPacket JSJaCError JSJaCKeys JSJaCConnection JSJaCHttpPollingConnection JSJaCHttpBindingConnection JSJaCConsoleLogger JSJaCFBApplication JSJaCWebSocketConnection".split(" "),
b=document.getElementsByTagName("script"),c="./",g;for(g=0;g<b.length;g++)if(b.item(g).src&&b.item(g).src.match(/JSJaC\.js$/)){c=b.item(g).src.replace(/JSJaC.js$/,"");break}for(g=0;g<a.length;g++)this.require(c+a[g]+".js")},bind:function(a,b,c){return function(g){return a.apply(b,[g,c])}}};"undefined"==typeof d&&l.load();var D={buildNode:function(a,b,c,g,d){if(c)if(D._isStringOrNumber(c)||c instanceof Array)b=this._createElement(a,b,d),D._children(a,b,c);else{d=c.xmlns||d;b=this._createElement(a,
b,d);for(var e in c)c.hasOwnProperty(e)&&"xmlns"!=e&&b.setAttribute(e,c[e])}else b=this._createElement(a,b,d);g&&D._children(a,b,g,d);return b},_createElement:function(a,b,c){try{if(c)return a.createElementNS(c,b)}catch(g){}a=a.createElement(b);c&&a.setAttribute("xmlns",c);return a},_text:function(a,b){return a.createTextNode(b)},_children:function(a,b,c,g){if("object"==typeof c)for(var d in c){if(c.hasOwnProperty(d)){var e=c[d];"object"==typeof e?(e instanceof Array&&(e=D.buildNode(a,e[0],e[1],e[2],
g)),b.appendChild(e)):D._isStringOrNumber(e)&&b.appendChild(D._text(a,e))}}else D._isStringOrNumber(c)&&b.appendChild(D._text(a,c))},_attributes:function(a){var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c+'\x3d"'+a[c].toString().htmlEnc()+'"');return b.join(" ")},_isStringOrNumber:function(a){return"string"==typeof a||"number"==typeof a}};d.prototype.ensureResponseXML=function(a){if(!a.responseXML||""===a.responseXML)try{a.responseXML=(new DOMParser).parseFromString(a.responseText)}catch(b){this.oDbg.log("Improper response XML error.",
1)}};d.prototype.connect=function(a){this._setStatus("connecting");if("x-facebook-platform"!=a.authtype)this.domain=a.domain||"localhost",this.username=a.username,this.resource=a.resource,this.pass=a.password||a.pass,this.register=a.register,this.authhost=a.authhost||a.host||a.domain,this.authtype=a.authtype||"sasl";else if(this.domain="chat.facebook.com",this.authtype=a.authtype,a.facebookApp!==C){this._facebookApp=a.facebookApp;if(!document.getElementById("fb-root")){var b=document.createElement("div");
b.id="fb-root";document.body.appendChild(b)}if(a.facebookApp.getSession()===C){this._facebookApp.Login(this,a);return}}else{this.oDbg.log("No Facebook application param specified!",1);return}this._xmllang=a.xmllang&&""!==a.xmllang?a.xmllang:"en";this._allow_plain=a.allow_plain?a.allow_plain:k.JSJAC_ALLOW_PLAIN;this.host=a.host;this.port=a.port||5222;this.secure=a.secure?"true":"false";this.jid=this.username+"@"+this.domain;this.fulljid=this.jid+"/"+this.resource;this._rid=Math.round(100000.5+799999.99999*
Math.random());var c=this._getFreeSlot();this._req[c]=this._setupRequest(!0);a=this._getInitialRequestString();this.oDbg.log(a,4);this._req[c].r.onreadystatechange=l.bind(function(){var a=this._req[c].r;4==a.readyState&&(this.oDbg.log("async recv: "+a.responseText,4),this.ensureResponseXML(a),this._handleInitialResponse(a))},this);"undefined"!=typeof this._req[c].r.onerror&&(this._req[c].r.onerror=l.bind(function(a){this.oDbg.log("XmlHttpRequest error",1)},this));this._req[c].r.send(a)};d.prototype.connected=
function(){return this._connected};d.prototype.disconnect=function(){this._setStatus("disconnecting");if(this.connected()){this._connected=!1;clearInterval(this._interval);clearInterval(this._inQto);this._timeout&&clearTimeout(this._timeout);var a=this._getFreeSlot();this._req[a]=this._setupRequest(!1);var b=this._getRequestString(!1,!0);this.oDbg.log("Disconnecting: "+b,4);try{this._req[a].r.send(b)}catch(c){}this.oDbg.log("disconnected");try{q.read(this._cookie_prefix+"JSJaC_State").erase()}catch(c){}this._handleEvent("ondisconnect")}};
d.prototype.getPollInterval=function(){return this._timerval};d.prototype.registerHandler=function(a){a=a.toLowerCase();var b={handler:arguments[arguments.length-1],childName:"*",childNS:"*",type:"*"};2<arguments.length&&(b.childName=arguments[1]);3<arguments.length&&(b.childNS=arguments[2]);4<arguments.length&&(b.type=arguments[3]);this._events[a]=this._events[a]?this._events[a].concat(b):Array(b);this._events[a]=this._events[a].sort(function(a,b){var d=0,e=0;"*"==a.type&&d++;"*"==a.childNS&&d++;
"*"==a.childName&&d++;"*"==b.type&&e++;"*"==b.childNS&&e++;"*"==b.childName&&e++;return d>e?1:d<e?-1:0});this.oDbg.log("registered handler for event '"+a+"'",2)};d.prototype.unregisterHandler=function(a,b){a=a.toLowerCase();if(this._events[a]){for(var c=this._events[a],g=[],d=0;d<c.length;d++)c[d].handler!=b&&g.push(c[d]);c.length!=g.length&&(this._events[a]=g,this.oDbg.log("unregistered handler for event '"+a+"'",2))}};d.prototype.registerIQGet=function(a,b,c){this.registerHandler("iq",a,b,"get",
c)};d.prototype.registerIQSet=function(a,b,c){this.registerHandler("iq",a,b,"set",c)};d.prototype.resume=function(){try{var a=q.read(this._cookie_prefix+"JSJaC_State").getValue();this.oDbg.log("read cookie: "+a,2);q.read(this._cookie_prefix+"JSJaC_State").erase();return this.resumeFromData(G.parse(a))}catch(b){}return!1};d.prototype.resumeFromData=function(a){try{this._setStatus("resuming");for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);if(this._keys){this._keys2=new r;var c=this._keys2._getSuspendVars();
for(a=0;a<c.length;a++)this._keys2[c[a]]=this._keys[c[a]];this._keys=this._keys2}this._connected&&(this._handleEvent("onresume"),setTimeout(l.bind(this._resume,this),this.getPollInterval()),this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL),this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL));return!0===this._connected}catch(g){return g.message?this.oDbg.log("Resume failed: "+g.message,1):this.oDbg.log("Resume failed: "+g,1),!1}};d.prototype.send=
function(a,b,c){if(!a||!a.pType)return this.oDbg.log("no packet: "+a,1),!1;if(!this.connected())return!1;b&&(a.getID()||a.setID("JSJaCID_"+this._ID++),this._registerPID(a.getID(),b,c));this._pQueue=this._pQueue.concat(a.xml());this._handleEvent(a.pType()+"_out",a);this._handleEvent("packet_out",a);return!0};d.prototype.sendIQ=function(a,b,c){if(!a||"iq"!=a.pType())return!1;b=b||{};var g=b.error_handler||l.bind(function(a){this.oDbg.log(a.xml(),1)},this),d=b.result_handler||l.bind(function(a){this.oDbg.log(a.xml(),
2)},this);return this.send(a,function(a,b){switch(a.getType()){case "error":g(a);break;case "result":d(a,b)}},c)};d.prototype.setPollInterval=function(a){a&&!isNaN(a)&&(this._timerval=a);return this._timerval};d.prototype.status=function(){return this._status};d.prototype.suspend=function(){var a=this.suspendToData();try{var b=new q(this._cookie_prefix+"JSJaC_State",G.toString(a));this.oDbg.log("writing cookie: "+b.getValue()+"\n(length:"+b.getValue().length+")",2);b.write();var c=q.get(this._cookie_prefix+
"JSJaC_State");return b.getValue()!=c?(this.oDbg.log("Suspend failed writing cookie.\nread: "+c,1),b.erase(),!1):!0}catch(g){this.oDbg.log("Failed creating cookie '"+this._cookie_prefix+"JSJaC_State': "+g.message,1)}return!1};d.prototype.suspendToData=function(){clearTimeout(this._timeout);clearInterval(this._interval);clearInterval(this._inQto);this._suspend();for(var a="_connected _keys _ID _xmllang _inQ _pQueue _regIDs _errcnt _inactivity domain username resource jid fulljid _sid _httpbase _timerval _is_polling".split(" "),
a=a.concat(this._getSuspendVars()),b={},c=0;c<a.length;c++)if(this[a[c]]){var g={};if(this[a[c]]._getSuspendVars)for(var d=this[a[c]]._getSuspendVars(),e=0;e<d.length;e++)g[d[e]]=this[a[c]][d[e]];else g=this[a[c]];b[a[c]]=g}this._connected=!1;this._setStatus("suspending");return b};d.prototype._abort=function(){clearTimeout(this._timeout);clearInterval(this._inQto);clearInterval(this._interval);this._connected=!1;this._setStatus("aborted");this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect");
this._handleEvent("onerror",n("500","cancel","service-unavailable"))};d.prototype._checkInQ=function(){for(var a=0;a<this._inQ.length&&10>a;a++){var b=this._inQ[0];this._inQ=this._inQ.slice(1,this._inQ.length);b=m.wrapNode(b);if(!b)break;this._handleEvent("packet_in",b);b.pType&&!this._handlePID(b)&&(this._handleEvent(b.pType()+"_in",b),this._handleEvent(b.pType(),b))}};d.prototype._checkQueue=function(){0<this._pQueue.length&&this._process();return!0};d.prototype._doAuth=function(){this.has_sasl&&
"nonsasl"==this.authtype&&this.oDbg.log("Warning: SASL present but not used",1);return this._doSASLAuth()||this._doLegacyAuth()?!0:(this.oDbg.log("Auth failed for authtype "+this.authtype,1),this.disconnect(),!1)};d.prototype._doInBandReg=function(){if("saslanon"!=this.authtype&&"anonymous"!=this.authtype){var a=new z;a.setType("set");a.setID("reg1");a.appendNode("query",{xmlns:O},[["username",this.username],["password",this.pass]]);this.send(a,this._doInBandRegDone)}};d.prototype._doInBandRegDone=
function(a){a&&"error"==a.getType()?(this.oDbg.log("registration failed for "+this.username,0),this._handleEvent("onerror",a.getChild("error"))):(this.oDbg.log(this.username+" registered succesfully",0),this._doAuth())};d.prototype._doLegacyAuth=function(){if("nonsasl"!=this.authtype&&"anonymous"!=this.authtype)return!1;var a=new z;a.setIQ(null,"get","auth1");a.appendNode("query",{xmlns:H},[["username",this.username]]);this.send(a,this._doLegacyAuth2);return!0};d.prototype._doLegacyAuth2=function(a){if(a&&
"result"==a.getType()){a=null!==a.getChild("digest");var b=new z;b.setIQ(null,"set","auth2");var c=b.appendNode("query",{xmlns:H},[["username",this.username],["resource",this.resource]]);if(a)c.appendChild(b.buildNode("digest",{xmlns:H},A.hex_sha1(this.streamid+this.pass)));else if(this._allow_plain)c.appendChild(b.buildNode("password",{xmlns:H},this.pass));else{this.oDbg.log("no valid login mechanism found",1);this.disconnect();return}this.send(b,this._doLegacyAuthDone)}else a&&"error"==a.getType()&&
this._handleEvent("onerror",a.getChild("error")),this.disconnect()};d.prototype._doLegacyAuthDone=function(a){"result"!=a.getType()?("error"==a.getType()&&this._handleEvent("onerror",a.getChild("error")),this.disconnect()):this._handleEvent("onconnect")};d.prototype._doSASLAuth=function(){if("nonsasl"==this.authtype||"anonymous"==this.authtype)return!1;if("saslanon"==this.authtype){if(this.mechs.ANONYMOUS)return this.oDbg.log("SASL using mechanism 'ANONYMOUS'",2),this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'ANONYMOUS'/\x3e",
this._doSASLAuthDone);this.oDbg.log("SASL ANONYMOUS requested but not supported",1)}else if("x-facebook-platform"==this.authtype){if(this.mechs["X-FACEBOOK-PLATFORM"])return this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'X-FACEBOOK-PLATFORM' /\x3e",this._doFacebookAuth);this.oDbg.log("X-FACEBOOK-PLATFORM requested but not supported",1)}else{if(this.mechs["DIGEST-MD5"])return this.oDbg.log("SASL using mechanism 'DIGEST-MD5'",2),this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'DIGEST-MD5'/\x3e",
this._doSASLAuthDigestMd5S1);if(this._allow_plain&&this.mechs.PLAIN){this.oDbg.log("SASL using mechanism 'PLAIN'",2);var a=this.username+"@"+this.domain+String.fromCharCode(0)+this.username+String.fromCharCode(0)+this.pass;this.oDbg.log("authenticating with '"+a+"'",2);a=A.b64encode(a);return this._sendRaw("\x3cauth xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl' mechanism\x3d'PLAIN'\x3e"+a+"\x3c/auth\x3e",this._doSASLAuthDone)}this.oDbg.log("No SASL mechanism applied",1);this.authtype="nonsasl"}return!1};
d.prototype._doSASLAuthDigestMd5S1=function(a){if("challenge"!=a.nodeName)this.oDbg.log("challenge missing",1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect();else if(a=A.b64decode(a.firstChild.nodeValue),this.oDbg.log("got challenge: "+a,2),this._nonce=a.substring(a.indexOf("nonce\x3d")+7),this._nonce=this._nonce.substring(0,this._nonce.indexOf('"')),this.oDbg.log("nonce: "+this._nonce,2),""===this._nonce||-1!=this._nonce.indexOf('"'))this.oDbg.log("nonce not valid, aborting",
1),this.disconnect();else{this._digest_uri="xmpp/";this._digest_uri+=this.domain;this._cnonce=cnonce(14);this._nc="00000001";a=str_md5(this.username+":"+this.domain+":"+this.pass)+":"+this._nonce+":"+this._cnonce;var b="AUTHENTICATE:"+this._digest_uri;a=hex_md5(hex_md5(a)+":"+this._nonce+":"+this._nc+":"+this._cnonce+":auth:"+hex_md5(b));a='username\x3d"'+this.username+'",realm\x3d"'+this.domain+'",nonce\x3d"'+this._nonce+'",cnonce\x3d"'+this._cnonce+'",nc\x3d"'+this._nc+'",qop\x3dauth,digest-uri\x3d"'+
this._digest_uri+'",response\x3d"'+a+'",charset\x3d"utf-8"';this.oDbg.log("response: "+a,2);this._sendRaw("\x3cresponse xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl'\x3e"+binb2b64(str2binb(a))+"\x3c/response\x3e",this._doSASLAuthDigestMd5S2)}};d.prototype._doSASLAuthDigestMd5S2=function(a){if("failure"==a.nodeName)a.xml?this.oDbg.log("auth error: "+a.xml,1):this.oDbg.log("auth error",1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect();else{var b=A.b64decode(a.firstChild.nodeValue);
this.oDbg.log("response: "+b,2);b=b.substring(b.indexOf("rspauth\x3d")+8);this.oDbg.log("rspauth: "+b,2);var c=str_md5(this.username+":"+this.domain+":"+this.pass)+":"+this._nonce+":"+this._cnonce,g=":"+this._digest_uri,c=hex_md5(hex_md5(c)+":"+this._nonce+":"+this._nc+":"+this._cnonce+":auth:"+hex_md5(g));this.oDbg.log("rsptest: "+c,2);c!=b?(this.oDbg.log("SASL Digest-MD5: server repsonse with wrong rspauth",1),this.disconnect()):"success"==a.nodeName?this._reInitStream(l.bind(this._doStreamBind,
this)):this._sendRaw("\x3cresponse xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl'/\x3e",this._doSASLAuthDone)}};d.prototype._doSASLAuthDone=function(a){"success"!=a.nodeName?(this.oDbg.log("auth failed",1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect()):this._reInitStream(l.bind(this._doStreamBind,this))};d.prototype._doFacebookAuth=function(a){if("challenge"!=a.nodeName)this.oDbg.log("challenge missing",1);else{a=A.b64decode(a.firstChild.nodeValue);this.oDbg.log("got challenge: "+
a,2);var b=a.split("\x26");a=[];for(var c=0;c<b.length;c++){var g=b[c].split("\x3d");a[g[0]]=g[1]}if(""!=a.nonce)return b=this._facebookApp.getSession(),a={api_key:this._facebookApp.getApiKey(),call_id:(new Date).getTime(),method:a.method,nonce:a.nonce,session_key:b.session_key,v:"1.0"},a.sig="api_key\x3d"+a.api_key+"call_id\x3d"+a.call_id+"method\x3d"+a.method+"nonce\x3d"+a.nonce+"session_key\x3d"+a.session_key+"v\x3d"+a.v,a.sig=hex_md5(a.sig+this._facebookApp.getApiSecret()),a="api_key\x3d"+a.api_key+
"\x26call_id\x3d"+a.call_id+"\x26method\x3d"+a.method+"\x26nonce\x3d"+a.nonce+"\x26session_key\x3d"+a.session_key+"\x26v\x3d"+a.v+"\x26sig\x3d"+a.sig,a=A.b64encode(a),this._sendRaw("\x3cresponse xmlns\x3d'urn:ietf:params:xml:ns:xmpp-sasl'\x3e"+a+"\x3c/response\x3e",this._doFacebookAuthDone);this.oDbg.log("nonce missing",1)}this._handleEvent("onerror",n("401","auth","not-authorized"));this.disconnect()};d.prototype._doFacebookAuthDone=function(a){"success"!=a.nodeName?(this.oDbg.log("auth failed",
1),this._handleEvent("onerror",n("401","auth","not-authorized")),this.disconnect()):this._reInitStream(l.bind(this._doStreamBind,this))};d.prototype._doStreamBind=function(){var a=new z;a.setIQ(null,"set","bind_1");a.appendNode("bind",{xmlns:I},[["resource",this.resource]]);this.oDbg.log(a.xml());this.send(a,this._doXMPPSess)};d.prototype._doXMPPSess=function(a){"result"!=a.getType()||"error"==a.getType()?(this.disconnect(),"error"==a.getType()&&this._handleEvent("onerror",a.getChild("error"))):(this.fulljid=
a.getChildVal("jid"),this.jid=this.fulljid.substring(0,this.fulljid.lastIndexOf("/")),this._handleEvent("onconnect"),a=new z,a.setIQ(null,"set","sess_1"),a.appendNode("session",{xmlns:P},[]),this.oDbg.log(a.xml()),this.send(a,this._doXMPPSessDone))};d.prototype._doXMPPSessDone=function(a){if("result"!=a.getType()||"error"==a.getType())this.disconnect(),"error"==a.getType()&&this._handleEvent("onerror",a.getChild("error"))};d.prototype._handleEvent=function(a,b){a=a.toLowerCase();this.oDbg.log("incoming event '"+
a+"'",3);if(this._events[a]){this.oDbg.log("handling event '"+a+"'",2);for(var c=0;c<this._events[a].length;c++){var g=this._events[a][c];if("function"==typeof g.handler)try{if(b){if(b.pType){if(!b.getNode().hasChildNodes()&&"*"!=g.childName||b.getNode().hasChildNodes()&&!b.getChild(g.childName,g.childNS))continue;if("*"!=g.type&&b.getType()!=g.type)continue;this.oDbg.log(g.childName+"/"+g.childNS+"/"+g.type+" \x3d\x3e match for handler "+g.handler,3)}if(g.handler(b))break}else if(g.handler())break}catch(d){d.fileName&&
d.lineNumber?this.oDbg.log(g.handler+"\n\x3e\x3e\x3e"+d.name+": "+d.message+" in "+d.fileName+" line "+d.lineNumber,1):this.oDbg.log(g.handler+"\n\x3e\x3e\x3e"+d.name+": "+d.message,1)}}}};d.prototype._handlePID=function(a){if(!a.getID())return!1;for(var b in this._regIDs)if(this._regIDs.hasOwnProperty(b)&&this._regIDs[b]&&b==a.getID()){var c=a.getID();this.oDbg.log("handling "+c,3);if(!1===this._regIDs[b].cb.call(this,a,this._regIDs[b].arg))break;else return this._unregisterPID(c),!0}return!1};d.prototype._handleResponse=
function(a){if(a=this._parseResponse(a))for(var b=0;b<a.childNodes.length;b++)if(this._sendRawCallbacks.length){var c=this._sendRawCallbacks[0];this._sendRawCallbacks=this._sendRawCallbacks.slice(1,this._sendRawCallbacks.length);c.fn.call(this,a.childNodes.item(b),c.arg)}else this._inQ=this._inQ.concat(a.childNodes.item(b))};d.prototype._parseStreamFeatures=function(a){if(!a)return this.oDbg.log("nothing to parse ... aborting",1),!1;var b;if(a.getElementsByTagNameNS)b=a.getElementsByTagNameNS(E,"error").item(0);
else for(var c=a.getElementsByTagName("error"),g=0;g<c.length;g++)if(c.item(g).namespaceURI==E||c.item(g).getAttribute("xmlns")==E){b=c.item(g);break}if(b)return this._setStatus("internal_server_error"),clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",n("503","cancel","session-terminate")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),!1;if(g=a.getElementsByTagName("amazon")[0]){if(b=g.getElementsByTagName("serverIP")[0])this._serverIP=
b.firstChild.nodeValue;if(g=g.getElementsByTagName("serverName")[0])this._serverName=g.firstChild.nodeValue}this.mechs={};a=a.getElementsByTagName("mechanisms");if(!a.length)return!1;this.has_sasl=!1;for(g=0;g<a.length;g++)if(a.item(g).getAttribute("xmlns")==Q){this.has_sasl=!0;a=a.item(g).getElementsByTagName("mechanism");for(g=0;g<a.length;g++)this.mechs[a.item(g).firstChild.nodeValue]=!0;break}this.has_sasl?this.oDbg.log("SASL detected",2):this.oDbg.log("No support for SASL detected",2);return!0};
d.prototype._process=function(a){if(this.connected()){this.setPollInterval(a);this._timeout&&clearTimeout(this._timeout);var b=this._getFreeSlot();if(!(0>b))if("undefined"!=typeof this._req[b]&&"undefined"!=typeof this._req[b].r&&4!=this._req[b].r.readyState)this.oDbg.log("Slot "+b+" is not ready");else if(!this.isPolling()&&0===this._pQueue.length&&this._req[(b+1)%2]&&4!=this._req[(b+1)%2].r.readyState)this.oDbg.log("all slots busy, standby ...",2);else{this.isPolling()||this.oDbg.log("Found working slot at "+
b,2);this._req[b]=this._setupRequest(!0);this._req[b].r.onreadystatechange=l.bind(function(){this.connected()&&4==this._req[b].r.readyState&&(this._setStatus("processing"),this.oDbg.log("async recv: "+this._req[b].r.responseText,4),this.ensureResponseXML(this._req[b].r),this._handleResponse(this._req[b]),this._pQueue.length?this._timeout=setTimeout(l.bind(this._process,this),100):(this.oDbg.log("scheduling next poll in "+this.getPollInterval()+" msec",4),this._timeout=setTimeout(l.bind(this._process,
this),this.getPollInterval())))},this);try{this._req[b].r.onerror=l.bind(function(){this.connected()&&(this._errcnt++,this.oDbg.log("XmlHttpRequest error ("+this._errcnt+")",1),this._errcnt>k.JSJAC_ERR_COUNT?this._abort():(this._setStatus("onerror_fallback"),setTimeout(l.bind(this._resume,this),k.JSJAC_RETRYDELAY)))},this)}catch(c){}a=this._getRequestString();"undefined"!=typeof this._rid&&(this._req[b].rid=this._rid);this.oDbg.log("sending: "+a,4);this._req[b].r.send(a)}}else this.oDbg.log("Connection lost ...",
1),this._interval&&clearInterval(this._interval)};d.prototype._registerPID=function(a,b,c){if(!a||!b)return!1;this._regIDs[a]={};this._regIDs[a].cb=b;c&&(this._regIDs[a].arg=c);this.oDbg.log("registered "+a,3);return!0};d.prototype._prepSendEmpty=function(a,b){return function(){b._sendEmpty(l.bind(a,b))}};d.prototype._sendEmpty=function(a){var b=this._getFreeSlot();this._req[b]=this._setupRequest(!0);this._req[b].r.onreadystatechange=l.bind(function(){4==this._req[b].r.readyState&&(this.oDbg.log("async recv: "+
this._req[b].r.responseText,4),this.ensureResponseXML(this._req[b].r),a(this._req[b].r))},this);"undefined"!=typeof this._req[b].r.onerror&&(this._req[b].r.onerror=l.bind(function(a){this.oDbg.log("XmlHttpRequest error",1)},this));var c=this._getRequestString();this.oDbg.log("sending: "+c,4);this._req[b].r.send(c)};d.prototype._sendRaw=function(a,b,c){b&&this._sendRawCallbacks.push({fn:b,arg:c});this._pQueue.push(a);this._process();return!0};d.prototype._setStatus=function(a){a&&""!==a&&a!=this._status&&
(this._status=a,this._handleEvent("onstatuschanged",a),this._handleEvent("status_changed",a))};d.prototype._unregisterPID=function(a){if(!this._regIDs[a])return!1;this._regIDs[a]=null;this.oDbg.log("unregistered "+a,3);return!0};var H="jabber:iq:auth",O="jabber:iq:register",E="http://etherx.jabber.org/streams",N="jabber:client",L="urn:ietf:params:xml:ns:xmpp-stanzas",Q="urn:ietf:params:xml:ns:xmpp-sasl",P="urn:ietf:params:xml:ns:xmpp-session",I="urn:ietf:params:xml:ns:xmpp-bind";h("400","modify",
"bad-request");h("409","cancel","conflict");h("501","cancel","feature-not-implemented");h("403","auth","forbidden");h("302","modify","gone");h("500","wait","internal-server-error");h("404","cancel","item-not-found");h("400","modify","jid-malformed");h("406","modify","not-acceptable");h("405","cancel","not-allowed");h("401","auth","not-authorized");h("402","auth","payment-required");h("404","wait","recipient-unavailable");h("302","modify","redirect");h("407","auth","registration-required");h("404",
"cancel","remote-server-not-found");h("504","wait","remote-server-timeout");h("500","wait","resource-constraint");h("503","cancel","service-unavailable");h("407","auth","subscription-required");h("400","wait","unexpected-request");q.read=function(a){for(var b=a+"\x3d",c=document.cookie.split(";"),g=0;g<c.length;g++){for(var d=c[g];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(b))return new q(a,q._unescape(d.substring(b.length,d.length)))}throw new M("Cookie not found");};q.get=function(a){return q.read(a).getValue()};
q.remove=function(a){q.read(a).erase()};q._escape=function(a){return a.replace(/;/g,"%3AB")};q._unescape=function(a){return a.replace(/%3AB/g,";")};F.prototype.Login=function(a,b){var c=this;FB.init({appId:this._appID,status:!0});FB.login(function(d){d.session&&d.perms&&(c._perms=d.perms,c._session=d.session,a.connect(b))},{perms:"xmpp_login"})};F.prototype.getAppID=function(){return this._appID};F.prototype.getApiKey=function(){return this._apiKey};F.prototype.getApiSecret=function(){return this._apiSecret};
F.prototype.getSession=function(){return this._session};u.prototype=new d;u.prototype.inherit=function(a){if(a.jid){var b=new v(a.jid);this.domain=b.getDomain();this.username=b.getNode();this.resource=b.getResource()}else this.domain=a.domain||"localhost",this.username=a.username,this.resource=a.resource;this._sid=a.sid;this._rid=a.rid;this._min_polling=a.polling;this._inactivity=a.inactivity;this._setHold(a.requests-1);this.setPollInterval(this._timerval);a.wait&&(this._wait=a.wait);this._connected=
!0;this._handleEvent("onconnect");this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL);this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL);this._timeout=setTimeout(l.bind(this._process,this),this.getPollInterval())};u.prototype.setPollInterval=function(a){a&&!isNaN(a)&&(this.isPolling()?this._timerval=this._min_polling&&a<1E3*this._min_polling?1E3*this._min_polling:this._inactivity&&a>1E3*this._inactivity?1E3*this._inactivity:a:this._timerval=
100);return this._timerval};u.prototype.isPolling=function(){return 0===this._hold};u.prototype._getFreeSlot=function(){for(var a=0;a<this._hold+1;a++)if("undefined"==typeof this._req[a]||"undefined"==typeof this._req[a].r||4==this._req[a].r.readyState)return a;return-1};u.prototype._getHold=function(){return this._hold};u.prototype._getRequestString=function(a,b){a=a||"";var c;if(this._rid<=this._last_rid&&"undefined"!=typeof this._last_requests[this._rid])c=this._last_requests[this._rid].xml;else{for(var d=
"";this._pQueue.length;)d+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length);c="\x3cbody rid\x3d'"+this._rid+"' sid\x3d'"+this._sid+"' xmlns\x3d'http://jabber.org/protocol/httpbind' ";k.JSJAC_HAVEKEYS&&(c+="key\x3d'"+this._keys.getKey()+"' ",this._keys.lastKey()&&(this._keys=new r(A.hex_sha1,this.oDbg),c+="newkey\x3d'"+this._keys.getKey()+"' "));b?c+="type\x3d'terminate'":this._reinit&&(k.JSJACHBC_USE_BOSH_VER&&(c+="xml:lang\x3d'"+this._xmllang+"' xmpp:restart\x3d'true' xmlns:xmpp\x3d'urn:xmpp:xbosh' to\x3d'"+
this.domain+"'"),this._reinit=!1);c=""!=d||""!=a?c+("\x3e"+a+d+"\x3c/body\x3e"):c+"\x3e \x3c/body\x3e";this._last_requests[this._rid]={};this._last_requests[this._rid].xml=c;this._last_rid=this._rid;for(var e in this._last_requests)this._last_requests.hasOwnProperty(e)&&e<this._rid-this._hold&&delete this._last_requests[e]}return c};u.prototype._getInitialRequestString=function(){var a="\x3cbody content\x3d'text/xml; charset\x3dutf-8' hold\x3d'"+this._hold+"' xmlns\x3d'http://jabber.org/protocol/httpbind' to\x3d'"+
this.authhost+"' wait\x3d'"+this._wait+"' rid\x3d'"+this._rid+"'";this.host&&this.port&&(a+=" route\x3d'xmpp:"+this.host+":"+this.port+"'");this.secure&&(a+=" secure\x3d'"+this.secure+"'");if(k.JSJAC_HAVEKEYS){this._keys=new r(A.hex_sha1,this.oDbg);var b=this._keys.getKey(),a=a+(" newkey\x3d'"+b+"'")}a+=" xml:lang\x3d'"+this._xmllang+"'";k.JSJACHBC_USE_BOSH_VER&&(a+=" ver\x3d'"+k.JSJACHBC_BOSH_VERSION+"'",a+=" xmlns:xmpp\x3d'urn:xmpp:xbosh'","sasl"==this.authtype||"saslanon"==this.authtype||"x-facebook-platform"==
this.authtype)&&(a+=" xmpp:version\x3d'1.0'");return a+"/\x3e"};u.prototype._getStreamID=function(a){this.oDbg.log(a.responseText,4);a.responseXML&&a.responseXML.documentElement?(a=a.responseXML.documentElement,"terminate"==a.getAttribute("type")?this._handleEvent("onerror",n("503","cancel","service-unavailable")):(a.getAttribute("authid")&&(this.streamid=a.getAttribute("authid"),this.oDbg.log("got streamid: "+this.streamid,2)),this._parseStreamFeatures(a)?(this._timeout=setTimeout(l.bind(this._process,
this),this.getPollInterval()),this.register?this._doInBandReg():this._doAuth()):this._sendEmpty(l.bind(this._getStreamID,this)))):this._handleEvent("onerror",n("503","cancel","service-unavailable"))};u.prototype._getSuspendVars=function(){return"host port secure _rid _last_rid _wait _min_polling _inactivity _hold _last_requests _pause".split(" ")};u.prototype._handleInitialResponse=function(a){try{this.oDbg.log(a.getAllResponseHeaders(),4),this.oDbg.log(a.responseText,4)}catch(c){this.oDbg.log("No response",
4)}if(200==a.status&&a.responseXML){var b=a.responseXML.documentElement;b&&"body"==b.tagName&&"http://jabber.org/protocol/httpbind"==b.namespaceURI?"terminate"==b.getAttribute("type")?(this.oDbg.log("invalid response:\n"+a.responseText,1),clearTimeout(this._timeout),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._handleEvent("onerror",n("503","cancel","service-unavailable"))):(this._sid=b.getAttribute("sid"),this.oDbg.log("got sid: "+this._sid,2),b.getAttribute("polling")&&
(this._min_polling=b.getAttribute("polling")),b.getAttribute("inactivity")&&(this._inactivity=b.getAttribute("inactivity")),b.getAttribute("requests")&&this._setHold(b.getAttribute("requests")-1),this.oDbg.log("set hold to "+this._getHold(),2),b.getAttribute("ver")&&(this._bosh_version=b.getAttribute("ver")),b.getAttribute("maxpause")&&(this._pause=Number.min(b.getAttribute("maxpause"),k.JSJACHBC_MAXPAUSE)),this.setPollInterval(this._timerval),this._connected=!0,this._inQto=setInterval(l.bind(this._checkInQ,
this),k.JSJAC_CHECKINQUEUEINTERVAL),this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL),this._getStreamID(a)):(this.oDbg.log("no body element or incorrect body in initial response",1),this._handleEvent("onerror",n("500","wait","internal-service-error")))}else this.oDbg.log("initial response broken (status: "+a.status+")",1),this._handleEvent("onerror",n("503","cancel","service-unavailable"))};u.prototype._parseResponse=function(a){if(!this.connected()||!a)return null;
var b=a.r;try{if(404==b.status||403==b.status)return this._abort(),null;if(200!=b.status||!b.responseXML){this._errcnt++;var c="invalid response ("+b.status+"):\n"+b.getAllResponseHeaders()+"\n"+b.responseText;b.responseXML||(c+="\nResponse failed to parse!");this.oDbg.log(c,1);if(this._errcnt>k.JSJAC_ERR_COUNT)return this._abort(),null;this.connected()&&(this.oDbg.log("repeating ("+this._errcnt+")",1),this._setStatus("proto_error_fallback"),setTimeout(l.bind(this._resume,this),this.getPollInterval()));
return null}}catch(d){return this.oDbg.log("XMLHttpRequest error: status not available",1),this._errcnt++,this._errcnt>k.JSJAC_ERR_COUNT?this._abort():this.connected()&&(this.oDbg.log("repeating ("+this._errcnt+")",1),this._setStatus("proto_error_fallback"),setTimeout(l.bind(this._resume,this),this.getPollInterval())),null}c=b.responseXML.documentElement;if(!c||"body"!=c.tagName||"http://jabber.org/protocol/httpbind"!=c.namespaceURI)return this.oDbg.log("invalid response:\n"+b.responseText,1),clearTimeout(this._timeout),
clearInterval(this._interval),clearInterval(this._inQto),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._setStatus("internal_server_error"),this._handleEvent("onerror",n("500","wait","internal-server-error")),null;if("undefined"!=typeof a.rid&&this._last_requests[a.rid]){if(this._last_requests[a.rid].handled)return this.oDbg.log("already handled "+a.rid,2),null;this._last_requests[a.rid].handled=!0}if("terminate"==c.getAttribute("type")){a=c.getAttribute("condition");
if("item-not-found"!=a){this.oDbg.log("session terminated:\n"+b.responseText,1);clearTimeout(this._timeout);clearInterval(this._interval);clearInterval(this._inQto);try{q.read(this._cookie_prefix+"JSJaC_State").erase()}catch(d){}this._connected=!1;a=c.getAttribute("condition");"remote-stream-error"==a&&0<c.getElementsByTagName("conflict").length&&this._setStatus("session-terminate-conflict");null==a&&(a="session-terminate");this._handleEvent("onerror",n("503","cancel",a,c.children));this.oDbg.log("Aborting remaining connections",
4);for(b=0;b<this._hold+1;b++)try{this._req[b].r.abort()}catch(d){this.oDbg.log(d,1)}this.oDbg.log("parseResponse done with terminating",3);this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect")}else this._errcnt++,this._errcnt>k.JSJAC_ERR_COUNT&&this._abort();return null}this._errcnt=0;return b.responseXML.documentElement};u.prototype._reInitStream=function(a){this._reinit=!0;this._sendEmpty(this._prepReInitStreamWait(a))};u.prototype._prepReInitStreamWait=function(a){return l.bind(function(b){this._reInitStreamWait(b,
a)},this)};u.prototype._reInitStreamWait=function(a,b){this.oDbg.log("checking for stream features");if(a.responseXML&&a.responseXML.documentElement){a=a.responseXML.documentElement;var c,d;this.oDbg.log(a);if(a.getElementsByTagNameNS)this.oDbg.log("checking with namespace"),(c=a.getElementsByTagNameNS(E,"features").item(0))&&(d=c.getElementsByTagNameNS(I,"bind").item(0));else{a=a.getElementsByTagName("stream:features");var e,f;e=0;for(f=a.length;e<f;e++)if(a.item(e).namespaceURI==E||a.item(e).getAttribute("xmlns")==
E){c=a.item(e);break}if(c)for(d=c.getElementsByTagName("bind"),e=0,f=d.length;e<f;e++)if(d.item(e).namespaceURI==I||d.item(e).getAttribute("xmlns")==I){d=d.item(e);break}}this.oDbg.log(c);this.oDbg.log(d);c?d?b():(this.oDbg.log("no bind feature - giving up",1),this._handleEvent("onerror",n("503","cancel","service-unavailable")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect")):this._sendEmpty(this._prepReInitStreamWait(b))}else this._handleEvent("onerror",n("503",
"cancel","service-unavailable"))};u.prototype._resume=function(){0==this._pause&&this._rid>=this._last_rid&&(this._rid=this._last_rid-1);this._process()};u.prototype._setHold=function(a){!a||isNaN(a)||0>a?a=0:a>k.JSJACHBC_MAX_HOLD&&(a=k.JSJACHBC_MAX_HOLD);return this._hold=a};u.prototype._setupRequest=function(a){var b={},c=e.create();try{c.open("POST",this._httpbase,a),c.setRequestHeader("Content-Type","text/xml; charset\x3dutf-8")}catch(d){this.oDbg.log(d,1)}b.r=c;this._rid++;b.rid=this._rid;return b};
u.prototype._suspend=function(){if(0!=this._pause){var a=this._getFreeSlot();this._req[a]=this._setupRequest(!1);var b="\x3cbody pause\x3d'"+this._pause+"' xmlns\x3d'http://jabber.org/protocol/httpbind' sid\x3d'"+this._sid+"' rid\x3d'"+this._rid+"'";k.JSJAC_HAVEKEYS&&(b+=" key\x3d'"+this._keys.getKey()+"'",this._keys.lastKey()&&(this._keys=new r(A.hex_sha1,this.oDbg),b+=" newkey\x3d'"+this._keys.getKey()+"'"));for(b+="\x3e";this._pQueue.length;)b+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,
this._pQueue.length);b+="\x3c/body\x3e";this.oDbg.log("Disconnecting: "+b,4);this._req[a].r.send(b)}};w.prototype=new d;w.prototype.isPolling=function(){return!0};w.prototype._getFreeSlot=function(){return"undefined"==typeof this._req[0]||"undefined"==typeof this._req[0].r||4==this._req[0].r.readyState?0:-1};w.prototype._getInitialRequestString=function(){var a="0";if(k.JSJAC_HAVEKEYS){this._keys=new r(b64_sha1,this.oDbg);var b=this._keys.getKey(),a=a+(";"+b)}b=this.domain;this.authhost&&(b=this.authhost);
a+=",\x3cstream:stream to\x3d'"+b+"' xmlns\x3d'jabber:client' xmlns:stream\x3d'http://etherx.jabber.org/streams'";if("sasl"==this.authtype||"saslanon"==this.authtype)a+=" version\x3d'1.0'";return a+"\x3e"};w.prototype._getRequestString=function(a,b){var c=this._sid;k.JSJAC_HAVEKEYS&&(c+=";"+this._keys.getKey(),this._keys.lastKey()&&(this._keys=new r(b64_sha1,this.oDbg),c+=";"+this._keys.getKey()));c+=",";for(a&&(c+=a);this._pQueue.length;)c+=this._pQueue[0],this._pQueue=this._pQueue.slice(1,this._pQueue.length);
b&&(c+="\x3c/stream:stream\x3e");return c};w.prototype._getStreamID=function(){if(""==this._req[0].r.responseText)this.oDbg.log("waiting for stream id",2),this._timeout=setTimeout(l.bind(this._sendEmpty,this),1E3);else{this.oDbg.log(this._req[0].r.responseText,4);this._req[0].r.responseText.match(/id=[\'\"]([^\'\"]+)[\'\"]/)&&(this.streamid=RegExp.$1);this.oDbg.log("got streamid: "+this.streamid,2);var a;try{var b=this._req[0].r.responseText;b.match(/<\/stream:stream>\s*$/)||(b+="\x3c/stream:stream\x3e");
a=f.create("doc");a.loadXML(b);if(!this._parseStreamFeatures(a)){this.authtype="nonsasl";return}}catch(c){this.oDbg.log("loadXML: "+c.toString(),1)}this._connected=!0;this.register?this._doInBandReg():this._doAuth();this._process(this._timerval)}};w.prototype._getSuspendVars=function(){return[]};w.prototype._handleInitialResponse=function(){this.oDbg.log(this._req[0].r.getAllResponseHeaders(),4);for(var a=this._req[0].r.getResponseHeader("Set-Cookie"),a=a.split(";"),b=0;b<a.length;b++){var c=a[b].split("\x3d");
"ID"==c[0]&&(this._sid=c[1])}this.oDbg.log("got sid: "+this._sid,2);this._connected=!0;this._interval=setInterval(l.bind(this._checkQueue,this),k.JSJAC_CHECKQUEUEINTERVAL);this._inQto=setInterval(l.bind(this._checkInQ,this),k.JSJAC_CHECKINQUEUEINTERVAL);this._getStreamID()};w.prototype._parseResponse=function(a){a=a.r;if(!this.connected())return null;if(200!=a.status)return this.oDbg.log("invalid response ("+a.status+"):"+a.responseText+"\n"+a.getAllResponseHeaders(),1),this._setStatus("internal_server_error"),
clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect"),this._handleEvent("onerror",n("503","cancel","service-unavailable")),null;this.oDbg.log(a.getAllResponseHeaders(),4);var b,c=a.getResponseHeader("Set-Cookie");if(null==c)b="-1:0";else for(var c=c.split(";"),d=0;d<c.length;d++){var e=c[d].split("\x3d");"ID"==e[0]&&(b=e[1])}if("undefined"!=typeof b&&-1!=b.indexOf(":0")){switch(b.substring(0,
b.indexOf(":0"))){case "0":this.oDbg.log("invalid response:"+a.responseText,1);break;case "-1":this.oDbg.log("Internal Server Error",1);break;case "-2":this.oDbg.log("Bad Request",1);break;case "-3":this.oDbg.log("Key Sequence Error",1)}this._setStatus("internal_server_error");clearTimeout(this._timeout);clearInterval(this._interval);clearInterval(this._inQto);this._handleEvent("onerror",n("500","wait","internal-server-error"));this._connected=!1;this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect");
return null}if(!a.responseText||""==a.responseText)return null;try{var f=a.responseText.replace(/\<\?xml.+\?\>/,"");f.match(/<stream:stream/)&&(f+="\x3c/stream:stream\x3e");var h=w._parseTree("\x3cbody\x3e"+f+"\x3c/body\x3e");h&&"parsererror"!=h.tagName||(this.oDbg.log("parsererror",1),(h=w._parseTree("\x3cstream:stream xmlns:stream\x3d'http://etherx.jabber.org/streams'\x3e"+a.responseText))&&"parsererror"!=h.tagName?(this.oDbg.log("stream closed",1),0<h.getElementsByTagName("conflict").length&&this._setStatus("session-terminate-conflict"),
clearTimeout(this._timeout),clearInterval(this._interval),clearInterval(this._inQto),this._handleEvent("onerror",n("503","cancel","session-terminate")),this._connected=!1,this.oDbg.log("Disconnected.",1),this._handleEvent("ondisconnect")):this.oDbg.log("parsererror:"+h,1));return h}catch(k){this.oDbg.log("parse error:"+k.message,1)}return null};w.prototype._reInitStream=function(a,b,c){this._sendRaw("\x3cstream:stream xmlns:stream\x3d'http://etherx.jabber.org/streams' xmlns\x3d'jabber:client' to\x3d'"+
a+"' version\x3d'1.0'\x3e",b,c)};w.prototype._resume=function(){this._process(this._timerval)};w.prototype._setupRequest=function(a){var b=e.create();try{b.open("POST",this._httpbase,a),b.overrideMimeType&&b.overrideMimeType("text/plain; charset\x3dutf-8"),b.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}catch(c){this.oDbg.log(c,1)}a={};a.r=b;return a};w.prototype._suspend=function(){};w._parseTree=function(a){try{var b=f.create("body","foo");if("undefined"!=typeof b.loadXML)return b.loadXML(a),
b.documentElement;if(p.DOMParser)return(new DOMParser).parseFromString(a,"text/xml").documentElement}catch(c){}return null};var K="\" \x26'/:\x3c\x3e@".split("");v.prototype.getBareJID=function(){return this.getNode()+"@"+this.getDomain()};v.prototype.getNode=function(){return this._node};v.prototype.getDomain=function(){return this._domain};v.prototype.getResource=function(){return this._resource};v.prototype.setNode=function(a){v._checkNodeName(a);this._node=a||"";return this};v.prototype.setDomain=
function(a){if(!a||""==a)throw new x("domain name missing");v._checkNodeName(a);this._domain=a;return this};v.prototype.setResource=function(a){this._resource=a||"";return this};v.prototype.toString=function(){var a="";this.getNode()&&""!=this.getNode()&&(a=this.getNode()+"@");a+=this.getDomain();this.getResource()&&""!=this.getResource()&&(a+="/"+this.getResource());return a};v.prototype.removeResource=function(){return this.setResource()};v.prototype.clone=function(){return new v(this.toString())};
v.prototype.isEntity=function(a){"string"==typeof a&&(a=new v(a));a.removeResource();return this.clone().removeResource().toString()===a.toString()};v._checkNodeName=function(a){if(a&&""!=a)for(var b=0;b<K.length;b++)if(-1!=a.indexOf(K[b]))throw new x("forbidden char in nodename: "+K[b]);};G.toString=function(a){var b={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},c={array:function(a){var b=["["],d,e,f,h=a.length,k;for(f=0;f<h;f+=1)if(k=a[f],e=c[typeof k])try{k=e(k),
"string"==typeof k&&(d&&(b[b.length]=","),b[b.length]=k,d=!0)}catch(l){}b[b.length]="]";return b.join("")},"boolean":function(a){return String(a)},"null":function(a){return"null"},number:function(a){return isFinite(a)?String(a):"null"},object:function(a){if(a){if(a instanceof Array)return c.array(a);var b=["{"],d,e,f,h;for(f in a)if(a.hasOwnProperty(f)&&(h=a[f],e=c[typeof h]))try{h=e(h),"string"==typeof h&&(d&&(b[b.length]=","),b.push(c.string(f),":",h),d=!0)}catch(k){}b[b.length]="}";return b.join("")}return"null"},
string:function(a){/["\\\x00-\x1f]/.test(a)&&(a=a.replace(/([\x00-\x1f\\"])/g,function(a,c){if(a=b[c])return a;a=c.charCodeAt();return"\\u00"+Math.floor(a/16).toString(16)+(a%16).toString(16)}));return'"'+a+'"'}};switch(typeof a){case "object":return c.object(a);case "array":return c.array(a)}};G.parse=function(a){try{return!/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(a.replace(/"(\\.|[^"\\])*"/g,""))&&eval("("+a+")")}catch(b){return!1}};var J=!0;m.prototype.pType=function(){return this.name};m.prototype.getDoc=
function(){return this.doc};m.prototype.getNode=function(){return this.getDoc()&&this.getDoc().documentElement?this.getDoc().documentElement:null};m.prototype.setTo=function(a){a&&""!=a?"string"==typeof a?this.getNode().setAttribute("to",a):this.getNode().setAttribute("to",a.toString()):this.getNode().removeAttribute("to");return this};m.prototype.setFrom=function(a){a&&""!=a?"string"==typeof a?this.getNode().setAttribute("from",a):this.getNode().setAttribute("from",a.toString()):this.getNode().removeAttribute("from");
return this};m.prototype.setID=function(a){a&&""!=a?this.getNode().setAttribute("id",a):this.getNode().removeAttribute("id");return this};m.prototype.setType=function(a){a&&""!=a?this.getNode().setAttribute("type",a):this.getNode().removeAttribute("type");return this};m.prototype.setXMLLang=function(a){a&&""!=a?this.getNode().setAttribute("xml:lang",a):this.getNode().removeAttribute("xml:lang");return this};m.prototype.getTo=function(){return this.getNode().getAttribute("to")};m.prototype.getFrom=
function(){return this.getNode().getAttribute("from")};m.prototype.getToJID=function(){return new v(this.getTo())};m.prototype.getFromJID=function(){return new v(this.getFrom())};m.prototype.getID=function(){return this.getNode().getAttribute("id")};m.prototype.getType=function(){return this.getNode().getAttribute("type")};m.prototype.getXMLLang=function(){return this.getNode().getAttribute("xml:lang")};m.prototype.getXMLNS=function(){return this.getNode().namespaceURI||this.getNode().getAttribute("xmlns")};
m.prototype.getChild=function(a,b){if(!this.getNode())return null;a=a||"*";b=b||"*";if(this.getNode().getElementsByTagNameNS)return this.getNode().getElementsByTagNameNS(b,a).item(0);a=this.getNode().getElementsByTagName(a);if("*"!=b)for(var c=0;c<a.length;c++){if(a.item(c).namespaceURI==b||a.item(c).getAttribute("xmlns")==b)return a.item(c)}else return a.item(0);return null};m.prototype.getChildVal=function(a,b){a=this.getChild(a,b);b="";if(a&&a.hasChildNodes())for(var c=0;c<a.childNodes.length;c++)a.childNodes.item(c).nodeValue&&
(b+=a.childNodes.item(c).nodeValue);return b};m.prototype.clone=function(){return m.wrapNode(this.getNode())};m.prototype.isError=function(){return"error"==this.getType()};m.prototype.errorReply=function(a){var b=this.clone();b.setTo(this.getFrom());b.setFrom();b.setType("error");b.appendNode("error",{code:a.code,type:a.type},[[a.cond,{xmlns:L}]]);return b};m.prototype.xml="undefined"!=typeof XMLSerializer?function(){var a=(new XMLSerializer).serializeToString(this.getNode());"undefined"==typeof a&&
(a=(new XMLSerializer).serializeToString(this.doc));return a}:function(){return this.getDoc().xml};m.prototype._getAttribute=function(a){return this.getNode().getAttribute(a)};null==document.ELEMENT_NODE&&(document.ELEMENT_NODE=1,document.ATTRIBUTE_NODE=2,document.TEXT_NODE=3,document.CDATA_SECTION_NODE=4,document.ENTITY_REFERENCE_NODE=5,document.ENTITY_NODE=6,document.PROCESSING_INSTRUCTION_NODE=7,document.COMMENT_NODE=8,document.DOCUMENT_NODE=9,document.DOCUMENT_TYPE_NODE=10,document.DOCUMENT_FRAGMENT_NODE=
11,document.NOTATION_NODE=12);m.prototype._importNode=function(a,b){switch(a.nodeType){case document.ELEMENT_NODE:var c;c=this.getDoc().createElementNS?this.getDoc().createElementNS(a.namespaceURI,a.nodeName):this.getDoc().createElement(a.nodeName);var d,e;if(a.attributes&&0<a.attributes.length)for(d=0,e=a.attributes.length;d<e;d++){var f=a.attributes.item(d);if("xmlns"!=f.nodeName||null===c.getAttribute("xmlns")&&!c.namespaceURI)c.setAttributeNS&&f.namespaceURI?c.setAttributeNS(f.namespaceURI,f.name,
f.value):c.setAttribute(f.name,f.value)}if(b&&a.childNodes&&0<a.childNodes.length)for(d=0,e=a.childNodes.length;d<e;d++)c.appendChild(this._importNode(a.childNodes.item(d),b));return c;case document.TEXT_NODE:case document.CDATA_SECTION_NODE:case document.COMMENT_NODE:return this.getDoc().createTextNode(a.nodeValue)}};m.prototype._setChildNode=function(a,b){var c=this.getChild(a);b=this.getDoc().createTextNode(b);if(c)try{c.replaceChild(b,c.firstChild)}catch(d){}else{try{c=this.getDoc().createElementNS(this.getNode().namespaceURI,
a)}catch(d){c=this.getDoc().createElement(a)}this.getNode().appendChild(c);c.appendChild(b)}return c};m.prototype.buildNode=function(a,b,c,d){return D.buildNode(this.getDoc(),a,b,c,d)};m.prototype.appendNode=function(a,b,c){return"object"==typeof a?this.getNode().appendChild(a):this.getNode().appendChild(this.buildNode(a,b,c,this.getNode().namespaceURI))};y.prototype=new m;y.prototype.setStatus=function(a){this._setChildNode("status",a);return this};y.prototype.setShow=function(a){"chat"!=a&&"away"!=
a&&"xa"!=a&&"dnd"!=a||this._setChildNode("show",a);return this};y.prototype.setPriority=function(a){this._setChildNode("priority",a);return this};y.prototype.setPresence=function(a,b,c){a&&this.setShow(a);b&&this.setStatus(b);c&&this.setPriority(c);return this};y.prototype.getStatus=function(){return this.getChildVal("status")};y.prototype.getShow=function(){return this.getChildVal("show")};y.prototype.getPriority=function(){return this.getChildVal("priority")};z.prototype=new m;z.prototype.setIQ=
function(a,b,c){a&&this.setTo(a);b&&this.setType(b);c&&this.setID(c);return this};z.prototype.setQuery=function(a){var b;try{b=this.getDoc().createElementNS(a,"query")}catch(c){b=this.getDoc().createElement("query"),b.setAttribute("xmlns",a)}this.getNode().appendChild(b);return b};z.prototype.getQuery=function(){return this.getNode().getElementsByTagName("query").item(0)};z.prototype.getQueryXMLNS=function(){return this.getQuery()?this.getQuery().namespaceURI||this.getQuery().getAttribute("xmlns"):
null};z.prototype.reply=function(a){var b=this.clone();b.setTo(this.getFrom());b.setFrom();b.setType("result");if(a)if("string"==typeof a)b.getChild().appendChild(b.getDoc().loadXML(a));else if(a.constructor==Array)for(var c=b.getChild(),d=0;d<a.length;d++)"string"==typeof a[d]?c.appendChild(b.getDoc().loadXML(a[d])):"object"==typeof a[d]&&c.appendChild(a[d]);else"object"==typeof a&&b.getChild().appendChild(a);return b};B.prototype=new m;B.prototype.setAmzAck=function(a){a&&""!=a?this.getNode().setAttribute("amz_ack",
a):this.getNode().removeAttribute("amz_ack");return this};B.prototype.setBody=function(a){this._setChildNode("body",a);return this};B.prototype.setSubject=function(a){this._setChildNode("subject",a);return this};B.prototype.setThread=function(a){this._setChildNode("thread",a);return this};B.prototype.getThread=function(){return this.getChildVal("thread")};B.prototype.getBody=function(){return this.getChildVal("body")};B.prototype.getSubject=function(){return this.getChildVal("subject")};B.prototype.getAmzAck=
function(){return this.getNode().getAttribute("amz_ack")};m.wrapNode=function(a){var b=null;switch(a.nodeName.toLowerCase()){case "presence":b=new y;break;case "message":b=new B;break;case "iq":b=new z}b&&b.getDoc().replaceChild(b._importNode(a,!0),b.getNode());return b};t.prototype=new d;t.prototype._cleanupWebSocket=function(){null!==this._ws&&(this._ws.onclose=null,this._ws.onerror=null,this._ws.onopen=null,this._ws.onmessage=null,this._ws.close(),this._ws=null)};t.prototype.connect=function(a){this._setStatus("connecting");
this.domain=a.domain||"localhost";this.username=a.username;this.resource=a.resource;this.pass=a.password||a.pass;this.authzid=a.authzid||"";this.register=a.register;this.authhost=a.authhost||this.domain;this.authtype=a.authtype||"sasl";this.jid=this.username+"@"+this.domain;this.fulljid=this.jid+"/"+this.resource;this._allow_plain=a.allow_plain?a.allow_plain:k.JSJAC_ALLOW_PLAIN;this._allow_scram=a.allow_scram?a.allow_scram:k.JSJAC_ALLOW_SCRAM;this._xmllang=a.xmllang&&""!==a.xmllang?a.xmllang:"en";
"undefined"===typeof WebSocket?this._handleEvent("onerror",n("503","cancel","service-unavailable")):(this._ws=new WebSocket(this._httpbase,"xmpp"),this._ws.onclose=l.bind(this._onclose,this),this._ws.onerror=l.bind(this._onerror,this),this._ws.onopen=l.bind(this._onopen,this))};t.prototype._onopen=function(){var a=this._getInitialRequestString();this.oDbg.log(a,4);this._ws.onmessage=l.bind(this._doSASLAuthDone,this);this._ws.send(a);this._doAuth()};t.prototype._handleOpenStream=function(a){this.oDbg.log(a.data,
4);a=a.data;a=a.substr(a.indexOf("\x3copen"));(a=this._parseXml(a))?(this.streamid=a.getAttribute("id"),this.oDbg.log("got streamid: "+this.streamid,2),this._ws.onmessage=l.bind(this._handleInitialResponse,this)):this._handleEvent("onerror",n("503","cancel","service-unavailable"))};t.prototype._handleInitialResponse=function(a){a=this._parseXml(a.data);this._parseStreamFeatures(a)?(this._connected=!0,this.register?this._doInBandReg():this._doAuth()):this._handleEvent("onerror",n("503","cancel","service-unavailable"))};
t.prototype.disconnect=function(){this._setStatus("disconnecting");this.connected()&&(this._connected=!1,this.oDbg.log("Disconnecting",4),this._sendRaw('\x3cclose xmlns\x3d"urn:ietf:params:xml:ns:xmpp-framing"/\x3e',l.bind(this._cleanupWebSocket,this)),this.oDbg.log("Disconnected",2),this._handleEvent("ondisconnect"))};t.prototype._onclose=function(){this.oDbg.log("websocket closed",2);"disconnecting"!==this._status&&(this._connected=!1,this._handleEvent("onerror",n("503","cancel","service-unavailable")))};
t.prototype._onerror=function(){this.oDbg.log("websocket error",1);this._connected=!1;this._handleEvent("onerror",n("503","cancel","service-unavailable"))};t.prototype._onmessage=function(a){var b;b=a.data;this._setStatus("processing");if(b&&""!==b&&(b=this._parseXml(b)))if(b.namespaceURI===E&&"error"===b.localName)0<b.getElementsByTagNameNS("urn:ietf:params:xml:ns:xmpp-streams","conflict").length&&this._setStatus("session-terminate-conflict"),this._connected=!1,this._handleEvent("onerror",n("503",
"cancel","remote-stream-error",b.children));else if(b=m.wrapNode(b))this.oDbg.log("async recv: "+a.data,4),this._handleEvent("packet_in",b),b.pType&&!this._handlePID(b)&&(this._handleEvent(b.pType()+"_in",b),this._handleEvent(b.pType(),b))};t.prototype._parseXml=function(a){var b;this.oDbg.log("Parsing: "+a,4);try{if(b=f.create("stream",E),0===a.trim().indexOf("\x3cclose")&&-1!==a.indexOf("urn:ietf:params:xml:ns:xmpp-framing")){this.oDbg.log("session terminated",1);clearTimeout(this._timeout);clearInterval(this._interval);
clearInterval(this._inQto);try{q.read(this._cookie_prefix+"JSJaC_State").erase()}catch(c){}this._connected=!1;this._handleEvent("onerror",n("503","cancel","session-terminate"));this.oDbg.log("Disconnected.",1);this._handleEvent("ondisconnect")}else{if(-1===a.indexOf("\x3cstream:stream"))return b.loadXML("\x3cstream:stream xmlns:stream\x3d'"+E+"' xmlns\x3d'jabber:client'\x3e"+a+"\x3c/stream:stream\x3e"),b.documentElement.firstChild;b.loadXML(a);return b.documentElement}}catch(c){this.oDbg.log("Error: "+
c),this._connected=!1,this._handleEvent("onerror",n("500","wait","internal-service-error"))}return null};t.prototype._getInitialRequestString=function(){var a;a=this.domain;this.authhost&&(a=this.authhost);return'\x3copen xmlns\x3d"urn:ietf:params:xml:ns:xmpp-framing" to\x3d"'+a+'" version\x3d"1.0"/\x3e'};t.prototype.send=function(a,b,c){if(!this.connected())return!1;if(!a||!a.pType)return this.oDbg.log("no packet: "+a,1),!1;this._ws.onmessage=l.bind(this._onmessage,this);b&&(a.getID()||a.setID("JSJaCID_"+
this._ID++),this._registerPID(a.getID(),b,c));try{this._handleEvent(a.pType()+"_out",a),this._handleEvent("packet_out",a),this._ws.send(a.xml())}catch(d){return this.oDbg.log(d.toString(),1),!1}return!0};t.prototype.resume=function(){return!1};t.prototype.suspend=function(){return!1};t.prototype._doSASLAuthScramSha1S1=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthScramSha1S1,this)(a)};t.prototype._doSASLAuthScramSha1S2=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthScramSha1S2,
this)(a)};t.prototype._doSASLAuthDigestMd5S1=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthDigestMd5S1,this)(a)};t.prototype._doSASLAuthDigestMd5S2=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthDigestMd5S2,this)(a)};t.prototype._doSASLAuthDone=function(a){a=this._parseXml(a.data);return l.bind(d.prototype._doSASLAuthDone,this)(a)};t.prototype._reInitStream=function(a){a=this.domain;this.authhost&&(a=this.authhost);this._sendRaw('\x3copen xmlns\x3d"urn:ietf:params:xml:ns:xmpp-framing" to\x3d"'+
a+'" version\x3d"1.0"/\x3e');this._doStreamBind()};t.prototype._sendRaw=function(a,b,c){if(!this._ws)return!1;b&&(this._ws.onmessage=l.bind(b,this,c));this._ws.send(a);return!0};return{JSJaC:l,JSJaCConsoleLogger:function(a){this.level=a||4;this.start=function(){};this.log=function(a,c){c=c||0;if(!(c>this.level)&&"undefined"!=typeof console)try{switch(c){case 0:console.warn(a);break;case 1:console.error(a);break;case 2:console.info(a);break;case 4:console.debug(a);break;default:console.log(a)}}catch(d){try{console.log(a)}catch(e){}}};
this.setLevel=function(a){this.level=a;return this};this.getLevel=function(){return this.level}},JSJaCError:n,JSJaCHttpBindingConnection:u,JSJaCIQ:z,JSJaCJID:v,JSJaCMessage:B,JSJaCPacket:m,JSJaCPresence:y,JSJaCWebSocketConnection:t}});x.register("3p-JSJaC-Config",function(){return{JSJAC_HAVEKEYS:!0,JSJAC_NKEYS:16,JSJAC_INACTIVITY:300,JSJAC_ERR_COUNT:10,JSJAC_ALLOW_PLAIN:!0,JSJAC_ALLOW_SCRAM:!1,JSJAC_CHECKQUEUEINTERVAL:1,JSJAC_CHECKINQUEUEINTERVAL:1,JSJAC_TIMERVAL:2E3,JSJAC_RETRYDELAY:5E3,JSJACHBC_MAX_HOLD:1,
JSJACHBC_MAX_WAIT:300,JSJACHBC_BOSH_VERSION:"1.6",JSJACHBC_USE_BOSH_VER:!0,JSJACHBC_MAXPAUSE:120}});x.register("3p-JSJaC-Crypt",function(){function k(e,f){var d=(e&65535)+(f&65535);return(e>>16)+(f>>16)+(d>>16)<<16|d&65535}function p(){b64=[];f64=[];for(var e=0;64>e;e++)b64[e]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e),f64["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(e)]=e}"undefined"!=typeof atob&&"undefined"!=typeof btoa||p();b64decode=
"undefined"==typeof atob?function(e){var f=[],d=0;e=e.replace(/\n|\r/g,"");for(e=e.replace(/=/g,"");d<e.length;)f[f.length]=f64[e.charAt(d)]<<2|f64[e.charAt(d+1)]>>4,f[f.length]=(f64[e.charAt(d+1)]&15)<<4|f64[e.charAt(d+2)]>>2,f[f.length]=(f64[e.charAt(d+2)]&3)<<6|f64[e.charAt(d+3)],d+=4;2==e.length%4&&(f=f.slice(0,f.length-2));3==e.length%4&&(f=f.slice(0,f.length-1));d=[];for(e=0;e<f.length;)128>f[e]?(d[d.length]=String.fromCharCode(f[e]),e++):191<f[e]&&224>f[e]?(d[d.length]=String.fromCharCode((f[e]&
31)<<6|f[e+1]&63),e+=2):(d[d.length]=String.fromCharCode((f[e]&15)<<12|(f[e+1]&63)<<6|f[e+2]&63),e+=3);return d.join("")}:function(e){return decodeURIComponent(escape(atob(e)))};b64encode="undefined"==typeof btoa?function(e){var f;f=e.replace(/\r\n/g,"\n");e=[];if(0>String.fromCharCode(237).charCodeAt(0))for(var d=0;d<f.length;d++){var h=f.charCodeAt(d);0<h?e[e.length]=h:(e[e.length]=256+h>>6|192,e[e.length]=256+h&63|128)}else for(d=0;d<f.length;d++)h=f.charCodeAt(d),128>h?e[e.length]=h:(127<h&&2048>
h?e[e.length]=h>>6|192:(e[e.length]=h>>12|224,e[e.length]=h>>6&63|128),e[e.length]=h&63|128);f=[];d=0;h=e.length;1==h%3&&(e[e.length]=0,e[e.length]=0);for(2==h%3&&(e[e.length]=0);d<e.length;)f[f.length]=b64[e[d]>>2],f[f.length]=b64[(e[d]&3)<<4|e[d+1]>>4],f[f.length]=b64[(e[d+1]&15)<<2|e[d+2]>>6],f[f.length]=b64[e[d+2]&63],d+=3;1==h%3&&(f[f.length-1]=f[f.length-2]="\x3d");2==h%3&&(f[f.length-1]="\x3d");return f.join("")}:function(e){return btoa(unescape(encodeURIComponent(e)))};return{b64decode:b64decode,
b64encode:b64encode,hex_sha1:function(e){for(var f=[],d=0;d<8*e.length;d+=8)f[d>>5]|=(e.charCodeAt(d/8)&255)<<24-d%32;e=8*e.length;f[e>>5]|=128<<24-e%32;f[(e+64>>9<<4)+15]=e;e=Array(80);for(var d=1732584193,h=-271733879,q=-1732584194,p=271733878,n=-1009589776,x=0;x<f.length;x+=16){for(var u=d,w=h,v=q,A=p,C=n,r=0;80>r;r++){if(16>r)e[r]=f[x+r];else{var m=e[r-3]^e[r-8]^e[r-14]^e[r-16];e[r]=m<<1|m>>>31}var m=d<<5|d>>>27,y;y=20>r?h&q|~h&p:40>r?h^q^p:60>r?h&q|h&p|q&p:h^q^p;m=k(k(m,y),k(k(n,e[r]),20>r?1518500249:
40>r?1859775393:60>r?-1894007588:-899497514));n=p;p=q;q=h<<30|h>>>2;h=d;d=m}d=k(d,u);h=k(h,w);q=k(q,v);p=k(p,A);n=k(n,C)}f=[d,h,q,p,n];e="";for(d=0;d<4*f.length;d++)e+="0123456789abcdef".charAt(f[d>>2]>>8*(3-d%4)+4&15)+"0123456789abcdef".charAt(f[d>>2]>>8*(3-d%4)&15);return e}}})});
/* ******** */
/*
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2015-2016 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
 2017 Amazon.com. All Rights Reserved.
 2015 Amazon.com. All Rights Reserved.
*/
(function(t){var v=window.AmazonUIPageJS||window.P,M=v._namespace||v.attributeErrors,e=M?M("CampfireJavaScriptSDK",""):v;e.guardFatal?e.guardFatal(t)(e,window):e.execute(function(){t(e,window)})})(function(t,v,M){t.when("AmazonComm/auth/cognito_auth_provider","AmazonComm/auth/cs_shared_key_auth_provider","AmazonComm/auth/shared_key_auth_provider","AmazonComm/common/person_class","AmazonComm/messaging/connection_strategy","AmazonComm/metrics/metrics_manager","AmazonComm/utils/build","AmazonComm/utils/common",
"AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/comm_service",function(e,l,f,d,n,k,c,a,m,q,u,h){function g(g,d,q,n){da=g;m.setApiKey(da);m.setMarketplaceId(q);m.setDomainName(d);z=k.createMetricEvent("CommService",k.AGGREGATING_EVENT);h.l("comm_service","AmazonComm version ["+c.BUILD_VERSION+"] built ["+c.BUILD_TIME+"]");k.incrementCounter(z,"Version."+c.BUILD_VERSION);h.l("comm_service","API key ["+da+"]");h.l("comm_service",
"Marketplace Id: ["+m.getMarketplaceId()+"]");m.disconnectOnUnload()&&v.addEventListener("beforeunload",b);t=a.isEmpty(n)?m.useCognitoAuth()?e:m.useCSSharedKeyAuth()?l:f:n;H={onConnected:function(b){var h=u.getCurrentAuthCredentialData(),c=u.getLocalUser();c.setJID(b.jid);c.setThirdPartyID(h.customerId);c.setName(h.customerName);c.setNameType(h.customerNameType);u.setLocalUser(c);p(!0,!1);for(b=0;b<J.length;b++)J[b].onConnected()},onDisconnected:function(){u.cleanup();k.uploadRecordedMetrics();B=
y=null;for(var b=0;b<J.length;b++)J[b].onDisconnected(C);C=null},onReconnecting:function(b){a.isEmpty(B)&&(k.incrementCounter(z,"CommService.ConnectionRetryCount"),p(!1,!1),B=new Date);for(var h=0;h<J.length;h++)J[h].onReconnecting(b)},onError:function(b){k.incrementCounter(z,"CommService.ConnectionError.ServiceErrorCount");p(!1,!0);for(var h=0;h<J.length;h++)J[h].onError(b)}};I={onGetAuthCredentialSuccess:function(b){h.l("comm_service","got auth token id: ["+b.customerId+"], name: ["+b.customerName+
"], authStatus: ["+b.authStatus+"]");u.setAuthCredentialData(b);b.marketplaceId!==m.getMarketplaceId()&&(k.incrementCounter(z,"CommService.AuthMarketplaceDifferentFromClient"),m.setMarketplaceId(b.marketplaceId));r.connect(da,b,H)||(k.incrementCounter(z,"CommService.ConnectionError.AlreadyConnectedCount"),y=null)},onGetAuthCredentialError:function(b){h.e("comm_service","error getting auth token: "+b.description);k.incrementCounter(z,"CommService.ConnectionError.AuthErrorCount");p(!1,!0);C=b;a.isEmpty(r)||
r.disconnect()}};w=!0}function b(){k.uploadRecordedMetrics();a.isEmpty(r)||r.disconnect()}function p(b,h){a.isEmpty(y)||(b?k.addTimer(z,"CommService.ConnectionSuccessTimer",new Date-y):k.addTimer(z,"CommService.ConnectionErrorTimer",new Date-y),y=null);!a.isEmpty(B)&&b&&(k.addTimer(z,"CommService.ReconnectionSuccessTimer",new Date-B),B=null);k.recordMetricEvent(z);h&&k.uploadRecordedMetrics()}var r=n.getConnection(),w=!1,da=null,J=[],H=null,t=null,I=null,C=null,z,y=null,B=null;return{VERSION:c.BUILD_VERSION,
BUILD_TIME:c.BUILD_TIME,initialize:function(b,h,c,a){g(b,h,c,a)},registerCommObserver:function(b){J.push(b);return b},unregisterCommObserver:function(b){b=J.indexOf(b);-1<b&&J.splice(b,1)},connect:function(){if(w)y=new Date,t.getAuthCredential(I);else for(var b={code:q.COMM_SERVICE_ERRORS.ERROR_NOT_INITIALIZED,description:"Comm service is not initialized - call initialize() before calling connect()"},h=0;h<J.length;h++)J[h].onError(b)},disconnect:function(){b()},isConnected:function(){return!a.isEmpty(r)&&
r.isConnected()},getMarketplaceId:function(){return m.getMarketplaceId()},getApiKey:function(){return da},getCommObservers:function(){return J},getAuthProvider:function(){return t},getConnectionObserver:function(){return H},getReconnectionRequestStartTime:function(){return B}}});t.when("AmazonComm/comm_service").execute(function(e){v["AmazonComm/comm_service"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/config","3p-JSJaC-Crypt").register("AmazonComm/auth/auth_utils",function(e,l,f){var d=
Object.freeze({Authenticated:"Authenticated",Recognized:"Recognized",Unrecognized:"Unrecognized",None:"None"}),n=Object.freeze({PenName:"PenName",RealName:"RealName",None:"None"});return{AmazonAuthStatus:d,parseAuthStatus:function(k){var c=d.None;e.isEmpty(k)||(k=k.toLowerCase(),k===d.Authenticated.toLowerCase()?c=d.Authenticated:k===d.Recognized.toLowerCase()?c=d.Recognized:k===d.Unrecognized.toLowerCase()&&(c=d.Unrecognized));return c},AmazonNameType:n,parseNameType:function(k){var c=n.None;e.isEmpty(k)||
(k=k.toLowerCase(),k===n.PenName.toLowerCase()?c=n.PenName:k===n.RealName.toLowerCase()&&(c=n.RealName));return c},getAuthenticationToken:function(e,c){var a="3|||";c=a=l.useCognitoAuth()?a+(f.b64encode(c)+"|||"+e.cognitoToken+"|||Cognito_SampleApp_TestRole"):a+(e.directedId+"|||"+e.directedIdExpiration+"|||"+e.directedIdSignature);e="|||"+e.customerId+"|||"+f.b64encode(e.customerName)+"|||"+e.customerNameType+"|||"+e.customerSignature+"|||"+e.authStatus+"|||"+e.authStatusTimestamp+"|||"+e.authStatusSignature;
return c+e}}});t.when("AmazonComm/auth/auth_utils").execute(function(e){v["AmazonComm/auth/auth_utils"]=e});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/auth/cognito_auth_provider",function(e,l,f,d,n,k,c,a){function m(){var b=f.createUUID(f.TAG_REQUEST),h=d.isAuthenticationCheckRequired(),
c=d.getApiKey(),g=d.getMarketplaceId();return JSON.stringify({requestId:b,authenticationCheckRequired:h,apiKey:c,marketplaceId:g})}function q(g,a){f.isEmpty(g)||isNaN(g)?(c.w("cognito_auth_provider","received invalid Cognito credential expiration date : ["+g+"], defaulting to expire in 3600s"),g=36E5+Date.now()):301E3>g-Date.now()&&(c.w("cognito_auth_provider","Cognito credential expiration date is too short : "+(new Date(g)).toString()+", changing to expire in 301s"),g=301E3+Date.now());w=g-3E5;
h();c.l("cognito_auth_provider","credential is good until "+(new Date(g)).toString()+", we will validate the credential has not expired every "+r+"ms");p=setInterval(function(){Date.now()>=w&&u(a)},r);b=!0}function u(h){var p=l.createMetricEvent("CognitoAuthProvider",l.AGGREGATING_EVENT);l.startTimer(p,"GetCognitoAuthPayloadForAmazonCookie.ApiTimer");var r=d.getInternalServiceHost(),w={url:r,api:"getCognitoAuthPayloadForAmazonCookie",payload:m(),withCredentials:!0},u={onXhrSendSuccess:function(a){a=
JSON.parse(a.responseText);c.l("cognito_auth_provider","got response to getCognitoAuthPayloadForAmazonCookie from ["+a.serverName+"] ("+a.serverIP+")");var d={cognitoToken:a.cognitoToken,authStatus:e.parseAuthStatus(a.authStatus),authStatusTimestamp:a.authStatusTimestamp,authStatusSignature:a.authStatusSignature,customerId:a.customerId,customerName:a.customerName,customerNameType:e.parseNameType(a.customerNameType),customerSignature:a.customerSignature,marketplaceId:a.marketplaceId},r=null;b&&!f.isEmpty(g)&&
(d.authStatus!==g.authStatus?r={code:n.AUTH_ERRORS.ERROR_AUTH_STATUS_CHANGED_ON_REFRESH,description:"auth status changed during Cognito credential refresh"}:d.authStatus!==e.AmazonAuthStatus.Authenticated&&d.authStatus!==e.AmazonAuthStatus.Recognized||d.customerId===g.customerId||(r={code:n.AUTH_ERRORS.ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH,description:"customer id changed during Cognito credential refresh"}));l.stopTimer(p,"GetCognitoAuthPayloadForAmazonCookie.ApiTimer");l.recordMetricEvent(p);if(f.isEmpty(r))r=
k.getLocalUser(),r.setName(d.customerName),r.setNameType(d.customerNameType),k.setLocalUser(r),q(a.cognitoTokenExpiration,h),g=d,h.onGetAuthCredentialSuccess(d);else h.onGetAuthCredentialError(r)},onXhrSendRetry:h.onGetAuthCredentialRetry,onXhrSendFailed:function(b){l.stopTimer(p,"GetCognitoAuthPayloadForAmazonCookie.ApiTimer");l.recordMetricEvent(p);h.onGetAuthCredentialError(b)}};c.l("cognito_auth_provider","exchanging amazon cookies for Cognito credential using ["+r+"]");a.sendRestXhrWithRetries(w,
u)}function h(){c.l("cognito_auth_provider","clearing Cognito credential refresh timeout");clearInterval(p);p=0;b=!1;g=null}var g=null,b=!1,p=0,r=3E4,w=0;k.registerCleanupObserver({cleanup:function(){c.l("cognito_auth_provider","cleaning up cognito_auth_provider");h()}});return{getAuthCredential:function(b){u(b)},stopCredentialRefresh:function(){h()},shouldRefreshCredential:function(){return Date.now()>=w},getTokenRefreshInterval:function(){return p},setTokenExpirationCheckPeriod:function(b){r=b},
getRefreshTimeoutMillis:function(){return w},setRefreshTimeoutMillis:function(b){w=b},setIsRefresh:function(h){b=h},setCurrentCredential:function(b){g=b}}});t.when("AmazonComm/auth/cognito_auth_provider").execute(function(e){v["AmazonComm/auth/cognito_auth_provider"]=e});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/auth/cs_shared_key_auth_provider",
function(e,l,f,d,n,k,c,a){function m(){var b=f.createUUID(f.TAG_REQUEST),h=d.getApiKey(),c=d.getMarketplaceId();return JSON.stringify({requestId:b,authenticationCheckRequired:!0,apiKey:h,marketplaceId:c})}function q(a,g){f.isEmpty(a)||isNaN(a)?(c.w("cs_shared_key_auth_provider","received invalid shared key credential expiration date : ["+a+"], defaulting to expire in 86400s"),a=864E5+Date.now()):1801E3>a-Date.now()&&(c.w("cs_shared_key_auth_provider","shared key credential expiration date is too short : "+
(new Date(a)).toString()+", changing to expire in 1801s"),a=1801E3+Date.now());w=a-18E5;h();c.l("cs_shared_key_auth_provider","credential is good until "+(new Date(a)).toString()+", we will validate the credential has not expired every "+r+"ms");p=setInterval(function(){Date.now()>=w&&u(g)},r);b=!0}function u(h){var p=l.createMetricEvent("CSSharedKeyAuthProvider",l.AGGREGATING_EVENT);l.startTimer(p,"GetSharedKeyAuthPayloadForCscCookie.ApiTimer");var r=d.getInternalServiceHost(),w={url:r,api:"getSharedKeyAuthPayloadForCscCookie",
payload:m(),withCredentials:!0},u={onXhrSendSuccess:function(a){var d=JSON.parse(a.responseText);c.l("cs_shared_key_auth_provider","got response to getSharedKeyAuthPayloadForCscCookie from ["+d.serverName+"] ("+d.serverIP+")");a={directedId:d.directedId,directedIdExpiration:d.directedIdExpiration,directedIdSignature:d.directedIdSignature,authStatus:e.parseAuthStatus(d.authStatus),authStatusTimestamp:d.authStatusTimestamp,authStatusSignature:d.authStatusSignature,customerId:d.customerId,customerName:d.customerName,
customerNameType:e.parseNameType(d.customerNameType),customerSignature:d.customerSignature,marketplaceId:d.marketplaceId};var r=null;a.authStatus!==e.AmazonAuthStatus.Authenticated?r={code:n.GENERIC_ERRORS.ERROR_UNKNOWN,description:"could not authenticate against CSC login"}:b&&!f.isEmpty(g)&&(a.authStatus!==g.authStatus?(r={code:n.AUTH_ERRORS.ERROR_AUTH_STATUS_CHANGED_ON_REFRESH,description:"auth status changed during CSC shared key credential refresh"},l.incrementCounter(p,"GetSharedKeyAuthPayloadForCscCookie.AuthErrorCount.AuthStatusChanged")):
a.authStatus===e.AmazonAuthStatus.Authenticated&&a.customerId!==g.customerId&&(r={code:n.AUTH_ERRORS.ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH,description:"customer id changed during CSC shared key credential refresh"},l.incrementCounter(p,"GetSharedKeyAuthPayloadForCscCookie.AuthErrorCount.CustomerIdChanged")));l.stopTimer(p,"GetSharedKeyAuthPayloadForCscCookie.ApiTimer");l.recordMetricEvent(p);if(f.isEmpty(r))r=null,f.isEmpty(d.directedIdExpiration)||(r=d.directedIdExpiration),d=k.getLocalUser(),d.setName(a.customerName),
d.setNameType(a.customerNameType),k.setLocalUser(d),q(r,h),g=a,h.onGetAuthCredentialSuccess(a);else h.onGetAuthCredentialError(r)},onXhrSendRetry:h.onGetAuthCredentialRetry,onXhrSendFailed:function(b){l.stopTimer(p,"GetSharedKeyAuthPayloadForCscCookie.ApiTimer");l.recordMetricEvent(p);h.onGetAuthCredentialError(b)}};c.l("cs_shared_key_auth_provider","exchanging csc cookies for shared key credential using ["+r+"]");a.sendRestXhrWithRetries(w,u)}function h(){c.l("cs_shared_key_auth_provider","clearing shared key credential refresh timeout");
clearInterval(p);p=0;b=!1;g=null}var g=null,b=!1,p=0,r=3E4,w=0;k.registerCleanupObserver({cleanup:function(){c.l("cs_shared_key_auth_provider","cleaning up cs_shared_key_auth_provider");h()}});return{getAuthCredential:function(b){u(b)},stopCredentialRefresh:function(){h()},shouldRefreshCredential:function(){return Date.now()>=w},getTokenRefreshInterval:function(){return p},setTokenExpirationCheckPeriod:function(b){r=b},getRefreshTimeoutMillis:function(){return w},setRefreshTimeoutMillis:function(b){w=
b},setIsRefresh:function(h){b=h},setCurrentCredential:function(b){g=b}}});t.when("AmazonComm/auth/cs_shared_key_auth_provider").execute(function(e){v["AmazonComm/auth/cs_shared_key_auth_provider"]=e});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/auth/shared_key_auth_provider",function(e,
l,f,d,n,k,c,a){function m(){var b=f.createUUID(f.TAG_REQUEST),h=d.isAuthenticationCheckRequired(),a=d.getApiKey(),c=d.getMarketplaceId(),g=d.getDomainName(),b={requestId:b,authenticationCheckRequired:h,apiKey:a,marketplaceId:c,domainName:g,messagingServiceDomain:d.getMessagingDomain(),clusterName:d.getClusterName()};return JSON.stringify(b)}function q(a,g){f.isEmpty(a)||isNaN(a)?(c.w("shared_key_auth_provider","received invalid shared key credential expiration date : ["+a+"], defaulting to expire in 86400s"),
a=864E5+Date.now()):1801E3>a-Date.now()&&(c.w("shared_key_auth_provider","shared key credential expiration date is too short : "+(new Date(a)).toString()+", changing to expire in 1801s"),a=1801E3+Date.now());w=a-18E5;h();c.l("shared_key_auth_provider","credential is good until "+(new Date(a)).toString()+", we will validate the credential has not expired every "+r+"ms");p=setInterval(function(){Date.now()>=w&&u(g)},r);b=!0}function u(h){var p=l.createMetricEvent("SharedKeyAuthProvider",l.AGGREGATING_EVENT);
l.startTimer(p,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimer");var r=d.getInternalServiceHost(),w={url:r,api:"getCampfireConnectionPayloadForAmazonCookie",payload:m(),withCredentials:!0},u={onXhrSendSuccess:function(a){a=JSON.parse(a.responseText);c.l("shared_key_auth_provider","got response to getCampfireConnectionPayloadForAmazonCookie from ["+a.serverName+"] ("+a.serverIP+")");var d=a.directedId,r=a.directedIdExpiration,m=a.directedIdSignature,w=e.parseAuthStatus(a.authStatus),u=a.authStatusTimestamp,
H=a.authStatusSignature,t=a.customerId,v=a.customerName,E=e.parseNameType(a.customerNameType),K=a.customerSignature,I=a.marketplaceId,F=null,S=a.messagingServiceHosts;if(!f.isEmpty(S)&&!f.isEmpty(S[0])){for(var S=a.messagingServiceHosts[0].hostName,T=null,A=null,x=a.messagingServiceHosts[0].protocols,R=0;R<x.length;++R)if("wss"===x[R].scheme){T=x[R].scheme;A=x[R].port;break}f.isEmpty(S)||f.isEmpty(T)||(F={hostName:S,protocol:T,port:A})}d={directedId:d,directedIdExpiration:r,directedIdSignature:m,
authStatus:w,authStatusTimestamp:u,authStatusSignature:H,customerId:t,customerName:v,customerNameType:E,customerSignature:K,marketplaceId:I,messagingHostInfo:F};r=null;b&&!f.isEmpty(g)&&(d.authStatus!==g.authStatus?(r={code:n.AUTH_ERRORS.ERROR_AUTH_STATUS_CHANGED_ON_REFRESH,description:"auth status changed during shared key credential refresh"},l.incrementCounter(p,"GetCampfireConnectionPayloadForAmazonCookie.AuthErrorCount.AuthStatusChanged")):d.authStatus!==e.AmazonAuthStatus.Authenticated&&d.authStatus!==
e.AmazonAuthStatus.Recognized||d.customerId===g.customerId||(r={code:n.AUTH_ERRORS.ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH,description:"customer id changed during shared key credential refresh"},l.incrementCounter(p,"GetCampfireConnectionPayloadForAmazonCookie.AuthErrorCount.CustomerIdChanged")));l.stopTimer(p,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimer");l.recordMetricEvent(p);if(f.isEmpty(r))r=null,f.isEmpty(a.directedIdExpiration)||(r=a.directedIdExpiration),a=k.getLocalUser(),a.setName(d.customerName),
a.setNameType(d.customerNameType),k.setLocalUser(a),q(r,h),g=d,h.onGetAuthCredentialSuccess(d);else h.onGetAuthCredentialError(r)},onXhrSendRetry:h.onGetAuthCredentialRetry,onXhrSendFailed:function(b){l.stopTimer(p,"GetCampfireConnectionPayloadForAmazonCookie.ApiTimer");l.recordMetricEvent(p);h.onGetAuthCredentialError(b)}};c.l("shared_key_auth_provider","exchanging amazon cookies for shared key credential using ["+r+"]");a.sendRestXhrWithRetries(w,u)}function h(){c.l("shared_key_auth_provider","clearing shared key credential refresh timeout");
clearInterval(p);p=0;b=!1;g=null}var g=null,b=!1,p=0,r=3E4,w=0;k.registerCleanupObserver({cleanup:function(){c.l("shared_key_auth_provider","cleaning up shared_key_auth_provider");h()}});return{getAuthCredential:function(b){u(b)},stopCredentialRefresh:function(){h()},shouldRefreshCredential:function(){return Date.now()>=w},getTokenRefreshInterval:function(){return p},setTokenExpirationCheckPeriod:function(b){r=b},getRefreshTimeoutMillis:function(){return w},setRefreshTimeoutMillis:function(b){w=b},
setIsRefresh:function(a){b=a},setCurrentCredential:function(b){g=b}}});t.when("AmazonComm/auth/shared_key_auth_provider").execute(function(e){v["AmazonComm/auth/shared_key_auth_provider"]=e});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/chatroom/association_class","AmazonComm/messaging/chatroom/chat_room_user_class","AmazonComm/messaging/presence_class","AmazonComm/utils/common","AmazonComm/utils/global_state").register("AmazonComm/common/chatroom_class",
function(e,l,f,d,n,k,c){e=function(a,c){this.mJID=a;this.mName=c;this.mChatRoomUsers={};this.mChatRoomAssociationChangeObservers=[]};e.prototype.toString=function(){return"ChatRoom:{name:["+this.mName+"], JID:"+this.mJID.toString()+"}"};e.prototype.getJID=function(){return this.mJID};e.prototype.getName=function(){return this.mName};e.prototype.getDescription=function(){return null};e.prototype.getChatRoomUserCount=function(){return Object.keys(this.mChatRoomUsers).length};e.prototype.getChatRoomUsers=
function(){for(var a=[],c=Object.keys(this.mChatRoomUsers),d=0;d<c.length;d++)a.push(this.mChatRoomUsers[c[d]]);return a};e.prototype.registerAssociationChangeObserver=function(a){k.isEmpty(a)||-1!==this.mChatRoomAssociationChangeObservers.indexOf(a)||this.mChatRoomAssociationChangeObservers.push(a);return a};e.prototype.unregisterAssociationChangeObserver=function(a){-1!==this.mChatRoomAssociationChangeObservers.indexOf(a)&&this.mChatRoomAssociationChangeObservers.splice(this.mChatRoomAssociationChangeObservers.indexOf(a),
1)};e.prototype.onPresenceReceived=function(a){var c=a.getRoomPresence().getItems()[0],e=c.getJID(),u=a.getFrom().getNickname(),h=null;try{h=l.Person.fromJSONObject(JSON.parse(k.base32ToString(u)))}catch(g){try{h=l.Person.fromJSONObject(JSON.parse(k.base64ToString(u)))}catch(b){h=new l.Person(e)}}e=k.isEmpty(c.getRole())?f.Role.NONE:c.getRole();c=k.isEmpty(c.getAffiliation())?f.Affiliation.NONE:c.getAffiliation();c=new f.Association(e,c);h=new d.ChatRoomUser(h,c);a.getType()===n.PresenceType.AVAILABLE?
this.mChatRoomUsers[u]=h:a.getType()===n.PresenceType.UNAVAILABLE&&delete this.mChatRoomUsers[u];this.updateAssociationChangeObservers(h)};e.getLocalUserNickname=function(){return k.stringToBase32(JSON.stringify(c.getLocalUser().toJSONObject()))};e.prototype.updateAssociationChangeObservers=function(a){if(!k.isEmpty(this.mChatRoomAssociationChangeObservers))for(var c=0;c<this.mChatRoomAssociationChangeObservers.length;c++)this.mChatRoomAssociationChangeObservers[c].onAssociationChanged(a)};e.prototype.onLeaveRoom=
function(){this.mChatRoomAssociationChangeObservers=[]};return{ChatRoom:e}});t.when("AmazonComm/common/chatroom_class").execute(function(e){v["AmazonComm/common/chatroom_class"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/config").register("AmazonComm/common/jid_class",function(e,l){var f=function(d,f){e.isEmpty(d)&&(d=e.createUUID(e.TAG_JID));var k;k=-1===d.indexOf("@")?!1:!0;k||(d+="@",d=e.isEmpty(f)?d+l.getMessagingDomain():d+f);this.mJIDString=d};f.prototype.getJIDAsString=function(){return this.mJIDString};
f.prototype.getBareJID=function(){return-1===this.mJIDString.indexOf("/")?this.mJIDString:this.mJIDString.substring(0,this.mJIDString.indexOf("/"))};f.prototype.isGroupJID=function(){return-1!==this.mJIDString.indexOf(l.MUC_DOMAIN_PREFIX)};f.prototype.toString=function(){var d=this.mJIDString,e=d.substring(0,d.indexOf("@")),e="[..."+e.substring(e.length-20);return e=-1!==d.indexOf(l.MUC_DOMAIN_PREFIX)?e+"/group]":e+"]"};f.prototype.equals=function(d){return this.getBareJID().toLowerCase()===d.getBareJID().toLowerCase()};
f.prototype.isEqualsFullJID=function(d){return this.getResource()===d.getResource()&&this.equals(d)};f.prototype.setResource=function(d){if(e.isEmpty(d))return!1;var f=this.getResource();e.isEmpty(f)?this.mJIDString+="/"+d:this.mJIDString=this.mJIDString.replace("/"+f,"/"+d);return!0};f.prototype.setNickname=function(d){return this.isGroupJID()?this.setResource(d):!1};f.prototype.getResource=function(){return-1===this.mJIDString.indexOf("/")?null:this.mJIDString.substring(this.mJIDString.indexOf("/")+
1)};f.prototype.getNickname=function(){return this.isGroupJID()?this.getResource():null};f.prototype.toJSONObject=function(){return{mJIDString:this.mJIDString}};f.fromJSONObject=function(d){return new f(d.mJIDString)};return{JID:f}});t.when("AmazonComm/common/jid_class").execute(function(e){v["AmazonComm/common/jid_class"]=e});t.when("AmazonComm/utils/common","AmazonComm/common/jid_class").register("AmazonComm/common/person_class",function(e,l){var f=function(d,f,k,c,a,m,q){this.mBareJID=d;this.mName=
f;this.mThirdPartyID=k;this.mNameType=c;e.isEmpty(a)||(this.mMobile=a);e.isEmpty(m)||(this.mEmail=m);this.setUserExist(q)};f.prototype.toString=function(){return"Person:{name:["+this.mName+"], JID:"+this.mBareJID.toString()+", ThirdPartyID:["+this.mThirdPartyID+"], NameType:["+this.mNameType+"], Mobile:["+this.mMobile+"], Email:["+this.mEmail+"], User exists in Campfire:["+this.mUserExist+"]}"};f.prototype.getJID=function(){return this.mBareJID};f.prototype.setJID=function(d){this.mBareJID=d};f.prototype.getName=
function(){return this.mName};f.prototype.setName=function(d){this.mName=d};f.prototype.getThirdPartyID=function(){return this.mThirdPartyID};f.prototype.setThirdPartyID=function(d){this.mThirdPartyID=d};f.prototype.getNameType=function(){return this.mNameType};f.prototype.setNameType=function(d){this.mNameType=d};f.prototype.getMobile=function(){return this.mMobile};f.prototype.setMobile=function(d){this.mMobile=d};f.prototype.getEmail=function(){return this.mEmail};f.prototype.setEmail=function(d){this.mEmail=
d};f.prototype.isUserExist=function(){return this.mUserExist};f.prototype.setUserExist=function(d){if(!0===d||!1===d)this.mUserExist=d};f.prototype.equals=function(d){return this.mBareJID.equals(d.getJID())};f.prototype.toJSONObject=function(){return{mBareJID:this.mBareJID.toJSONObject(),mName:this.mName,mThirdPartyID:this.mThirdPartyID,mNameType:this.mNameType}};f.fromJSONObject=function(d){var e=new l.JID.fromJSONObject(d.mBareJID);return new f(e,d.mName,d.mThirdPartyID,d.mNameType)};return{Person:f}});
t.when("AmazonComm/common/person_class").execute(function(e){v["AmazonComm/common/person_class"]=e});t.when("AmazonComm/messaging/presence_manager","AmazonComm/utils/build","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/log","AmazonComm/utils/mash/campfire_cordova").register("AmazonComm/device/device_attributes",function(e,l,f,d,n,k){function c(a,c){if(f.isMashCordova())k.exec(a,[],c);else c.onError("Not in MASH context Or Cordova not defined")}function a(){f.isEmpty(document)||
(n.l("device_attributes","starting visibility change observer"),document.addEventListener("visibilitychange",function(){e.sendForegroundAppInfo(m())}))}function m(){var a={};a.isThisApp=!document.hidden;a.isThisApp&&(a.name=l.BUILD_VERSION);return a}function q(){f.isEmpty(navigator)||f.isEmpty(navigator.geolocation)||(n.l("device_attributes","starting geolocation observer"),navigator.geolocation.watchPosition(function(a){e.sendLocationInfo(u(a))}))}function u(a){var c={};c.latitude=a.coords.latitude;
c.longitude=a.coords.longitude;c.speed=a.coords.speed;return c}d.useWebDeviceAttributes()&&(a(),q());return{getBatteryInfo:function(a){c("getBatteryInfo",a)},getBluetoothInfo:function(a){c("getBluetoothInfo",a)},getLocationInfo:function(a){c("getLocationInfo",a)},getForegroundAppInfo:function(a){c("getForegroundAppInfo",a)},buildForegroundAppData:function(){return m()},buildLocationData:function(a){return u(a)}}});t.when("AmazonComm/device/device_attributes").execute(function(e){v["AmazonComm/device/device_attributes"]=
e});t.when("AmazonComm/auth/auth_utils","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/identity/customer_name_provider",function(e,l,f,d,n,k,c,a){function m(){var a=f.createUUID(f.TAG_REQUEST),c=d.getApiKey();return JSON.stringify({requestId:a,apiKey:c})}function q(q){var h=l.createMetricEvent("CustomerNameProvider",l.AGGREGATING_EVENT);
l.startTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer");var g=d.getInternalServiceHost(),b={url:g,api:"getCustomerNameForAmazonCookie",payload:m(),withCredentials:!0},p={onXhrSendSuccess:function(b){b=JSON.parse(b.responseText);c.l("customer_name_provider","got response to getCustomerNameForAmazonCookie request from ["+b.serverName+"] ("+b.serverIP+")");b={customerId:b.customerId,customerName:b.customerName,customerNameType:e.parseNameType(b.customerNameType)};var a=k.getLocalUser(),g=a.getThirdPartyID(),
d=k.getAuthCredentialData().authStatus;f.isEmpty(g)||g===b.customerId||f.isEmpty(d)||d===e.AmazonAuthStatus.Unrecognized||d===e.AmazonAuthStatus.None?(c.l("customer_name_provider","setting local user name to ["+b.customerName+"["+b.customerNameType+"]]"),a.setName(b.customerName),a.setNameType(b.customerNameType),k.setLocalUser(a),l.stopTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer"),l.recordMetricEvent(h),q.onGetCustomerNameForAmazonCookieSuccess(b)):(l.stopTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer"),
l.incrementCounter(h,"GetCustomerNameForAmazonCookie.IdentityErrorCount"),l.recordMetricEvent(h),q.onGetCustomerNameForAmazonCookieError({code:n.IDENTITY_ERRORS.ERROR_CUSTOMER_ID_DIFFERENT_THAN_AUTH,description:"customer id is different than the one used for authentication"}))},onXhrSendRetry:q.onGetCustomerNameForAmazonCookieRetry,onXhrSendFailed:function(b){l.stopTimer(h,"GetCustomerNameForAmazonCookie.ApiTimer");l.recordMetricEvent(h);q.onGetCustomerNameForAmazonCookieError(b)}};c.l("customer_name_provider",
"exchanging amazon cookies for customer name info using ["+g+"]");a.sendRestXhrWithRetries(b,p)}return{getCustomerNameForAmazonCookie:function(a){q(a)}}});t.when("AmazonComm/identity/customer_name_provider").execute(function(e){v["AmazonComm/identity/customer_name_provider"]=e});t.when("AmazonComm/messaging/jsjac/connection","AmazonComm/messaging/native/connection","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/log").register("AmazonComm/messaging/connection_strategy",function(e,
l,f,d,n){var k=function(){var c;f.isMashCordova()&&!d.isProd()?(n.l("connection_strategy","mash context loaded, using NativeConnection"),c=l):(n.l("connection_strategy","mash context not found or running in prod, using JSJaCConnection"),c=e);return c}();return{getConnection:function(){return k}}});t.when("AmazonComm/messaging/connection_strategy").execute(function(e){v["AmazonComm/messaging/connection_strategy"]=e});t.when("AmazonComm/common/jid_class","AmazonComm/messaging/connection_strategy","AmazonComm/messaging/message_class",
"AmazonComm/messaging/receipt_class","AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/metrics/metrics_manager","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/conversation_class",function(e,l,f,d,n,k,c,a,m,q,u){function h(b){var a=new d.Receipt;k.isEmpty(b)||a.setCustomType(b);a.setSender(m.getLocalUser().getJID());a.setTime((new Date).getTime());return a}function g(b,a){var c=new f.Message,
h=m.getLocalUser();c.setID(b.getID());c.setFrom(h.getJID());c.setTo(b.getFrom());c.getTo().isGroupJID()?c.setType(f.TYPE_GROUPCHAT):c.setType(f.TYPE_CHAT);c.setAmzType(f.AMZ_TYPE_RECEIPT);c.setAmzSubType(a);c.setAmzSenderJID(h.getJID());c.setAmzSenderId(h.getThirdPartyID());return c}function b(b,a){for(var c=!1,h=0;h<b.length;h++){var g=b[h];if((k.isEmpty(a)||a===g.getCustomType())&&g.getSender().equals(m.getLocalUser().getJID())){c=!0;break}}return c}function p(b,a){var c=m.getLocalUser(),h=m.getPersonaName();
b.setFrom(c.getJID());b.setTo(a.getJID());a.getJID().isGroupJID()?b.setType(f.TYPE_GROUPCHAT):b.setType(f.TYPE_CHAT);b.setAmzSenderJID(c.getJID());b.setAmzSenderName(c.getName());b.setAmzSenderId(c.getThirdPartyID());k.isEmpty(h)||b.setAmzSenderPersona({name:h});return b}var r,w=l.getConnection();e=function(a){r=c.createMetricEvent("CampfireConversation",c.AGGREGATING_EVENT);this.mWith=a;this.mReadReceiptsEnabled=this.mDeliveryReceiptsEnabled=!1;this.mMessages=[];this.mMessageObserverList=[];var d=
this;w.addMessageHandler(f.AMZ_TYPE_MESSAGE,{onMessage:function(a){if(d.shouldContainMessage(a)&&(d.addMessage(a),d.areDeliveryReceiptsEnabled()&&!a.wasSentByUs())){var c=a.getAmzDeliveryReceipts();b(c)||(a=g(a,f.AMZ_SUBTYPE_RECEIPT_DELIVERY),a.setAmzDeliveryReceipts([h()]),w.sendMessage(a))}},onError:function(b){d.shouldContainMessage(b)&&d.addMessage(b)}});w.addMessageHandler(f.AMZ_TYPE_RECEIPT,{onMessage:function(b){if(d.shouldContainMessage(b)){var a=d.findMessageById(b.getID());if(!k.isEmpty(a)){var c=
b.getAmzDeliveryReceipts();k.isEmpty(c)||a.addAmzDeliveryReceipts(c);c=b.getAmzReadReceipts();k.isEmpty(c)||a.addAmzReadReceipts(c);b=b.getAmzCustomReceipts();k.isEmpty(b)||a.addAmzCustomReceipts(b);for(b=0;b<d.mMessageObserverList.length;b++)d.mMessageObserverList[b].onMessage(a)}}}});w.addMessageHandler(f.AMZ_TYPE_DATA,{onMessage:function(b){d.shouldContainMessage(b)&&d.addMessage(b)},onError:function(b){d.shouldContainMessage(b)&&d.addMessage(b)}})};e.prototype.shouldContainMessage=function(b){return b.getWith().equals(this.getWith().getJID())};
e.prototype.findMessageById=function(b){for(var a=this.mMessages.length-1;0<=a;a--)if(this.mMessages[a].getID()===b)return this.mMessages[a];return null};e.prototype.getWith=function(){return this.mWith};e.prototype.sendTextMessage=function(b){var a=new f.Message;a.setAmzType(f.AMZ_TYPE_MESSAGE);a.setAmzSubType(f.AMZ_SUBTYPE_MESSAGE_TEXT);a.setAmzContent(b);a=p(a,this.mWith);w.sendMessage(a,this.mMessageTimeout);this.mComposingSent=!1;return a};e.prototype.sendDataMessage=function(b,a){m.getLocalUser();
var c=new f.Message;c.setAmzType(f.AMZ_TYPE_DATA);a?c.setAmzSubType(f.AMZ_SUBTYPE_DATA_OBJECT_ARCHIVABLE):c.setAmzSubType(f.AMZ_SUBTYPE_DATA_OBJECT_NON_ARCHIVABLE);c.setAmzData(b);c=p(c,this.mWith);w.sendMessage(c,this.mMessageTimeout);return c};e.prototype.sendReadReceipt=function(a){if(this.areReadReceiptsEnabled()&&!a.wasSentByUs()){var c=a.getAmzReadReceipts();b(c)||(a=g(a,f.AMZ_SUBTYPE_RECEIPT_READ),a.setAmzReadReceipts([h()]),w.sendMessage(a))}};e.prototype.sendCustomReceipt=function(a,c){if(!a.wasSentByUs()){var d=
a.getAmzCustomReceipts();b(d,c)||(a=g(a,f.AMZ_SUBTYPE_RECEIPT_CUSTOM),a.setAmzCustomReceipts([h(c)]),w.sendMessage(a))}};e.prototype.setMessageTimeout=function(b){this.mMessageTimeout=b};e.prototype.setDeliveryReceiptsEnabled=function(b){this.mDeliveryReceiptsEnabled=b};e.prototype.areDeliveryReceiptsEnabled=function(){return this.mDeliveryReceiptsEnabled};e.prototype.setReadReceiptsEnabled=function(b){this.mReadReceiptsEnabled=b};e.prototype.areReadReceiptsEnabled=function(){return this.mReadReceiptsEnabled};
e.prototype.sendUpdatedMessage=function(b){b.setAmzIsUpdated(!0);b.setTo(this.mWith.getJID());w.sendMessage(b)};e.prototype.sendRetryMessage=function(b){b.hasBeenReceivedByServer()||(c.incrementCounter(r,"Conversation.MessageRetryCount"),c.recordMetricEvent(r),b.setError(!1),b.setTo(this.mWith.getJID()),w.sendMessage(b,this.mMessageTimeout));return b};e.prototype.sendComposingChatState=function(){var b=f.CHAT_STATE_COMPOSING,a=this.mWith,c=new f.Message;c.setAmzType(f.AMZ_TYPE_CHATSTATE);c.setChatStateComposing(b===
f.CHAT_STATE_COMPOSING);c.setChatStatePaused(b===f.CHAT_STATE_PAUSED);c=p(c,a);w.sendMessage(c)};e.prototype.addIncomingMessageObserver=function(b){var a=this.mWith.getJID(),c=w.addMessageHandler(f.AMZ_TYPE_MESSAGE,{onMessage:function(c){if(c.getWith().equals(a))b.onMessage(c)},onError:function(c){if(c.getWith().equals(a))b.onError(c)}});this.mMessageObserverList.push(c);return c};e.prototype.removeIncomingMessageObserver=function(b){var a=this.mMessageObserverList.indexOf(b);-1<a&&this.mMessageObserverList.splice(a,
1);w.removeMessageHandler(f.AMZ_TYPE_MESSAGE,b)};e.prototype.addIncomingDataObserver=function(b){var a=this.mWith.getJID();return w.addMessageHandler(f.AMZ_TYPE_DATA,{onMessage:function(c){if(c.getWith().equals(a))b.onMessage(c)},onError:function(c){if(c.getWith().equals(a))b.onError(c)}})};e.prototype.removeIncomingDataObserver=function(b){w.removeMessageHandler(f.AMZ_TYPE_DATA,b)};e.prototype.addIncomingReceiptObserver=function(b){var a=this.mWith.getJID();return w.addMessageHandler(f.AMZ_TYPE_RECEIPT,
{onMessage:function(c){if(c.getWith().equals(a))b.onMessage(c)}})};e.prototype.removeIncomingReceiptObserver=function(b){w.removeMessageHandler(f.AMZ_TYPE_RECEIPT,b)};e.prototype.addIncomingChatStateObserver=function(b){var a=this.mWith.getJID();return w.addMessageHandler(f.AMZ_TYPE_CHATSTATE,{onMessage:function(c){if(c.getWith().equals(a))b.onChatState(c)}})};e.prototype.removeIncomingChatStateObserver=function(b){w.removeMessageHandler(f.AMZ_TYPE_CHATSTATE,b)};e.prototype.removeLocalMessage=function(b){for(var a=
this.mMessages.length-1;0<=a;a--)if(this.mMessages[a].getID()===b){this.mMessages.splice(a,1);break}};e.prototype.buildLoadMessagesIQ=function(b,a){var c=new u.JSJaCIQ;c.setType("set");c.setID(k.createUUID(k.TAG_IQ));var h=n.appendNodeWithAttribute(c,c,"query","xmlns","urn:xmpp:mam:1"),g=n.appendNodeWithAttribute(c,h,"x","xmlns","jabber:x:data"),d=n.appendNodeWithAttribute(c,g,"field","var","FORM_TYPE");n.appendNodeWithText(c,d,"value","urn:xmpp:mam:1");d=n.appendNodeWithAttribute(c,g,"field","var",
"with");n.appendNodeWithText(c,d,"value",this.mWith.getJID().getJIDAsString());k.isEmpty(a)||(d=n.appendNodeWithAttribute(c,g,"field","var","includeBorder"),n.appendNodeWithText(c,d,"value",a));k.isEmpty(b)||(a=n.appendNodeWithAttribute(c,h,"set","xmlns","http://jabber.org/protocol/rsm"),n.appendNodeWithText(c,a,"max",b.count.toString()),k.isEmpty(b.last)||n.appendNodeWithText(c,a,"before",b.last),k.isEmpty(b.mediaType)||(g=n.appendNodeWithAttribute(c,g,"field","var","mediaType"),n.appendNodeWithText(c,
g,"value",b.mediaType)));return c};e.prototype.handleLoadMessagesResult=function(b){var a=b.getChild();b={};if(k.isEmpty(a))q.l("conversation","Received message history not paginated."),b.count=0,b.isComplete=!0;else{var c=a.getAttribute("complete");b.isComplete=!k.isEmpty(c)&&"true"===c;c=a.getAttribute("mediaType");k.isEmpty(c)||(b.mediaType=c);a=n.getChildNode(a,"set");c=n.getChildNode(a,"first");k.isEmpty(c)||(b.first=c.textContent);c=n.getChildNode(a,"last");k.isEmpty(c)||(b.last=c.textContent);
c=n.getChildNode(a,"count");b.count=parseInt(c.textContent,10);a=n.getChildNode(a,"max");b.max=parseInt(a.textContent,10)}return b};e.prototype.loadMessages=function(b,a,c){b=this.buildLoadMessagesIQ(b,c);var h=this;w.sendPacket(b,!1,function(b){b.isError()?(b=n.getCampfireErrorFromPacket(b),a.onError(b)):(b=h.handleLoadMessagesResult(b),a.onPage(b,h))})};e.prototype.addMessage=function(b){b.getAck()&&b.wasSentByUs()&&this.removeLocalMessage(b.getAck());if(0===this.mMessages.length)this.mMessages.push(b);
else for(var a=this.mMessages.length-1;0<=a;a--){if(this.mMessages[a].getAmzSortTime()<b.getAmzSortTime()||this.mMessages[a].getAmzSortTime()===b.getAmzSortTime()&&this.mMessages[a].getSecondaryAmzSortTime()<=b.getSecondaryAmzSortTime()){this.mMessages.splice(a+1,0,b);break}0===a&&this.mMessages.unshift(b)}2500<this.mMessages.length&&this.mMessages.splice(0,1)};e.prototype.getMessages=function(){return this.mMessages};e.prototype.getNewestMessage=function(){return k.isEmpty(this.mMessages)?null:this.mMessages[this.mMessages.length-
1]};e.prototype.toString=function(){return"Conversation:{with:"+this.mWith.toString()+"}"};return{Conversation:e}});t.when("AmazonComm/messaging/conversation_class").execute(function(e){v["AmazonComm/messaging/conversation_class"]=e});t.when("AmazonComm/common/chatroom_class","AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/connection_strategy","AmazonComm/messaging/conversation_class","AmazonComm/messaging/message_class","AmazonComm/messaging/chatroom/chat_room_manager",
"AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/conversation_manager",function(e,l,f,d,n,k,c,a,m,q,u){function h(){for(var b in E)if(E.hasOwnProperty(b)){var a=E[b],h={onJoined:function(){q.l("conversation_manager","Joined room ["+a.getWith()+"]")},onError:function(b){q.e("conversation_manager","error joining room ["+a.getWith()+"]")}};a.getWith()instanceof e.ChatRoom&&c.joinRoom(a.getWith(),h)}}function g(b){var a=
b.getWith();if(m.isEmpty(E[a])){var c=b.getType();if(c===k.TYPE_CHAT){a=w(new f.Person(a,b.getAmzSenderName(),b.getAmzSenderId()));a.addMessage(b);for(b=0;b<I.length;b++)I[b].onNewConversation(a);return!0}q.e("conversation_manager","Invalid state: Unexpected message type ["+c+"].")}return!1}function b(b){var a=b.getJID();m.isEmpty(E[a])&&w(b);return E[a]}function p(){var b=new u.JSJaCIQ;b.setType("set");b.setID(m.createUUID(m.TAG_IQ));a.appendNodeWithAttribute(b,b,"query","xmlns","urn:xmpp:amazon:inbox");
return b}function r(a){a=a.getChild().childNodes;for(var c=[],h,g=0;g<a.length;g++){h=a[g];var d=h.getAttribute("type");d===k.TYPE_GROUPCHAT?h=b(new e.ChatRoom(new l.JID(h.getAttribute("with")),h.getAttribute("name"))):d===k.TYPE_CHAT?h=b(new f.Person(new l.JID(h.getAttribute("with")),h.getAttribute("name"),"")):(q.e("conversation_manager","unknown conversation type ["+d+"]"),h=null);m.isEmpty(h)||c.push(h)}return c}function w(b){var a=new n.Conversation(b);return E[b.getJID()]=a}function t(b){H.sendPacket(p(),
!1,function(a){a=r(a);q.l("conversation_manager","loaded "+a.length+" conversations");b(a)})}function v(b){q.l("conversation_manager","loading inbox");t(function(a){for(var h=0;h<a.length;h++){var g=a[h];if(g.getWith()instanceof e.ChatRoom){var d=C.bind({conversation:g,observer:b});c.joinRoom(g.getWith(),{onJoined:d,onError:function(a){b.onError(a)}},{maxMessages:0})}else g.loadMessages({count:1},{onPage:function(a,c){b.onConversation({conversation:c})}})}})}var H=d.getConnection(),E={},I=[],C=function(){var b=
this.observer;this.conversation.loadMessages({count:1},{onPage:function(a,c){b.onConversation({conversation:c})}})};(function(){H.addMessageHandler(k.AMZ_TYPE_MESSAGE,{onMessage:function(b){g(b)},onError:function(b){g(b)}});H.addMessageHandler(k.AMZ_TYPE_DATA,{onMessage:function(b){g(b)},onError:function(b){g(b)}});H.addObserver({onError:function(b){q.e("conversation_manager","error connecting to Openfire.")},onReconnecting:function(){},onDisconnected:function(){E={}},onConnected:function(b){q.l("conversation_manager",
"on connected. trying to join rooms.["+b+"]");h()}})})();return{loadInbox:function(b){v(b)},getConversation:function(a,c){a=b(a);c.onSuccess({conversation:a})},getOrCreateConversation:function(a){return b(a)},addNewConversationHandler:function(b){I.push(b)},handleNewMessage:function(b){return g(b)},buildInboxIQ:function(){return p()},handleInboxResult:function(b){return r(b)},loadConversationList:function(b){return t(b)},getConversations:function(){return E}}});t.when("AmazonComm/messaging/conversation_manager").execute(function(e){v["AmazonComm/messaging/conversation_manager"]=
e});t.when("AmazonComm/common/jid_class","AmazonComm/messaging/receipt_class","AmazonComm/utils/build","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/global_state").register("AmazonComm/messaging/message_class",function(e,l,f,d,n,k){var c=function(){this.mID=d.createUUID(d.TAG_MESSAGE);this.mTo=this.mFrom="";this.mBody={};this.mError=!1;this.mBody.amz_time_created=(new Date).getTime();this.mBody.amz_marketplace_id=n.getMarketplaceId();n.isExtendedMessageMetadataEnabled()&&(this.mBody.amz_version=
f.BUILD_VERSION,this.mBody.amz_time_sent=0,this.mBody.amz_time_server_received=0,this.mBody.amz_time_received=0,this.mBody.amz_sender_location={},this.mBody.amz_keep_until=-1,this.mBody.amz_delivery_receipts=[],this.mBody.amz_read_receipts=[],this.mBody.amz_custom_receipts=[],this.mBody.amz_filter_details=[],this.mBody.amz_sender_profile={})};c.prototype.getID=function(){return this.mID};c.prototype.setID=function(a){this.mID=a};c.prototype.getAck=function(){return this.mAck};c.prototype.setAck=function(a){this.mAck=
a};c.prototype.getError=function(){return this.mError};c.prototype.setError=function(a){this.mError=a};c.prototype.getFrom=function(){return this.mFrom};c.prototype.setFrom=function(a){this.mFrom=a};c.prototype.getTo=function(){return this.mTo};c.prototype.setTo=function(a){this.mTo=a};c.prototype.getType=function(){return this.mType};c.prototype.setType=function(a){this.mType=a};c.prototype.getBody=function(){return this.mBody};c.prototype.setBody=function(a){this.mBody=a;d.isEmpty(this.mBody.amz_time_created)&&
(this.mBody.amz_time_created=(new Date).getTime());if(n.isExtendedMessageMetadataEnabled()){d.isEmpty(this.mBody.amz_version)&&(this.mBody.amz_version=f.BUILD_VERSION);d.isEmpty(this.mBody.amz_time_sent)&&(this.mBody.amz_time_sent=0);d.isEmpty(this.mBody.amz_time_server_received)&&(this.mBody.amz_time_server_received=0);d.isEmpty(this.mBody.amz_time_received)&&(this.mBody.amz_time_received=0);d.isEmpty(this.mBody.amz_sender_location)&&(this.mBody.amz_sender_location={});d.isEmpty(this.mBody.amz_keep_until)&&
(this.mBody.amz_keep_until=-1);d.isEmpty(this.mBody.amz_delivery_receipts)&&(this.mBody.amz_delivery_receipts=[]);d.isEmpty(this.mBody.amz_read_receipts)&&(this.mBody.amz_read_receipts=[]);d.isEmpty(this.mBody.amz_custom_receipts)&&(this.mBody.amz_custom_receipts=[]);d.isEmpty(this.mBody.amz_sender_profile)&&(this.mBody.amz_sender_profile={});for(a=0;a<this.mBody.amz_delivery_receipts.length;a++)this.mBody.amz_delivery_receipts[a]=new l.Receipt(this.mBody.amz_delivery_receipts[a]);for(a=0;a<this.mBody.amz_read_receipts.length;a++)this.mBody.amz_read_receipts[a]=
new l.Receipt(this.mBody.amz_read_receipts[a]);for(a=0;a<this.mBody.amz_custom_receipts.length;a++)this.mBody.amz_custom_receipts[a]=new l.Receipt(this.mBody.amz_custom_receipts[a]);d.isEmpty(this.mBody.amz_filter_details)&&(this.mBody.amz_filter_details=[])}};c.prototype.getSubject=function(){return this.mSubject};c.prototype.setSubject=function(a){this.mSubject=a};c.prototype.getAmzType=function(){return this.mBody.amz_type};c.prototype.setAmzType=function(a){this.mBody.amz_type=a};c.prototype.getAmzSubType=
function(){return this.mBody.amz_subtype};c.prototype.setAmzSubType=function(a){this.mBody.amz_subtype=a};c.prototype.getAmzVersion=function(){return this.mBody.amz_version};c.prototype.getAmzTimeCreated=function(){return this.mBody.amz_time_created};c.prototype.setAmzTimeCreated=function(a){this.mBody.amz_time_created=a};c.prototype.getAmzTimeSent=function(){return this.mBody.amz_time_sent};c.prototype.setAmzTimeSent=function(a){this.mBody.amz_time_sent=a};c.prototype.getAmzTimeServerReceived=function(){return this.mBody.amz_time_server_received};
c.prototype.setAmzTimeServerReceived=function(a){this.mBody.amz_time_server_received=a};c.prototype.getAmzTimeServerFirstProcessed=function(){var a=this.mBody.amz_time_server_received;d.isEmpty(this.mBody.amz_time_server_first_processed)||(a=this.mBody.amz_time_server_first_processed);return a};c.prototype.setAmzTimeServerFirstProcessed=function(a){this.mBody.amz_time_server_first_processed=a};c.prototype.getAmzTimeReceived=function(){return this.mBody.amz_time_received};c.prototype.setAmzTimeReceived=
function(a){this.mBody.amz_time_received=a};c.prototype.getAmzSenderJID=function(){return d.isEmpty(this.mBody.amz_sender_jid)?null:new e.JID(this.mBody.amz_sender_jid)};c.prototype.setAmzSenderJID=function(a){this.mBody.amz_sender_jid=a.getJIDAsString()};c.prototype.getAmzSenderName=function(){return this.mBody.amz_sender_name};c.prototype.setAmzSenderName=function(a){this.mBody.amz_sender_name=a};c.prototype.getAmzSenderId=function(){return this.mBody.amz_sender_id};c.prototype.setAmzSenderId=function(a){this.mBody.amz_sender_id=
a};c.prototype.getAmzSenderRole=function(){return this.mBody.amz_sender_role};c.prototype.setAmzSenderRole=function(a){this.mBody.amz_sender_role=a};c.prototype.getAmzSenderLocation=function(){return this.mBody.amz_sender_location};c.prototype.getAmzSenderLocationLatitude=function(){return this.mBody.amz_sender_location.latitude};c.prototype.setAmzSenderLocationLatitude=function(a){this.mBody.amz_sender_location.latitude=a};c.prototype.getAmzSenderLocationLongitude=function(){return this.mBody.amz_sender_location.longitude};
c.prototype.setAmzSenderLocationLongitude=function(a){this.mBody.amz_sender_location.longitude=a};c.prototype.getAmzDeliveryReceipts=function(){return this.mBody.amz_delivery_receipts};c.prototype.setAmzDeliveryReceipts=function(a){this.mBody.amz_delivery_receipts=a};c.prototype.getAmzReadReceipts=function(){return this.mBody.amz_read_receipts};c.prototype.setAmzReadReceipts=function(a){this.mBody.amz_read_receipts=a};c.prototype.getAmzCustomReceipts=function(){return this.mBody.amz_custom_receipts};
c.prototype.setAmzCustomReceipts=function(a){this.mBody.amz_custom_receipts=a};c.prototype.getAmzResponsePrediction=function(){return this.mBody.amz_response_prediction};c.prototype.setAmzResponsePrediction=function(a){this.mBody.amz_response_prediction=a};c.prototype.getAmzKeepUntil=function(){return this.mBody.amz_keep_until};c.prototype.setAmzKeepUntil=function(a){this.mBody.amz_keep_until=a};c.prototype.getAmzContent=function(){return this.mBody.amz_content};c.prototype.setAmzContent=function(a){this.mBody.amz_content=
a};c.prototype.getAmzAlternateContent=function(){return this.mBody.amz_alternate_content};c.prototype.setAmzAlternateContent=function(a){this.mBody.amz_alternate_content=a};c.prototype.getAmzData=function(){return this.mBody.amz_data};c.prototype.setAmzData=function(a){this.mBody.amz_data=a};c.prototype.getAmzCaption=function(){return this.mBody.amz_caption};c.prototype.setAmzCaption=function(a){this.mBody.amz_caption=a};c.prototype.getAmzCallId=function(){return this.mBody.amz_call_id};c.prototype.setAmzCallId=
function(a){this.mBody.amz_call_id=a};c.prototype.getAmzCallData=function(){return this.mBody.amz_call_data};c.prototype.setAmzCallData=function(a){this.mBody.amz_call_data=a};c.prototype.getAmzUserData=function(){return this.mBody.amz_user_data};c.prototype.setAmzUserData=function(a){this.mBody.amz_user_data=a};c.prototype.getAmzAccept=function(){return this.mBody.amz_accept};c.prototype.setAmzAccept=function(a){this.mBody.amz_accept=a};c.prototype.getAmzSignalData=function(){return this.mBody.amz_signal_data};
c.prototype.setAmzSignalData=function(a){this.mBody.amz_signal_data=a};c.prototype.getChatStateComposing=function(){return this.composing};c.prototype.setChatStateComposing=function(a){this.composing=a};c.prototype.getChatStatePaused=function(){return this.paused};c.prototype.setChatStatePaused=function(a){this.paused=a};c.prototype.getAmzGroupInviteJID=function(){return d.isEmpty(this.mBody.amz_group_invite_jid)?null:new e.JID(this.mBody.amz_group_invite_jid)};c.prototype.setAmzGroupInviteJID=function(a){this.mBody.amz_group_invite_jid=
a.getJIDAsString()};c.prototype.getAmzGroupModifiedJID=function(){return d.isEmpty(this.mBody.amz_group_modified_jid)?null:new e.JID(this.mBody.amz_group_modified_jid)};c.prototype.setAmzGroupModifiedJID=function(a){this.mBody.amz_group_modified_jid=a.getJIDAsString()};c.prototype.getAmzIsFiltered=function(){return this.mBody.amz_is_filtered||!1};c.prototype.setAmzIsFiltered=function(a){this.mBody.amz_is_filtered=a};c.prototype.getAmzFilterDetails=function(){return this.mBody.amz_filter_details};
c.prototype.setAmzFilterDetails=function(a){this.mBody.amz_filter_details=a};c.prototype.getAmzIsReported=function(){return this.mBody.amz_is_reported||!1};c.prototype.setAmzIsReported=function(a){this.mBody.amz_is_reported=a};c.prototype.getAmzReporterDetails=function(){return this.mBody.amz_reporter_details};c.prototype.setAmzReporterDetails=function(a){this.mBody.amz_reporter_details=a};c.prototype.getAmzIsUpdated=function(){return this.mBody.amz_is_updated||!1};c.prototype.setAmzIsUpdated=function(a){this.mBody.amz_is_updated=
a};c.prototype.setAmzSenderProfile=function(a){this.mBody.amz_sender_profile=a};c.prototype.getAmzSenderProfile=function(){return this.mBody.amz_sender_profile};c.prototype.setAmzSenderPersona=function(a){this.mBody.amz_sender_persona=a};c.prototype.getAmzSenderPersona=function(){return this.mBody.amz_sender_persona};c.prototype.addAmzDeliveryReceipts=function(a){for(var c=0;c<a.length;c++)this.containsAmzDeliveryReceipt(a[c])||this.mBody.amz_delivery_receipts.push(a[c])};c.prototype.containsAmzDeliveryReceipt=
function(a){for(var c=0;c<this.mBody.amz_delivery_receipts.length;c++)if(this.mBody.amz_delivery_receipts[c].getSender().equals(a.getSender()))return!0;return!1};c.prototype.hasAmzDeliveryReceipts=function(){return!d.isEmpty(this.mBody.amz_delivery_receipts)};c.prototype.addAmzReadReceipts=function(a){for(var c=0;c<a.length;c++)this.containsAmzReadReceipt(a[c])||this.mBody.amz_read_receipts.push(a[c])};c.prototype.containsAmzReadReceipt=function(a){for(var c=0;c<this.mBody.amz_read_receipts.length;c++)if(this.mBody.amz_read_receipts[c].getSender().equals(a.getSender()))return!0;
return!1};c.prototype.hasAmzReadReceipts=function(){return!d.isEmpty(this.mBody.amz_read_receipts)};c.prototype.addAmzCustomReceipts=function(a){for(var c=0;c<a.length;c++)this.containsAmzCustomReceipt(a[c])||this.mBody.amz_custom_receipts.push(a[c])};c.prototype.containsAmzCustomReceipt=function(a){for(var c=0;c<this.mBody.amz_custom_receipts.length;c++)if(this.mBody.amz_custom_receipts[c].getSender().equals(a.getSender())&&this.mBody.amz_custom_receipts[c].getCustomType()===a.getCustomType())return!0;
return!1};c.prototype.hasAmzCustomReceipts=function(){return!d.isEmpty(this.mBody.amz_custom_receipts)};c.prototype.getShortId=function(){return"[..."+this.mID.substring(this.mID.length-5)+"]"};c.prototype.getWith=function(){var a=null;this.mFrom.equals(k.getLocalUser().getJID())?this.mTo.equals(k.getLocalUser().getJID())||(a=this.mTo):a=this.mFrom;return a};c.prototype.getSender=function(){return d.isEmpty(this.getAmzSenderJID())?this.getFrom():this.getAmzSenderJID()};c.prototype.wasSentByUs=function(){return this.mFrom.equals(k.getLocalUser().getJID())||
(new e.JID(this.mBody.amz_sender_jid)).equals(k.getLocalUser().getJID())?!0:!1};c.prototype.getAmzSortTime=function(){return 0===this.getAmzTimeServerFirstProcessed()?this.hasBeenSent()?this.getAmzTimeSent():this.getAmzTimeCreated():this.getAmzTimeServerFirstProcessed()};c.prototype.getSecondaryAmzSortTime=function(){return 0===this.getAmzTimeServerReceived()?this.hasBeenSent()?this.getAmzTimeSent():this.getAmzTimeCreated():this.getAmzTimeServerReceived()};c.prototype.getAmzDisplayTime=function(){return this.hasBeenSent()?
this.getAmzTimeSent():this.getAmzTimeCreated()};c.prototype.hasSubject=function(){return!d.isEmpty(this.mSubject)};c.prototype.hasAmzContent=function(){return!d.isEmpty(this.mBody.amz_content)};c.prototype.hasAmzAlternateContent=function(){return!d.isEmpty(this.mBody.amz_alternate_content)};c.prototype.hasBeenSent=function(){return!d.isEmpty(this.mBody.amz_time_sent)&&0!==this.mBody.amz_time_sent};c.prototype.hasBeenReceivedByServer=function(){return!d.isEmpty(this.mBody.amz_time_server_received)&&
0!==this.mBody.amz_time_server_received};c.prototype.hasBeenReceived=function(){return!d.isEmpty(this.mBody.amz_time_received)&&0!==this.mBody.amz_time_received};c.prototype.isRead=function(){var a;if(this.wasSentByUs())return!0;for(a=0;a<this.mBody.amz_read_receipts.length;a++)if(this.mBody.amz_read_receipts[a].getSender().equals(k.getLocalUser().getJID()))return!0;return!1};c.prototype.getRecipientCount=function(a){for(var c=[],d=0,e=0;e<a.length;e++){var h=a[e].getSender().getJIDAsString();-1===
c.indexOf(h)&&(c.push(h),d++)}return d};c.prototype.getMinReceiptTime=function(a){for(var c=Number.MAX_VALUE,d=0;d<a.length;d++)a[d].getTime()<c&&(c=a[d].getTime());return c};c.prototype.getAmzDeliveryReceiptJIDCount=function(){return this.getRecipientCount(this.mBody.amz_delivery_receipts)};c.prototype.getAmzDeliveryReceiptMinTime=function(){return this.getMinReceiptTime(this.mBody.amz_delivery_receipts)};c.prototype.getAmzReadReceiptJIDCount=function(){return this.getRecipientCount(this.mBody.amz_read_receipts)};
c.prototype.getAmzReadReceiptMinTime=function(){return this.getMinReceiptTime(this.mBody.amz_read_receipts)};c.prototype.addFilter=function(a,c,e){a={name:a,confidence:c};d.isEmpty(e)||(a.metadata=e);d.isEmpty(this.getAmzFilterDetails())&&this.setAmzFilterDetails([]);this.getAmzFilterDetails().push(a);this.setAmzIsFiltered(!0)};c.prototype.addReporter=function(a,c){a={reporter:a};d.isEmpty(c)||(a.metadata=c);d.isEmpty(this.getAmzReporterDetails())&&this.setAmzReporterDetails([]);this.getAmzReporterDetails().push(a);
this.setAmzIsReported(!0)};c.prototype.getAmzMarketplaceId=function(){return this.mBody.amz_marketplace_id};c.prototype.setAmzMarketplaceId=function(a){this.mBody.amz_marketplace_id=a};c.prototype.equals=function(a){return d.deepEquals(this,a)};c.prototype.toString=function(){return"Message:{id:["+this.mID+"], from:"+this.mFrom.toString()+", to:"+this.mTo.toString()+", type:["+this.mType+"], error:["+this.mError+"], subject:["+this.mSubject+"], paused:["+this.paused+"], composing:["+this.composing+
"], body:["+JSON.stringify(this.mBody)+"]}"};return{Message:c,TYPE_CHAT:"chat",TYPE_GROUPCHAT:"groupchat",TYPE_NORMAL:"normal",TYPE_ERROR:"error",AMZ_TYPE_MESSAGE:"message",AMZ_TYPE_RECEIPT:"receipt",AMZ_TYPE_CHATSTATE:"chatstate",AMZ_TYPE_GROUP_MODIFIED:"group_modified",AMZ_TYPE_SIGNAL:"signal",AMZ_TYPE_CAPTION:"caption",AMZ_TYPE_GROUP_INVITE:"group_invite",AMZ_TYPE_GROUP_INVITE_DECLINE:"group_invite_decline",AMZ_TYPE_DATA:"data",AMZ_SUBTYPE_MESSAGE_TEXT:"text",AMZ_SUBTYPE_MESSAGE_VIDEOCALL:"videocall",
AMZ_SUBTYPE_MESSAGE_VOICEMAIL:"voicemail",AMZ_SUBTYPE_RECEIPT_DELIVERY:"delivery",AMZ_SUBTYPE_RECEIPT_READ:"read",AMZ_SUBTYPE_RECEIPT_CUSTOM:"custom",AMZ_SUBTYPE_JID_ADDED:"jid_added",AMZ_SUBTYPE_JID_REMOVED:"jid_removed",AMZ_SUBTYPE_SIGNAL_INVITE:"invite",AMZ_SUBTYPE_SIGNAL_ACK:"ack",AMZ_SUBTYPE_SIGNAL_BYE:"bye",AMZ_SUBTYPE_SIGNAL_OFFER:"offer",AMZ_SUBTYPE_SIGNAL_MCU_INFO:"mcuInfo",AMZ_SUBTYPE_SIGNAL_CANDIDATE:"candidate",AMZ_SUBTYPE_SIGNAL_ANSWER:"answer",AMZ_SUBTYPE_DATA_OBJECT_ARCHIVABLE:"data_object_archivable",
AMZ_SUBTYPE_DATA_OBJECT_NON_ARCHIVABLE:"data_object_non_archivable",CHAT_STATE_COMPOSING:"composing",CHAT_STATE_PAUSED:"paused",createFromJSONString:function(a){a=JSON.parse(a);var d=new c;d.setID(a.id);d.setAck(a.ack);d.setError(a.error);d.setFrom(new e.JID(a.from));d.setTo(new e.JID(a.to));d.setType(a.type);d.setBody(a.body);d.setSubject(a.subject);d.setChatStateComposing(a.composing);d.setChatStatePaused(a.paused);return d},createFromNode:function(a){var d=new c;d.setID(a.getAttribute("id"));d.setAck(a.getAttribute("amz_ack"));
d.setFrom(new e.JID(a.getAttribute("from")));d.setTo(new e.JID(a.getAttribute("to")));d.setType("chat");a=a.getElementsByTagName("body")[0];d.setBody(JSON.parse(a.textContent));return d},createChatMessageObject:function(a,d,e,k){var h=new c;h.setID(a);h.setFrom(d);h.setTo(e);d.isGroupJID()||e.isGroupJID()?h.setType("groupchat"):h.setType("chat");h.setBody(JSON.parse(k));return h},convertMessageToJSONObject:function(a){return{id:a.getID(),ack:a.getAck(),error:a.getError(),from:a.getFrom().getJIDAsString(),
to:a.getTo().getJIDAsString(),type:a.getType(),subject:a.getSubject(),body:a.getBody(),paused:a.getChatStatePaused(),composing:a.getChatStateComposing()}}}});t.when("AmazonComm/messaging/message_class").execute(function(e){v["AmazonComm/messaging/message_class"]=e});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/utils/common","3p-JSJaC").register("AmazonComm/messaging/presence_class",function(e,l,f,d){var n=Object.freeze({AVAILABLE:"available",ERROR:"error",PROBE:"probe",
SUBSCRIBE:"subscribe",SUBSCRIBED:"subscribed",UNAVAILABLE:"unavailable",UNSUBSCRIBE:"unsubscribe",UNSUBSCRIBED:"unsubscribed"}),k=Object.freeze({AWAY:"away",CHAT:"chat",DO_NOT_DISTURB:"dnd",EXTENDED_AWAY:"xa",ONLINE:"online"});e=Object.freeze({ROOM_OCCUPANT:"110",ROOM_LOGGING_ENABLED:"170",ROOM_CREATED:"201",PERSON_NICK_MODIFIED:"210",BANNED_FROM_ROOM:"301",ROOM_NICK_MODIFIED:"303",KICKED_FROM_ROOM:"307",AFFILIATION_CHANGED:"321",MEMBERS_ONLY:"322",SHUTDOWN:"332"});l=Object.freeze({ACTIVATED:"ACTIVATED",
DEACTIVATED:"DEACTIVATED"});var c=n.AVAILABLE;d=function(){this.mID=f.createUUID(f.TAG_PRESENCE);this.mTo=this.mFrom=null;this.mType=c;this.mShow=k.ONLINE;this.mPriority=this.mStatus=this.mError=this.mMucPresence=null;this.mHasReachableAddress=!1;this.mChatability=this.mSenderCustomerId=this.mSenderName=null};var a=function(){this.mStatusCodes=[];this.mItems=[];this.mRoomStatus=null},m=function(){this.mReason=this.mActor=this.mJID=this.mAffiliation=this.mRole=this.mNick=null};d.prototype.getID=function(){return this.mID};
d.prototype.setID=function(a){this.mID=a};d.prototype.getFrom=function(){return this.mFrom};d.prototype.setFrom=function(a){this.mFrom=a};d.prototype.getTo=function(){return this.mTo};d.prototype.setTo=function(a){this.mTo=a};d.prototype.getType=function(){return this.mType};d.prototype.setType=function(a){this.mType=a};d.prototype.isError=function(){return this.mType===n.ERROR};d.prototype.getError=function(){return this.mError};d.prototype.setError=function(a){this.mError=a};d.prototype.getShow=
function(){return this.mShow};d.prototype.setShow=function(a){this.mShow=a};d.prototype.getStatus=function(){return this.mStatus};d.prototype.setStatus=function(a){this.mStatus=a};d.prototype.hasRoomPresence=function(){return!f.isEmpty(this.mMucPresence)};d.prototype.getRoomPresence=function(){return this.mMucPresence};d.prototype.setRoomPresence=function(a){this.mMucPresence=a};d.prototype.getPriority=function(){return this.mPriority};d.prototype.setPriority=function(a){this.mPriority=a};d.prototype.hasReachableAddress=
function(){return this.mHasReachableAddress};d.prototype.setHasReachableAddress=function(a){this.mHasReachableAddress=a};d.prototype.getChatability=function(){return this.mChatability};d.prototype.setChatability=function(a){this.mChatability=a};d.prototype.getSenderName=function(){return this.mSenderName};d.prototype.setSenderName=function(a){this.mSenderName=a};d.prototype.getSenderCustomerId=function(){return this.mSenderCustomerId};d.prototype.setSenderCustomerId=function(a){this.mSenderCustomerId=
a};d.prototype.equals=function(a){return f.deepEquals(this,a)};d.prototype.toString=function(){return"Presence:{ID:["+this.mID+"], from:"+this.mFrom.toString()+", to:"+this.mTo.toString()+", type:["+this.mType+"], show:["+this.mShow+"], status:["+this.mStatus+"], muc:["+this.hasRoomPresence()+"], error:["+this.mError+"], priority:["+this.mPriority+"]}"};a.prototype.getStatusCodes=function(){return this.mStatusCodes};a.prototype.setStatusCodes=function(a){this.mStatusCodes=a};a.prototype.getRoomStatus=
function(){return this.mRoomStatus};a.prototype.setRoomStatus=function(a){this.mRoomStatus=a};a.prototype.getItems=function(){return this.mItems};a.prototype.setItems=function(a){this.mItems=a};m.prototype.getNick=function(){return this.mNick};m.prototype.setNick=function(a){this.mNick=a};m.prototype.getRole=function(){return this.mRole};m.prototype.setRole=function(a){this.mRole=a};m.prototype.getAffiliation=function(){return this.mAffiliation};m.prototype.setAffiliation=function(a){this.mAffiliation=
a};m.prototype.getJID=function(){return this.mJID};m.prototype.setJID=function(a){this.mJID=a};m.prototype.getActor=function(){return this.mActor};m.prototype.setActor=function(a){this.mActor=a};m.prototype.getReason=function(){return this.mReason};m.prototype.setReason=function(a){this.mReason=a};return{PresenceType:n,ShowState:k,MucPresenceStatusCode:e,Presence:d,MucPresence:a,MucPresenceItem:m,MucRoomStatus:l,isValidPresenceType:function(a){a:{for(var c in n)if(n[c]===a){a=!0;break a}a=!1}return a}}});
t.when("AmazonComm/messaging/presence_class").execute(function(e){v["AmazonComm/messaging/presence_class"]=e});t.when("AmazonComm/messaging/presence_class","AmazonComm/messaging/jsjac/connection","AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/global_state","AmazonComm/utils/location","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/presence_manager",function(e,l,f,d,n,k,c,a){function m(b,a){e.isValidPresenceType(b)&&!d.isEmpty(a)&&l.addPresenceHandler(b,
{onPresence:function(b){a(b)}})}function q(){b=0;u()}function u(){if(!d.isEmpty(n.getLocalUser().getJID()))if(0!==b)c.l("presence_manager","we are already waiting to send a presence update");else{var e=Date.now()-g;if(1E4>e)e=1E4-e,c.l("presence_manager","we will wait "+e+"ms to send presence update"),b=setTimeout(q,e);else{var k=n.getLocalUser().getJID().getJIDAsString(),m=new a.JSJaCPresence,u=f.appendNodeWithAttribute(m,m,"device","xmlns","urn:xmpp:amazon:device:attributes");f.appendNodeWithAttributeAndText(m,
u,"json","xmlns","urn:xmpp:json:0",JSON.stringify(h));m.setFrom(k);0===g?c.l("presence_manager","this is the first presence update - sending presence"):c.l("presence_manager","it has been "+e+"ms since the last presence update - sending presence");g=Date.now();l.sendPacket(m)}}}var h={},g=0,b=0;return{subscribe:function(b,a){m(b,a)},sendBatteryInfo:function(b){h.battery=b;u()},sendBluetoothInfo:function(b){h.bluetooth=b;u()},sendLocationInfo:function(b){k.isSignificantLocationChange(h.location,b)&&
(h.location=b,u())},sendForegroundAppInfo:function(b){h.foregroundApp=b;u()},sendAttributes:function(){u()},setLastPresenceSentTime:function(b){g=b},getPresenceSendTimeout:function(){return b}}});t.when("AmazonComm/messaging/presence_manager").execute(function(e){v["AmazonComm/messaging/presence_manager"]=e});t.when("AmazonComm/common/jid_class","AmazonComm/utils/common").register("AmazonComm/messaging/receipt_class",function(e,l){var f=function(d){this.mLocation={};l.isEmpty(d)||(d instanceof f?
this.mSender=d.mSender:l.isEmpty(d.mSender)||(this.mSender=new e.JID(d.mSender.mJIDString)),this.mCustomType=d.mCustomType,this.mTime=d.mTime,l.isEmpty(d.mLocation)||(this.mLocation.latitude=d.mLocation.latitude,this.mLocation.longitude=d.mLocation.longitude))};f.prototype.getSender=function(){return this.mSender};f.prototype.setSender=function(d){this.mSender=d};f.prototype.getTime=function(){return this.mTime};f.prototype.setTime=function(d){this.mTime=d};f.prototype.getCustomType=function(){return this.mCustomType};
f.prototype.setCustomType=function(d){this.mCustomType=d};f.prototype.getLatitude=function(){return this.mLocation.latitude};f.prototype.setLatitude=function(d){this.mLocation.latitude=d};f.prototype.getLongitude=function(){return this.mLocation.longitude};f.prototype.setLongitude=function(d){this.mLocation.longitude=d};f.prototype.toString=function(){return"receipt type: "+this.mType+"sender: "+this.mSender.toString()+", customType: "+this.mCustomType+", time: "+this.mTime+", location: "+this.mLocation.latitude+
", "+this.mLocation.longitude};f.prototype.equals=function(d){return l.deepEquals(this,d)};return{Receipt:f}});t.when("AmazonComm/messaging/receipt_class").execute(function(e){v["AmazonComm/messaging/receipt_class"]=e});t.register("AmazonComm/messaging/chatroom/association_class",function(){var e=Object.freeze({NONE:"none",VISITOR:"visitor",PARTICIPANT:"participant",MODERATOR:"moderator"}),l=Object.freeze({NONE:"none",OUTCAST:"outcast",MEMBER:"member",ADMIN:"admin",OWNER:"owner"}),f=function(d,e){this.mRole=
d;this.mAffiliation=e};f.prototype.getRole=function(){return this.mRole};f.prototype.getAffiliation=function(){return this.mAffiliation};f.prototype.equals=function(d){return this.mRole===d.getRole()&&this.mAffiliation===d.getAffiliation()};return{Role:e,Affiliation:l,Association:f}});t.when("AmazonComm/common/chatroom_class","AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/chatroom/association_class","AmazonComm/messaging/chatroom/chat_room_user_class","AmazonComm/messaging/jsjac/connection",
"AmazonComm/messaging/jsjac/node_utils","AmazonComm/messaging/jsjac/packet_converter","AmazonComm/messaging/message_class","AmazonComm/messaging/presence_class","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/chatroom/chat_room_manager",function(e,l,f,d,n,k,c,a,m,q,u,h,g,b,p,r,w){function t(b){r.l("chat_room_manager","discovering rooms");
var a=new w.JSJaCIQ;a.setIQ(g.getMUCDomain(),"get",h.createUUID(h.TAG_IQ));a.setQuery("http://jabber.org/protocol/disco#items");k.sendPacket(a,!1,function(a){a=a.getQuery().getElementsByTagName("item");r.l("chat_room_manager","discovered "+a.length+" rooms");for(var c,d,g=[],k=0;k<a.length;k++)c=a.item(k),d=new l.JID(c.getAttribute("jid")),c=c.getAttribute("name"),d=new e.ChatRoom(d,c),g.push(d);if(!h.isEmpty(b))b.onDiscovered({chatrooms:g})})}function v(b,a){r.l("chat_room_manager","searching for rooms containing ["+
b+"]");var c=new w.JSJaCIQ;c.setIQ(g.getMUCDomain(),"set",h.createUUID(h.TAG_IQ));var d=c.setQuery("jabber:iq:search"),p=c.buildNode("x",{xmlns:"jabber:x:data",type:"submit"}),f=c.buildNode("field");f.setAttribute("type","hidden");f.setAttribute("var","FORM_TYPE");var n=c.buildNode("value");n.textContent="jabber:iq:search";f.appendChild(n);p.appendChild(f);f=c.buildNode("field");f.setAttribute("var","name");n=c.buildNode("value");n.textContent=b;f.appendChild(n);p.appendChild(f);d.appendChild(p);
k.sendPacket(c,!1,function(b){b=b.getQuery().getElementsByTagName("item");r.l("chat_room_manager","search returned "+b.length+" rooms");for(var c=null,d=null,g=[],k=0;k<b.length;k++){for(var p=b.item(k).getElementsByTagName("field"),f=0;f<p.length;f++){var n=p.item(f),ia=n.getAttribute("var");"name"===ia?d=n.firstChild.textContent:"jid"===ia&&(c=new l.JID(n.firstChild.textContent))}g.push(new e.ChatRoom(c,d))}if(!h.isEmpty(a))a.onResults({chatrooms:g})})}function H(b,a){r.l("chat_room_manager","querying for room info for ["+
b.toString()+"]");var c=new w.JSJaCIQ;c.setIQ(b.getJID().getJIDAsString(),"get",h.createUUID(h.TAG_IQ));c.setQuery("http://jabber.org/protocol/disco#info");k.sendPacket(c,!1,function(b){var c={},h=b.getQuery();b=b.getChild("identity");c.name=b.getAttribute("name");h=h.getElementsByTagName("field");for(b=0;b<h.length;b++){var d=h.item(b),g=d.getAttribute("var");"muc#roominfo_description"===g?c.description=d.firstChild.textContent:"muc#roominfo_occupants"===g?c.numUsers=Number(d.firstChild.textContent):
"muc#roominfo_membercount"===g?c.numMembers=Number(d.firstChild.textContent):"muc#roominfo_admincount"===g?c.numAdmins=Number(d.firstChild.textContent):"muc#roominfo_ownercount"===g&&(c.numOwners=Number(d.firstChild.textContent))}a(c)})}function E(a,g){r.l("chat_room_manager","querying for room member list for ["+a.toString()+"]");var e=new w.JSJaCIQ;e.setIQ(a.getJID().getJIDAsString(),"get",h.createUUID(h.TAG_IQ));a=e.setQuery("http://jabber.org/protocol/muc#admin");var p=e.buildNode("item",{affiliation:d.Affiliation.MEMBER});
a.appendChild(p);if(!k.sendPacket(e,!1,function(b){if(b.isError()){var a=c.getCampfireErrorFromPacket(b);r.error("chat_room_manager","error when getting members from room",a);if(!h.isEmpty(g))g.onError(a)}else{a=[];b=b.getQuery().getElementsByTagName("item");for(var e=0;e<b.length;e++){var k=b.item(e),p=k.getAttribute("jid"),m=k.getAttribute("nick"),k=k.getAttribute("role");h.isEmpty(k)&&(k=d.Role.NONE);var q;try{q=f.Person.fromJSONObject(JSON.parse(h.base32ToString(m.toUpperCase())))}catch(w){try{q=
f.Person.fromJSONObject(JSON.parse(h.base64ToString(m)))}catch(W){q=new f.Person(new l.JID(p))}}p=new d.Association(k,d.Affiliation.Member);p=new n.ChatRoomUser(q,p);a.push(p)}if(!h.isEmpty(g))g.onGetMemberListSuccess(a)}})&&(r.e("chat_room_manager","failed to get members list"),!h.isEmpty(g)))g.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_GET_MEMBERS_LIST,description:"failed to get members list"})}function I(a,c,d){r.l("chat_room_manager","joining room "+a.toString());var g=u.createMetricEvent("ChatRoomManager",
u.AGGREGATING_EVENT);u.startTimer(g,"JoinRoom.RequestTimer");var f=new w.JSJaCPresence,l=e.ChatRoom.getLocalUserNickname(),n=a.getJID().getJIDAsString();f.setTo(n+"/"+l);l=f.buildNode("x",{xmlns:"http://jabber.org/protocol/muc"});if(!h.isEmpty(d)){var m=f.buildNode("history"),K=!1;h.isEmpty(d.maxMessages)||(r.l("chat_room_manager","  maxstanzas\x3d"+d.maxMessages),m.setAttribute("maxstanzas",d.maxMessages),K=!0);h.isEmpty(d.seconds)||(r.l("chat_room_manager","  seconds\x3d"+d.seconds),m.setAttribute("seconds",
d.seconds),K=!0);h.isEmpty(d.since)||isNaN(d.since.getTime())||(r.l("chat_room_manager","  messages since\x3d"+d.since),m.setAttribute("since",d.since.toISOString()),K=!0);K&&l.appendChild(m)}f.appendNode(l);T[n]=function(b){if(b.isError()){u.stopTimer(g,"JoinRoom.RequestTimer");u.incrementCounter(g,"JoinRoom.RequestErrorCount");u.recordMetricEvent(g);b=b.getError();r.error("chat_room_manager","error joining room",b);if(!h.isEmpty(c))c.onError(b);delete T[n]}else{if(b.getRoomPresence().getItems()[0].getJID().isEqualsFullJID(p.getLocalUserFullJID())&&
q.PresenceType.AVAILABLE===b.getType()&&(u.stopTimer(g,"JoinRoom.RequestTimer"),u.incrementCounter(g,"JoinRoom.RequestSuccessCount"),u.recordMetricEvent(g),!h.isEmpty(c)))c.onJoined({presence:b});a.onPresenceReceived(b)}};if(!k.sendPacket(f)&&(u.stopTimer(g,"JoinRoom.RequestTimer"),u.incrementCounter(g,"JoinRoom.RequestErrorCount"),u.recordMetricEvent(g),delete T[n],!h.isEmpty(c)))c.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_JOIN_ROOM,description:"failed to join room"})}function C(a,d,g){r.l("chat_room_manager",
"requesting registration with room ["+a.toString()+"]");var e=a.getJID().getJIDAsString();a=new w.JSJaCIQ;a.setIQ(e,"get",h.createUUID(h.TAG_IQ));a.setQuery("jabber:iq:register");if(!k.sendPacket(a,!1,function(b){if(b.isError()){if(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error registering with room",b),!h.isEmpty(g))g.onError(b)}else if(h.isEmpty(b.getChild("registered")))z(e,d,g);else if(b=b.getChild("username").textContent,r.l("chat_room_manager","user already registered with nickname: ["+
b+"]"),!h.isEmpty(g))g.onRegistered({nickname:b,newRegistration:!1})})&&(r.e("chat_room_manager","failed to send registration requirements request"),!h.isEmpty(g)))g.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_REGISTER_WITH_ROOM,description:"failed to send registration requirements request"})}function z(a,d,g){var e=new w.JSJaCIQ;e.setIQ(a,"set",h.createUUID(h.TAG_IQ));a=e.setQuery("jabber:iq:register");var p=e.buildNode("x",{xmlns:"jabber:x:data",type:"submit"}),f=c.appendNodeWithAttribute(e,
p,"field","var","FORM_TYPE");c.appendNodeWithText(e,f,"value","http://jabber.org/protocol/muc#register");f=c.appendNodeWithAttribute(e,p,"field","var","muc#register_roomnick");c.appendNodeWithText(e,f,"value",d);a.appendChild(p);if(!k.sendPacket(e,!1,function(b){if(b.isError()){if(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error registering with room",b),!h.isEmpty(g))g.onError(b)}else if(r.l("chat_room_manager","registered successfully with room using nickname: ["+d+"]"),!h.isEmpty(g))g.onRegistered({nickname:d,
newRegistration:!0})})&&(r.e("chat_room_manager","failed to submit room registration request"),!h.isEmpty(g)))g.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_REGISTER_WITH_ROOM,description:"failed to submit room registration request"})}function y(a,d){r.l("chat_room_manager","requesting to remove registration from room: ["+a.toString()+"]");var g=new w.JSJaCIQ;g.setIQ(a.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));a=g.setQuery("jabber:iq:register");c.appendNode(g,a,"remove");if(!k.sendPacket(g,
!1,function(b){if(b.isError()){if(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error removing room registration",b),!h.isEmpty(d))d.onError(b)}else if(r.l("chat_room_manager","removed room registration"),!h.isEmpty(d))d.onRegistrationRemoved()})&&(r.e("chat_room_manager","failed to send request to remove room registration"),!h.isEmpty(d)))d.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_REMOVE_REGISTRATION,description:"failed to send request to remove room registration"})}function B(a,
d){r.l("chat_room_manager","enable mute notification for room ["+a.toString()+"]");var g=new w.JSJaCIQ;g.setIQ(a.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));a=g.setQuery("jabber:iq:amazon-mute-notification");c.appendNodeWithAttribute(g,a,"action","name","add");if(!k.sendPacket(g,!1,function(b){if(b.isError()){if(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error when enable mute room notification",b),!h.isEmpty(d))d.onError(b)}else if(r.l("chat_room_manager","enable mute room notification success"),
!h.isEmpty(d))d.onEnableMuteRoomNotificationSuccess()})&&(r.e("chat_room_manager","failed to enable mute room notification"),!h.isEmpty(d)))d.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_ENABLE_MUTE_NOTIFICATION,description:"failed to enable mute room notification"})}function Q(a,d){r.l("chat_room_manager","unMute notification for room ["+a.toString()+"]");var g=new w.JSJaCIQ;g.setIQ(a.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));a=g.setQuery("jabber:iq:amazon-mute-notification");c.appendNodeWithAttribute(g,
a,"action","name","remove");if(!k.sendPacket(g,!1,function(b){if(b.isError()){if(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error when disable mute room notification",b),!h.isEmpty(d))d.onError(b)}else if(r.l("chat_room_manager","disable mute room notification success"),!h.isEmpty(d))d.onDisableMuteRoomNotificationSuccess()})&&(r.e("chat_room_manager","failed to disable mute room notification"),!h.isEmpty(d)))d.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_DISABLE_MUTE_NOTIFICATION,
description:"failed to disable mute room notification"})}function G(a,d){var g=new w.JSJaCIQ;g.setIQ(a.getJID().getJIDAsString(),"get",h.createUUID(h.TAG_IQ));g.setQuery("jabber:iq:amazon-mute-notification");if(!k.sendPacket(g,!1,function(b){if(b.isError()){if(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error when getting mute notification state",b),!h.isEmpty(d))d.onError(b)}else if(b=b.getQuery().getElementsByTagName("item").item(0).getAttribute("mute-notification-status"),b=
"true"===b,r.l("chat_room_manager","successfully got mute notificaiton state. chatroom: ["+a.toString()+"] mute notification status: ["+b+"]"),!h.isEmpty(d))d.onGetMuteRoomNotificationStatusSuccess(b)})&&(r.e("chat_room_manager","Failed to get mute notification state"),!h.isEmpty(d)))d.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_GET_MUTE_NOTIFICATION_STATE,description:"Failed to get mute notification state"})}function P(b,a,c,d){c=b.buildNode("field",{"var":c});if(Array.isArray(d))for(var g=
0;g<d.length;g++){var h=b.buildNode("value");h.textContent=d[g];c.appendChild(h)}else h=b.buildNode("value"),h.textContent=d,c.appendChild(h);a.appendChild(c)}function N(a,c,d){var p=u.createMetricEvent("ChatRoomManager",u.AGGREGATING_EVENT);if(h.isEmpty(a)||h.isEmpty(a.name)){if(r.l("chat_room_manager","Error in creating room, incorrect input."),u.incrementCounter(p,"CreateRoom.InvalidParametersErrorCount"),u.recordMetricEvent(p),!h.isEmpty(c))c.onError({code:b.CHAT_ROOM_ERRORS.ERROR_INVALID_PARAMETER,
description:"Invalid request parameters. Failed to create room"})}else{u.startTimer(p,"CreateRoom.RequestTimer");var f=h.createUUID(h.TAG_ROOM),n=new l.JID(f,g.getMUCDomain()),m=new e.ChatRoom(n,a.name);m.registerAssociationChangeObserver(a.associationChangeObserver);R=n.getJIDAsString();r.l("chat_room_manager","creating room "+m.toString());I(m,{onJoined:function(){var g=new w.JSJaCIQ;g.setIQ(n.getJIDAsString(),"set",h.createUUID(h.TAG_IQ));var e=g.setQuery("http://jabber.org/protocol/muc#owner"),
f=g.buildNode("x",{xmlns:"jabber:x:data",type:"submit"});P(g,f,D.FORM_TYPE,"http://jabber.org/protocol/muc#roomconfig");P(g,f,D.ROOM_DESC,a.description);P(g,f,D.ROOM_NAME,m.getName());h.isEmpty(d)&&(d=new S);for(var r in D)d.hasOwnProperty(r)&&P(g,f,D[r],d[r]);e.appendChild(f);if(!k.sendPacket(g,!1,function(b){u.stopTimer(p,"CreateRoom.RequestTimer");u.incrementCounter(p,"CreateRoom.RequestSuccessCount");u.recordMetricEvent(p);if(!h.isEmpty(c))c.onCreated({chatroom:m})})&&(u.stopTimer(p,"CreateRoom.RequestTimer"),
u.incrementCounter(p,"CreateRoom.RequestErrorCount"),u.recordMetricEvent(p),!h.isEmpty(c)))c.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_CREATE_ROOM,description:"failed to create room"})},onError:function(b){u.stopTimer(p,"CreateRoom.RequestTimer");u.incrementCounter(p,"CreateRoom.RequestErrorCount");u.recordMetricEvent(p);if(!h.isEmpty(c))c.onError(b)}})}}function L(a,d){var g=a.roomJID.getJIDAsString(),e=a.inviteeJID.getJIDAsString();a=a.reason;r.l("chat_room_manager","inviting ["+e+"] to room + ["+
g+"]");var p=new w.JSJaCMessage;p.setID(h.createUUID(h.TAG_MESSAGE));p.setTo(g);g=c.appendNodeWithAttribute(p,p,"x","xmlns","http://jabber.org/protocol/muc#user");e=c.appendNodeWithAttribute(p,g,"invite","to",e);h.isEmpty(a)||c.appendNodeWithText(p,e,"reason",a);if(k.sendPacket(p,!1,function(b){if(b.isError()&&(b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error sending invitation",b),!h.isEmpty(d)))d.onError(b)})){if(r.l("chat_room_manager","invitation message sent to service"),
!h.isEmpty(d))d.onInvitationSent()}else if(e={code:b.GENERIC_ERRORS.ERROR_UNKNOWN,description:"error sending invitation message to service"},r.error("chat_room_manager","error sending invitation",e),!h.isEmpty(d))d.onError(e)}function X(a,g,e,p){if(e!==d.Role.MODERATOR&&e!==d.Role.NONE&&e!==d.Role.PARTICIPANT&&e!==d.Role.VISITOR)r.e("chat_room_manager","invalid role ["+e+"]"),p.onError({code:b.CHAT_ROOM_ERRORS.ERROR_INVALID_PARAMETER,description:"invalid role"});else{r.l("chat_room_manager","setting role to ["+
e+"] for nick ["+g+"] in room "+a.toString());var f=new w.JSJaCIQ;f.setIQ(a.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));a=f.setQuery("http://jabber.org/protocol/muc#admin");g=f.buildNode("item",{nick:g,role:e});a.appendChild(g);if(!k.sendPacket(f,!1,function(b){if(b.isError())b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error setting role",b),p.onError(b);else p.onSetRoleSuccess()}))p.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_SET_ROLE,description:"failed to set role"})}}
function K(a,g,e,p){if(e!==d.Affiliation.OWNER&&e!==d.Affiliation.ADMIN&&e!==d.Affiliation.MEMBER&&e!==d.Affiliation.OUTCAST&&e!==d.Affiliation.NONE)r.e("chat_room_manager","invalid affiliation ["+e+"]"),p.onError({code:b.CHAT_ROOM_ERRORS.ERROR_INVALID_PARAMETER,description:"invalid affiliation"});else{r.l("chat_room_manager","setting affiliation to ["+e+"] for JID ["+g.toString()+"] in room "+a.toString());var f=new w.JSJaCIQ;f.setIQ(a.getJID().getJIDAsString(),"set",h.createUUID(h.TAG_IQ));a=f.setQuery("http://jabber.org/protocol/muc#admin");
e=f.buildNode("item",{jid:g.getJIDAsString(),affiliation:e});a.appendChild(e);if(!k.sendPacket(f,!1,function(b){if(b.isError())b=c.getCampfireErrorFromPacket(b),r.error("chat_room_manager","error setting affiliation",b),p.onError(b);else p.onSetAffiliationSuccess(g)}))p.onError({code:b.CHAT_ROOM_ERRORS.ERROR_FAILED_TO_SET_AFFILIATION,description:"failed to set affiliation"})}}var D={FORM_TYPE:"FORM_TYPE",ALLOW_INVITES:"muc#roomconfig_allowinvites",AUTO_MODERATOR_ID:"muc#amzroomconfig_automoderatorid",
CAN_CHANGE_NICK:"x-muc#roomconfig_canchangenick",CHANGE_SUBJECT:"muc#roomconfig_changesubject",ENABLE_LOGGING:"muc#roomconfig_enablelogging",MAX_USERS:"muc#roomconfig_maxusers",MEMBERS_ONLY:"muc#roomconfig_membersonly",MODERATED_ROOM:"muc#roomconfig_moderatedroom",ROOM_OWNERS:"muc#roomconfig_roomowners",PASSWORD_PROTECTED_ROOM:"muc#roomconfig_passwordprotectedroom",PERSISTENT_ROOM:"muc#roomconfig_persistentroom",PRESENCE_BROADCAST:"muc#roomconfig_presencebroadcast",PUBLIC_ROOM:"muc#roomconfig_publicroom",
PUSH_NOTIFICATION_CONTROLLER_ID:"muc#amzroomconfig_pushnotificationcontrollerid",REGISTRATION:"x-muc#roomconfig_registration",RESERVED_NICK:"x-muc#roomconfig_reservednick",ROOM_DESC:"muc#roomconfig_roomdesc",ROOM_NAME:"muc#roomconfig_roomname",WHOIS:"muc#roomconfig_whois"},F={FALSE:"0",TRUE:"1",ANYONE:"anyone",MODERATOR:"moderator",MODERATORS:"moderators",NONE:"none",PARTICIPANT:"participant",VISITOR:"visitor"},S=function(){return{ALLOW_INVITES:F.FALSE,CAN_CHANGE_NICK:F.FALSE,CHANGE_SUBJECT:F.FALSE,
ENABLE_LOGGING:F.TRUE,MAX_USERS:F.FALSE,MEMBERS_ONLY:F.FALSE,MODERATED_ROOM:F.FALSE,PASSWORD_PROTECTED_ROOM:F.FALSE,PRESENCE_BROADCAST:[],PERSISTENT_ROOM:F.TRUE,PUBLIC_ROOM:F.TRUE,REGISTRATION:F.FALSE,RESERVED_NICK:F.FALSE,WHOIS:F.ANYONE}},T={},A=[],x=[],R="";a=function(b){if((b.hasRoomPresence()||b.isError())&&!h.isEmpty(b.getFrom())){var a=b.getFrom().getBareJID(),a=T[a];h.isEmpty(a)||a(b)}};k.addPresenceHandler(q.PresenceType.AVAILABLE,{onPresence:a});k.addPresenceHandler(q.PresenceType.ERROR,
{onPresence:a});k.addPresenceHandler(q.PresenceType.UNAVAILABLE,{onPresence:a});k.addMessageHandler(m.AMZ_TYPE_GROUP_INVITE,{onMessage:function(b){var a={};a.roomJID=b.getAmzGroupInviteJID();a.senderJID=b.getAmzSenderJID();a.reason=b.getAmzContent();for(b=0;b<A.length;b++)A[b].onNewInvite(a)}});k.addMessageHandler(m.AMZ_TYPE_GROUP_INVITE_DECLINE,{onMessage:function(b){var a={};a.roomJID=b.getAmzGroupInviteJID();a.senderJID=b.getAmzSenderJID();a.reason=b.getAmzContent();for(b=0;b<x.length;b++)x[b].onInviteDeclined(a)}});
return{MUC_CONFIG_VALUES:F,ChatRoomConfig:S,createRoom:function(b,a,c){N(b,a,c)},joinRoom:function(b,a,c){I(b,a,c)},leaveRoom:function(b){r.l("chat_room_manager","leaving room "+b.toString());var a=new w.JSJaCPresence,c=b.getJID().getJIDAsString()+"/"+e.ChatRoom.getLocalUserNickname();a.setTo(c);a.setType("unavailable");k.sendPacket(a);delete T[b.getJID().getJIDAsString()];b.onLeaveRoom()},getRoomInfo:function(b,a){H(b,a)},getRoomMemberList:function(b,a){E(b,a)},registerWithRoom:function(b,a,c){C(b,
a,c)},removeRoomRegistration:function(b,a){y(b,a)},enableMuteRoomNotification:function(b,a){B(b,a)},disableMuteRoomNotification:function(b,a){Q(b,a)},getMuteRoomNotificationStatus:function(b,a){G(b,a)},discoverRooms:function(b){t(b)},searchRooms:function(b,a){return v(b,a)},requestVoiceInRoom:function(b){r.l("chat_room_manager","requesting voice in room "+b.toString());var a=new w.JSJaCMessage;a.setID(h.createUUID(h.TAG_MESSAGE));a.setTo(b.getJID().getJIDAsString());b=a.buildNode("x",{xmlns:"jabber:x:data",
type:"submit"});var c=a.buildNode("field",{"var":"FORM_TYPE"}),e=a.buildNode("value");e.textContent="http://jabber.org/protocol/muc#request";c.appendChild(e);b.appendChild(c);c=a.buildNode("field",{"var":"muc#role",type:"text-single",label:"Requested role"});e=a.buildNode("value");e.textContent=d.Role.PARTICIPANT;c.appendChild(e);b.appendChild(c);c=p.getAuthCredentialData();if(!h.isEmpty(c)){var e=a.buildNode("field",{"var":"amznAuth#authStatus",type:"text-single"}),f=a.buildNode("value");f.textContent=
c.authStatus;e.appendChild(f);b.appendChild(e);e=a.buildNode("field",{"var":"amznAuth#authStatusSignature",type:"text-single"});f=a.buildNode("value");f.textContent=c.authStatusSignature;e.appendChild(f);b.appendChild(e);g.useCognitoAuth()?(e=a.buildNode("field",{"var":"amznAuth#cognitoToken",type:"text-single"}),f=a.buildNode("value"),f.textContent=c.cognitoToken):(e=a.buildNode("field",{"var":"amznAuth#authStatusTimestamp",type:"text-single"}),f=a.buildNode("value"),f.textContent=c.authStatusTimestamp);
e.appendChild(f);b.appendChild(e)}a.appendNode(b);k.sendPacket(a)},inviteToRoom:function(b,a){L(b,a)},declineRoomInvitation:function(b){var a=b.roomJID.getJIDAsString(),d=b.inviterJID.getJIDAsString();b=b.reason;r.l("chat_room_manager","declining invitation from ["+d+"] to join room + ["+a+"]");var g=new w.JSJaCMessage;g.setID(h.createUUID(h.TAG_MESSAGE));g.setTo(a);a=c.appendNodeWithAttribute(g,g,"x","xmlns","http://jabber.org/protocol/muc#user");d=c.appendNodeWithAttribute(g,a,"decline","to",d);
h.isEmpty(b)||c.appendNodeWithText(g,d,"reason",b);k.sendPacket(g)},registerRoomInvitationHandler:function(b){h.isEmpty(b)||-1!==A.indexOf(b)||A.push(b)},registerDeclinedInvitationHandler:function(b){h.isEmpty(b)||-1!==x.indexOf(b)||x.push(b)},setRoleInRoom:function(b,a,c,g){X(b,a,c,g)},setAffiliationInRoom:function(b,a,c,g){K(b,a,c,g)},getInvitationHandlersLength:function(){return A.length},getDeclinedInvitationHandlersLength:function(){return x.length},getCreateRoomJIDString:function(){return R}}});
t.when("AmazonComm/messaging/chatroom/chat_room_manager").execute(function(e){v["AmazonComm/messaging/chatroom/chat_room_manager"]=e});t.register("AmazonComm/messaging/chatroom/chat_room_user_class",function(){var e=function(e,f){this.mPerson=e;this.mAssociation=f};e.prototype.getJID=function(){return this.mPerson.getJID()};e.prototype.getPerson=function(){return this.mPerson};e.prototype.getAssociation=function(){return this.mAssociation};e.prototype.equals=function(e){return this.mPerson.equals(e.getPerson())&&
this.mAssociation.equals(e.getAssociation())};return{ChatRoomUser:e}});t.when("3p-JSJaC","3p-JSJaC-Crypt","AmazonComm/auth/auth_utils","AmazonComm/common/jid_class","AmazonComm/messaging/jsjac/packet_converter","AmazonComm/messaging/message_class","AmazonComm/utils/messaging_service_host_provider","AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/messaging/jsjac/connection",
function(e,l,f,d,n,k,c,a,m,q,u,h,g,b){function p(){return!m.isEmpty(x)&&x.connected()}function r(b){var a=q.getMessagingHostOverride();if(m.isEmpty(a)){if(m.isEmpty(b))return w();V=b}else{var c=/^((https?|wss?):\/\/)?([\-a-zA-Z0-9.]{2,256})(:([0-9]+))?$/.exec(a);null===c?b=null:(b={protocol:c[2]!==M?c[2]:"https",hostName:c[3]},b.port=c[5]!==M?c[5]:"https"===b.protocol||"wss"===b.protocol?443:80);V=b;if(m.isEmpty(V)){for(b=0;b<A.length;b++)A[b].onError({code:u.CONNECTION_ERRORS.ERROR_INVALID_URL,description:"Override URL ["+
a+"] is invalid"});return!1}}"Disconnected"===O||"NewHostOrSessionTerminationReconnecting"===O?(aa=1,O="Connecting"):aa++;a="wss://"+V.hostName+":"+V.port+"/ws/";h.setMessagingServerUrl(a);g.l("jsjac/connection","connecting to server: ["+JSON.stringify(V)+"], domain: ["+q.getMessagingDomain()+"], resource: ["+h.getResource()+"]");x=new e.JSJaCWebSocketConnection({httpbase:a});x.registerHandler("onconnect",H);x.registerHandler("ondisconnect",E);x.registerHandler("onerror",I);x.registerHandler("message",
B);x.registerHandler("presence_in",Q);x.registerHandler("iq",G);x.registerIQGet("query",e.NS_VERSION,X);x.registerIQGet("query",e.NS_TIME,K);F=new Date;h.setCurrentAuthCredentialData(S);x.connect({domain:q.getMessagingDomain(),resource:h.getResource()});return!0}function w(){c.getMessagingServiceHostFromInternalService({onGetMessagingServiceHostSuccess:function(b){r(b)},onGetMessagingServiceHostError:function(b){g.e("jsjac/connection","Failed to get host from CampfireInternalService. Will try calling CoreService. ErrorCode: ["+
b.code+"] Error Description: ["+b.description+"]");a.incrementCounter(D,"JSJaCConnection.GetHostFromCoreService."+O+".Count");return t()},onGetMessagingServiceHostRetry:function(b,a){g.e("jsjac/connection","Failed to get host from CampfireInternalService. MessagingServiceHostProvider is going to retry. ErrorCode: ["+b.code+"] Error Description: ["+b.description+"]")}},Z);return!0}function t(){c.getMessagingServiceHost({onGetMessagingServiceHostSuccess:function(b){r(b)},onGetMessagingServiceHostError:function(b){g.e("jsjac/connection",
"Failed to get host from CampfireCoreService. ErrorCode: ["+b.code+"] Error Description: ["+b.description+"]");for(var a=0;a<A.length;a++)A[a].onError(b)},onGetMessagingServiceHostRetry:function(b,a){g.e("jsjac/connection","Failed getting host from CampfireCoreService. MessagingServiceHostProvider is going to retry. ErrorCode: ["+b.code+"] Error Description: ["+b.description+"]")}},Z);return!0}function v(){m.isEmpty(x)||(O="Disconnecting",x.disconnect())}function H(){O="Connected";aa=1;m.isEmpty(F)||
(a.addTimer(D,"ConnectionRequest.SuccessTimer",new Date-F),a.recordMetricEvent(D),F=null);clearTimeout(ga);Z=[];g.l("jsjac/connection","sending initial presence to server ["+x._serverName+"] ("+x._serverIP+") from JID "+R);x.send(new e.JSJaCPresence);for(var b={jid:R},c=0;c<A.length;c++)A[c].onConnected(b);for(;0<ea.length;)b=ea.shift(),c=new d.JID(b.packet.getFrom()),c.equals(R)?P(b.packet,!1,b.callback):g.l("jsjac/connection","not sending queued packet because JID changed from "+c.toString()+" to "+
R.toString())}function E(){g.l("jsjac/connection","disconnected from server");m.isEmpty(x)||(x.unregisterHandler("onconnect",H),x.unregisterHandler("ondisconnect",E),x.unregisterHandler("onerror",I),x.unregisterHandler("message",B),x.unregisterHandler("presence_in",Q));if("Disconnecting"===O){g.l("jsjac/connection","explicit disconnect - not trying to reconnect");O="Disconnected";a.recordMetricEvent(D);for(var b=0;b<A.length;b++)A[b].onDisconnected()}else if("NewHostOrSessionTerminationReconnecting"===
O)for(var c={code:u.CONNECTION_ERRORS.ERROR_SESSION_TERMINATED,description:"session terminated from server."},b=0;b<A.length;b++)A[b].onReconnecting(c);else if("Disconnected"!==O){a.incrementCounter(D,"ConnectionRequest.Error.ConnectionLostCount");c={code:u.CONNECTION_ERRORS.ERROR_CONNECTION_LOST,description:"connection to server lost"};for(b=0;b<A.length;b++)A[b].onReconnecting(c);C()}else g.e("jsjac/connection","Already disconnected or Unexpected connection state: ["+O+"]")}function I(b){m.isEmpty(F)||
(a.addTimer(D,"ConnectionRequest.ErrorTimer",new Date-F),F=null);var c=u.GENERIC_ERRORS.ERROR_UNKNOWN,d=null,h=fa,e=0,p="";try{if(m.isEmpty(b.firstChild.textContent)){if(c=b.getAttribute("code"),d=b.firstChild.nodeName,h=fa,p=c+"ClientErrorCount",0<b.getElementsByTagName("system-shutdown").length){var k=b.getElementsByTagName("delay")[0].getAttribute("value");m.isEmpty(k)||(p=c+"ServerReconnectCount",O="NewHostOrSessionTerminationReconnecting",e=k)}}else var f=JSON.parse(b.firstChild.textContent),
c=f.status_code,d=f.status_string,h=f.retry_after_seconds,p=c+"ServiceErrorCount"}catch(n){g.ex("jsjac/connection","unknown error (server down?)",n),c=u.GENERIC_ERRORS.ERROR_UNKNOWN,d="unknown error (server down?)",h=fa}b="ConnectionRequest.Error.UnknownErrorCount";m.isEmpty(p)||(b="ConnectionRequest.Error.__METRIC_ERROR_NAME_PLACEHOLDER__".replace("__METRIC_ERROR_NAME_PLACEHOLDER__",p));a.incrementCounter(D,b);a.recordMetricEvent(D);g.e("jsjac/connection","statusCode: "+c+", statusString: "+d);c=
{code:c,description:d};if(0<e)setTimeout(r,e),E();else if(0<h&&"NewHostOrSessionTerminationReconnecting"!==O){for(e=0;e<A.length;e++)A[e].onReconnecting(c);C(1E3*h)}else for(e=0;e<A.length;e++)A[e].onError(c)}function C(b){O="Reconnecting";a.incrementCounter(D,"ConnectionRequest.RetryCount");clearTimeout(ga);1===aa&&(ca=m.isEmpty(b)?ba=1E3:ba=b);ba=Math.floor(ca+.1*ca*Math.random());g.l("jsjac/connection","trying to reconnect in "+ba+" ms");ga=setTimeout(r,ba);ca*=2;1E4<=ca&&(g.l("jsjac/connection",
"Messaging service host: ["+JSON.stringify(V)+"] is bad. Will try to reconnect with different host."),-1===Z.indexOf(V.hostName)&&Z.push(V.hostName),O="NewHostOrSessionTerminationReconnecting",a.incrementCounter(D,"ConnectionRequest.ServerSwitchedOnReconnectCount"))}function z(b,c){var d=(new Date).getTime();c=null!=c?setTimeout(function(){b.getAmzType()===k.AMZ_TYPE_RECEIPT?a.incrementCounter(D,"MessageDelivery.ReceiptTimeOutCount"):a.incrementCounter(D,"MessageDelivery.MessageTimeOutCount");a.recordMetricEvent(D);
g.e("jsjac/connection","Message ["+b.getAmzContent()+"] timed out");for(var c=U.length-1;0<=c;c--)if(U[c].message.getID()===b.getID()){U.splice(c,1);break}b.setError(!0);var d=W[b.getAmzType()];if(!m.isEmpty(d))for(c=0;c<d.length;c++)d[c].onError(b)},c):null;U.push({message:b,sentTime:d,timeoutId:c})}function y(b){b=b.getAck();for(var c=0;c<U.length;c++){var d=U[c];if(d.message.getID()===b){U.splice(c,1);null!=d.timeoutId&&clearTimeout(d.timeoutId);b=(new Date).getTime()-d.sentTime;a.addTimer(D,"MessageDelivery.RoundTripTimer",
b);a.recordMetricEvent(D);break}}}function B(b){var c=n.packetToMessage(b);if(c.getType()===k.TYPE_ERROR){if(!m.isEmpty(b.getChild("error"))){var d=b.getChild("error");b=d.getAttribute("code");var h=d.getAttribute("type"),d="error packet - code: "+b+", type: "+h+", message: "+d.firstChild.nodeName;"406"===b&&(d+=", explanation: you are not an occupant of this room or you tried to perform a disallowed operation");g.e("jsjac/connection",d)}for(var e,d=U.length-1;0<=d;d--)if(U[d].message.getID()===c.getAck()){e=
U[d];e.message.setError(!0);U.splice(d,1);null!=e.timeoutId&&clearTimeout(e.timeoutId);break}if(null!=e&&(b=W[e.message.getAmzType()],e.message.getAmzType()===k.AMZ_TYPE_RECEIPT&&(a.incrementCounter(D,"MessageDelivery.ReceiptMessageErrorCount"),a.recordMetricEvent(D)),!m.isEmpty(b)))for(c=0;c<b.length;c++)b[c].onError(e.message)}else if(c.wasSentByUs()?(0===c.getAmzTimeSent()&&c.setAmzTimeSent(c.getAmzTimeCreated()),y(c)):c.setAmzTimeReceived((new Date).getTime()),b=W[c.getAmzType()],!m.isEmpty(b))for(d=
0;d<b.length;d++)b[d].onMessage(c)}function Q(b){b=n.packetToPresence(b);var a=Y[b.getType()];if(!m.isEmpty(a))for(var c=0;c<a.length;c++)a[c].onPresence(b)}function G(b){if("result"===b.getType()||"set"===b.getType()){var a=b.getChild();if(!m.isEmpty(a)&&(a=ha[a.namespaceURI],!m.isEmpty(a)))a.onIq(b)}else"error"===b.getType()?g.e("jsjac/connection","Received IQ error response: "+b.xml()):g.e("jsjac/connection","Unknown IQ type:"+b.getType())}function P(b,a,c){if(p())return x.send(b,c);a||ea.push({packet:b,
callback:c});return!1}function N(){var b,a;q.useCognitoAuth()?(b=ja,a=l.b64encode(T)):(b=ka,a=f.getAuthenticationToken(S),a=l.b64encode(a));return'\x3cauth xmlns\x3d"urn:ietf:params:xml:ns:xmpp-sasl" mechanism\x3d"'+b+'"\x3e'+a+"\x3c/auth\x3e"}function L(b){m.isEmpty(F)||(a.addTimer(D,"ConnectionRequest.ErrorTimer",new Date-F),F=null);for(var c,d=0;d<b.childNodes.length;d++){var e=b.childNodes[d];if("json"===e.nodeName.toLowerCase()){c=JSON.parse(e.textContent);break}}if(!m.isEmpty(c))if(b={code:c.status_code,
description:c.status_string},g.e("jsjac/connection","SASL error encountered: ["+b+"]"),a.incrementCounter(D,b.code+"ServiceErrorCount"),a.recordMetricEvent(D),c=c.retry_after_seconds,0<c){for(d=0;d<A.length;d++)A[d].onReconnecting(b);C(1E3*c)}else{g.l("jsjac/connection","Not reconnecting due to non-retryable SASL error");for(d=0;d<A.length;d++)A[d].onError(b);v()}}function X(b){g.l("jsjac/connection","handleIqVersion");b=b.reply([b.buildNode("name","AmazonComm"),b.buildNode("version",e.JSJaC.Version),
b.buildNode("os",navigator.userAgent)]);x.send(b);return!0}function K(b){g.l("jsjac/connection","handleIqTime");var a=new Date;b=b.reply([b.buildNode("display",a.toLocaleString()),b.buildNode("utc",a.jabberDate()),b.buildNode("tz",a.toLocaleString().substring(a.toLocaleString().lastIndexOf(" ")+1))]);x.send(b);return!0}var D,F,S=null,T=null,A=[],x=null,R=null,W={},ha={},Y={},V=null,Z=[],ea=[],ga=null,aa=1,ba=1E3,ca=1E3,fa=2,U=[],O="Disconnected";h.registerCleanupObserver({cleanup:function(){g.l("jsjac/connection",
"cleaning up jsjac/connection");A=[]}});e.JSJaCWebSocketConnection.prototype._doSASLAuth=function(){return this._sendRaw(N(),this._doSASLAuthDone)};var ja="COGNITO_OPENID_CONNECT",ka="CAMPFIRE_SHARED_KEY";e.JSJaCWebSocketConnection.prototype._doSASLAuthDone=function(b){b=b.data;b.includes("\x3copen")&&(b=b.substr(b.indexOf("\x3copen")));(b=this._parseXml(b))?b.nodeName.startsWith("open")?(this.streamid=b.getAttribute("id"),this._connected=!0):b.nodeName.startsWith("stream")?this._parseStreamFeatures(b)||
this._handleEvent("onerror",e.JSJaCError("503","cancel","service-unavailable")):"success"===b.nodeName.toLowerCase()?(b=l.b64decode(b.firstChild.nodeValue),R=new d.JID(b),this._reInitStream()):"failure"===b.nodeName.toLowerCase()&&L(b):this._handleEvent("onerror",e.JSJaCError("503","cancel","service-unavailable"))};return{connect:function(b,c,d){S=c;m.isEmpty(D)&&(D=a.createMetricEvent("JSJaCConnection",a.AGGREGATING_EVENT));q.useCognitoAuth()&&(T=f.getAuthenticationToken(c,b));p()?(g.l("jsjac/connection",
"already connected - ignoring connect request"),b=!1):(m.isEmpty(d)||A.unshift(d),b=r(c.messagingHostInfo));return b},disconnect:function(){v()},isConnected:function(){return p()},sendPacket:function(b,a,c){return P(b,a,c)},sendMessage:function(b,a,c){var d=null!=a;z(b,a);b.setAmzTimeSent((new Date).getTime());b=n.messageToPacket(b);return P(b,d,c)},addMessageHandler:function(b,a){var c=W[b];m.isEmpty(c)&&(c=[]);-1===c.indexOf(a)&&(c.push(a),W[b]=c);return a},removeMessageHandler:function(b,a){var c=
W[b];m.isEmpty(c)||(a=c.indexOf(a),-1<a&&(c.splice(a,1),W[b]=c))},addPresenceHandler:function(b,a){var c=Y[b];m.isEmpty(c)&&(c=[]);-1===c.indexOf(a)&&(c.push(a),Y[b]=c);return a},removePresenceHandler:function(b,a){var c=Y[b];m.isEmpty(c)||(a=c.indexOf(a),-1<a&&(c.splice(a,1),Y[b]=c))},addIQHandler:function(b,a){ha[b]=a},getConnection:function(){return x},setCredential:function(b){S=b},setToken:function(b){T=b},setJID:function(b){R=b},buildSASLAuthString:function(){return N()},handleSASLError:function(b){return L(b)},
handleIqVersion:function(b){return X(b)},handleIqTime:function(b){return K(b)},handleMessage:function(b){return B(b)},handlePresence:function(b){return Q(b)},handleIq:function(b){return G(b)},handleError:function(b){return I(b)},handleDisconnected:function(){return E()},getMessageHandlerCount:function(b){var a=0;b=W[b];m.isEmpty(b)||(a=b.length);return a},getPresenceHandlerCount:function(b){var a=0;b=Y[b];m.isEmpty(b)||(a=b.length);return a},startReconnecting:function(b){return C(b)},isFirstReconnectAttempt:function(){return 1===
aa},setConnectionAttempt:function(b){aa=b},getReconnectDelayMillis:function(){return ba},getCurrentMessagingServiceHost:function(){return V},setCurrentMessagingServiceHost:function(b){V=b},getServersToExclude:function(){return Z},getPendingMessageQueue:function(){return ea},setDefaultRetryAfter:function(b){fa=b},setObserver:function(b){A.unshift(b)},addObserver:function(b){A.push(b)},getObservers:function(){return A},addToRoundTripList:function(b,a){z(b,a)},logRoundTripMetric:function(b){y(b)},getMessagesWeSent:function(){return U},
setConnectionState:function(b){O=b},getConnectionState:function(){return O}}});t.when("AmazonComm/messaging/jsjac/connection").execute(function(e){v["AmazonComm/messaging/jsjac/connection"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/error_codes").register("AmazonComm/messaging/jsjac/node_utils",function(e,l){function f(d,e,c){e===d?d.appendNode(c):e.appendChild(c)}function d(d){e.isEmpty(d)&&(d={});return d}return{appendNode:function(d,e,c){c=d.buildNode(c);f(d,e,c);return c},appendNodeWithAttribute:function(d,
e,c,a,l){var q={};q[a]=l;c=d.buildNode(c,q);f(d,e,c);return c},appendNodeWithAttributeMap:function(d,e,c,a){c=d.buildNode(c,a);f(d,e,c);return c},appendNodeWithText:function(e,k,c,a){c=e.buildNode(c);c=d(c);c.textContent=a;f(e,k,c);return c},appendNodeWithAttributeAndText:function(e,k,c,a,l,q){var u={};u[a]=l;c=e.buildNode(c,u);c=d(c);c.textContent=q;f(e,k,c);return c},getCampfireErrorFromPacket:function(d){var k={code:l.GENERIC_ERRORS.ERROR_UNKNOWN,description:"unknown"};d=d.getChild("error","*");
e.isEmpty(d)||(k.code=d.getAttribute("code"),k.description=d.firstChild.nodeName);return k},getChildNode:function(d,e){a:{e=e.split(".");var c=d;for(d=0;d<e.length;d++){c=c.getElementsByTagName(e[d]);if(0===c.length){e=null;break a}c=c[0]}e=c}return e},modifyNullObject:d}});t.when("AmazonComm/messaging/jsjac/node_utils").execute(function(e){v["AmazonComm/messaging/jsjac/node_utils"]=e});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/message_class","AmazonComm/messaging/presence_class",
"AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/messaging/jsjac/packet_converter",function(e,l,f,d,n,k,c,a){function m(a){var c=new e.JID(a.getNode(),a.getDomain());a=a.getResource();k.isEmpty(a)||c.setNickname(a);return c}function q(a){for(var c=new d.MucPresence,b=a.getElementsByTagName("status"),p=[],f=0;f<b.length;f++)p.push(b.item(f).getAttribute("code"));c.setStatusCodes(p);f=a.getElementsByTagName("roomstatus")[0];k.isEmpty(f)||
c.setRoomStatus(f.textContent);a=a.getElementsByTagName("item");b=[];for(f=0;f<a.length;f++){var m=a.item(f),p=new d.MucPresenceItem;p.setAffiliation(m.getAttribute("affiliation"));p.setRole(m.getAttribute("role"));var n=m.getAttribute("jid");k.isEmpty(n)||p.setJID(new e.JID(n));p.setNick(m.getAttribute("nick"));var q=m.getElementsByTagName("actor")[0];k.isEmpty(q)||(n=new e.JID(q.getAttribute("jid")),q=q.getAttribute("nick"),p.setActor(new l.Person(n,q)));m=m.getElementsByTagName("reason")[0];k.isEmpty(m)||
p.setReason(m.nodeValue);b.push(p)}c.setItems(b);return c}var u=d.PresenceType.AVAILABLE;return{messageToPacket:function(d,g){var b;try{var e=new a.JSJaCMessage;e.setID(d.getID());e.setFrom(new a.JSJaCJID(d.getFrom().getJIDAsString()));e.setTo(new a.JSJaCJID(d.getTo().getJIDAsString()));e.setType(d.getType());e.setBody(JSON.stringify(d.getBody()));d.hasSubject()&&e.setSubject(d.getSubject());g=null;d.getChatStateComposing()?g=f.CHAT_STATE_COMPOSING:d.getChatStatePaused()&&(g=f.CHAT_STATE_PAUSED);
if(!k.isEmpty(g)){var r=e.buildNode(g,{xmlns:"http://jabber.org/protocol/chatstates"});e.appendNode(r)}b=e}catch(l){c.ex("packet_converter","error creating JSJaCMessage",l),b=null}return b},packetToMessage:function(d){var g=d;d=new f.Message;if(g.getChild("result")){var b=g.getChild("result"),b=b.getElementsByTagName("forwarded")[0],b=b.getElementsByTagName("message")[0],p=new a.JSJaCMessage;p.setID(b.getAttribute("id"));p.setFrom(b.getAttribute("from"));p.setTo(b.getAttribute("to"));p.setType(b.getAttribute("type"));
p.setAmzAck(b.getAttribute("amz_ack"));p.setBody(g.getBody());g=p}k.isEmpty(g.getID())?(c.w("packet_converter","got message with empty ID - assigning new ID"),d.setID(k.createUUID(k.TAG_MESSAGE))):d.setID(g.getID());k.isEmpty(g.getFrom())||(b=g.getFromJID(),d.setFrom(new e.JID(b.getNode(),b.getDomain())));k.isEmpty(g.getTo())||(b=g.getToJID(),d.setTo(new e.JID(b.getNode(),b.getDomain())));k.isEmpty(g.getAmzAck)||d.setAck(g.getAmzAck());d.setType(g.getType());if(d.getType()!==f.TYPE_ERROR)if(d.setChatStateComposing(!k.isEmpty(g.getChild(f.CHAT_STATE_COMPOSING,
"http://jabber.org/protocol/chatstates"))),d.setChatStatePaused(!k.isEmpty(g.getChild(f.CHAT_STATE_PAUSED,"http://jabber.org/protocol/chatstates"))),k.isEmpty(g.getChild("x","http://jabber.org/protocol/muc#user")))if(k.isEmpty(g.getChild("x","jabber:x:conference"))){b=null;try{b=JSON.parse(g.getBody())}catch(r){k.isEmpty(g.getBody)?c.l("packet_converter","received non-JSON packet"):c.l("packet_converter","received non-JSON message: "+g.getBody())}k.isEmpty(b)||d.setBody(b)}else g=g.getChild("x","jabber:x:conference"),
g=new e.JID(g.getAttribute("jid")),d.setAmzType(f.AMZ_TYPE_GROUP_INVITE),d.setAmzGroupInviteJID(g);else p=g,g=p.getChild("x","http://jabber.org/protocol/muc#user").firstElementChild,"decline"===g.nodeName?d.setAmzType(f.AMZ_TYPE_GROUP_INVITE_DECLINE):d.setAmzType(f.AMZ_TYPE_GROUP_INVITE),b=new e.JID(g.getAttribute("from")),p=new e.JID(p.getFrom()),d.setAmzGroupInviteJID(p),d.setAmzSenderJID(b),k.isEmpty(g.firstElementChild)||d.setAmzContent(g.firstElementChild.textContent);return d},packetToPresence:function(a){var c,
b;c=new d.Presence;c.setID(a.getID());k.isEmpty(a.getFrom())||c.setFrom(m(a.getFromJID()));k.isEmpty(a.getTo())||c.setTo(m(a.getToJID()));b=a.getType();k.isEmpty(b)?c.setType(u):c.setType(b);c.setShow(a.getShow());c.setStatus(a.getStatus());k.isEmpty(a.getPriority())?c.setPriority(0):c.setPriority(a.getPriority());a.isError()&&(b=n.getCampfireErrorFromPacket(a),c.setError(b));b=a.getChild("x","http://jabber.org/protocol/muc#user");k.isEmpty(b)||c.setRoomPresence(q(b));b=a.getChild("reach","urn:xmpp:reach:0");
k.isEmpty(b)||c.setHasReachableAddress(!k.isEmpty(b.getElementsByTagName("addr")));b=a.getChild("sender","urn:xmpp:amazon:user");k.isEmpty(b)||(c.setSenderName(b.getAttribute("name")),c.setSenderCustomerId(b.getAttribute("amazonCustomerId")));a=a.getChild("chatability","urn:xmpp:amazon:presence:chatability");k.isEmpty(a)||c.setChatability(parseInt(a.textContent,10));return c}}});t.when("AmazonComm/messaging/jsjac/packet_converter").execute(function(e){v["AmazonComm/messaging/jsjac/packet_converter"]=
e});t.when("AmazonComm/common/jid_class","AmazonComm/messaging/message_class","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/global_state","AmazonComm/utils/log","AmazonComm/utils/mash/campfire_cordova").register("AmazonComm/messaging/native/connection",function(e,l,f,d,n,k,c){var a=!1,m=null,q={},u={connected:function(b){a=!0;var c=b.authCredentialData;f.isEmpty(c)||(k.l("native/connection","got auth credential data used by native connection"),n.setAuthCredentialData(c));f.isEmpty(m)||
(b=e.JID.fromJSONObject(b.jid),k.l("native/connection","server assigned jid: ["+b.toString()+"]"),m.onConnected({jid:b}))},disconnected:function(b){a=!1;if(!f.isEmpty(m))m.onDisconnected()},reconnecting:function(b){a=!1;if(!f.isEmpty(m))m.onReconnecting({code:b.errorCode,description:b.errorDescription})},error:function(b){a=!1;if(!f.isEmpty(m))m.onError({code:b.errorCode,description:b.errorDescription})},message:function(b){b=l.createFromJSONString(b.messageString);var a=q[b.getAmzType()];if(!f.isEmpty(a))for(var c=
0;c<a.length;c++)a[c].onMessage(b)}},h={onSuccess:function(b){var a=b.status;k.l("native/connection","handling ["+a+"] event");u[a](b)},onError:function(b){k.l("native/connection","error calling the native connection");u.error(b)}},g={onSuccess:function(b){k.l("native/connection","message successfully sent.")},onError:function(b){k.l("native/connection","error sending message.")}};return{connect:function(b,a,e){k.l("native/connection","connecting to server natively");m=e;b=[{apiKey:b,stage:d.getStage(),
isAuthenticationCheckRequired:d.isAuthenticationCheckRequired(),messagingServiceHostCount:d.getMessagingHostCount(),messagingServiceDomain:d.getMessagingDomain(),messagingServiceMucDomain:d.getMUCDomain(),messagingServiceFormat:d.getMessagingHostFormat()},a];n.setCurrentAuthCredentialData(a);c.exec("nativeConnect",b,h)},disconnect:function(){k.l("native/connection","disconnecting native server connection");c.exec("nativeDisconnect",[],h)},isConnected:function(){return a},sendPacket:function(b,a){k.e("native/connection",
"api not implemented")},sendMessage:function(b,a){b=[l.convertMessageToJSONObject(b)];c.exec("sendMessage",b,g);return!0},addMessageHandler:function(b,a){var c=q[b];f.isEmpty(c)&&(c=[]);-1===c.indexOf(a)&&(c.push(a),q[b]=c);return a},removeMessageHandler:function(b,a){var c=q[b];f.isEmpty(c)||(a=c.indexOf(a),-1<a&&(c.splice(a,1),q[b]=c))},addPresenceHandler:function(b,a){k.e("native/connection","api not implemented")},removePresenceHandler:function(b,a){k.e("native/connection","api not implemented")},
setNativeConnectionObserver:function(b){m=b},setNativeSendMessageCallbacks:function(b){g=b},getMessageHandlerCount:function(b){var a=0;b=q[b];f.isEmpty(b)||(a=b.length);return a}}});t.when("AmazonComm/messaging/native/connection").execute(function(e){v["AmazonComm/messaging/native/connection"]=e});t.when("AmazonComm/utils/config","AmazonComm/utils/log","AmazonComm/utils/common","3p-Dcm").register("AmazonComm/metrics/metrics_manager",function(e,l,f,d){d.MetricsConfiguration.configureNormalPipeline(65536,
2048,12E4);d.MetricsConfiguration.configureHighPipeline(32768,1024,6E4);d.MetricsConfiguration.setLogEnabled(!1);d.MetricsFactory.setDeviceTypeId("APBG3C9M6ERTI");d.MetricsFactory.setDeviceSerialNumber("0");d.MetricsFactory.setOAuthTokenProvider(function(){return null});return{AGGREGATING_EVENT:d.MetricEventType.AGGREGATING,AVERAGING_EVENT:d.MetricEventType.AVERAGING,NORMAL_PRIORITY:d.MetricPriority.NORMAL,HIGH_PRIORITY:d.MetricPriority.HIGH,createMetricEvent:function(n,k){f.isEmpty(n)&&(n="CampfireJavaScriptSDKDefaultSource",
l.w("metrics_manager","Invalid sourceName. Using default source name."));var c=null;try{d.MetricsFactory.addMetadata("MarketplaceID",e.getMarketplaceId()),c=d.MetricsFactory.createMetricEvent(f.createUUID(f.TAG_METRIC),e.getStage()+".CampfireJavaScriptSDK."+e.getApiKey(),n,k,!0)}catch(a){l.error("metrics_manager","error creating metrics event",a)}return c},incrementCounter:function(d,e,c){try{return d.incrementCounter(e,c),!0}catch(a){return l.error("metrics_manager","error incrementing counter",
a),!1}},startTimer:function(d,e,c){try{return d.startTimer(e,c),!0}catch(a){return l.error("metrics_manager","error starting timer",a),!1}},stopTimer:function(d,e){try{return d.stopTimer(e),!0}catch(c){return l.error("metrics_manager","error stopping timer",c),!1}},addTimer:function(d,e,c,a){try{if(f.isEmpty(a)||0>=a)a=1;d.addTimer(e,c,a);return!0}catch(m){return l.error("metrics_manager","error adding timer",m),!1}},setDeviceSerialNumber:function(e){if(f.isEmpty(e))return l.w("metrics_manager","Invalid device serial number. Using default DSN."),
!1;d.MetricsFactory.setDeviceSerialNumber(e);return!0},recordMetricEvent:function(e,f){try{return d.MetricsFactory.recordMetricEvent(e,f),!0}catch(c){return l.error("metrics_manager","error recording metric event",c),!1}},uploadRecordedMetrics:function(){try{l.l("metrics_manager","forcing metrics upload"),d.MetricsFactory.uploadMetrics()}catch(e){l.error("metrics_manager","error uploading metrics",e)}}}});t.when("AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/presence_class",
"AmazonComm/messaging/presence_manager","AmazonComm/messaging/jsjac/connection","AmazonComm/messaging/jsjac/node_utils","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/constants","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log","3p-JSJaC").register("AmazonComm/roster/roster_class",function(e,l,f,d,n,k,c,a,m,q,u,h,g){function b(b){var a=new l.Person(b.getFrom(),b.getSenderName(),b.getSenderCustomerId());h.l("roster","received presence type ["+
b.getType()+"] from "+a);for(var c=0;c<z.length;c++)if(b.getType()===f.PresenceType.SUBSCRIBE)z[c].onSubscribe({person:a});else if(b.getType()===f.PresenceType.SUBSCRIBED)z[c].onSubscribed({person:a});else if(b.getType()===f.PresenceType.UNSUBSCRIBED)z[c].onUnsubscribed({person:a});else h.e("roster","unexpected presence type ["+b.getType()+"]")}function p(b){if(b.isError())b=k.getCampfireErrorFromPacket(b),h.error("roster","error fetching roster",b),I.onError(b);else{b=b.getNode().getElementsByTagName("item");
h.l("roster","roster update has "+b.length+" items");for(var a=0;a<b.length;a++)r(b.item(a));y.sort(w);B.sort(w);if(C)for(b=0;b<z.length;b++)z[b].onChange({rosterItems:y,sentInvites:B});else if(C=!0,!c.isEmpty(I))I.onSuccess({rosterItems:y,sentInvites:B})}}function r(b){var a=new e.JID(b.getAttribute("jid")),d;a.isGroupJID()?d=!0:(d=u.getLocalUser(),d=c.isEmpty(d)||c.isEmpty(d.getJID())||!d.getJID().equals(a)?void 0:!0);if(!d){d=b.getAttribute("name");c.isEmpty(d)&&(d=a.toString());var g=b.getAttribute("amazonCustomerId"),
a=new l.Person(a,d,g);b=b.getAttribute("ask");if(c.isEmpty(b)||"subscribe"!==b){b=!1;for(d=0;d<y.length;d++)if(y[d].getJID().equals(a.getJID())){y[d]=a;b=!0;break}b||y.push(a);for(d=0;d<B.length;d++)if(B[d].getJID().equals(a.getJID())){B.splice(d,1);break}}else{b=!1;for(d=0;d<B.length;d++)if(B[d].getJID().equals(a.getJID())){B[d]=a;b=!0;break}b||B.push(a)}}}function w(b,a){return b.getName().localeCompare(a.getName())}function t(b,a){h.l("roster","sending presence type ["+b+"] to "+a.getJID());var d=
new g.JSJaCPresence;d.setTo(a.getJID().getJIDAsString());d.setType(b);d.setID(c.createUUID(c.TAG_PRESENCE));return n.sendPacket(d)}function v(b){I=b;b=new g.JSJaCIQ;b.setType("get");b.setID(c.createUUID(c.TAG_IQ));b.setQuery("jabber:iq:roster");if(!n.sendPacket(b,!1,function(b){p(b);n.sendPacket(new g.JSJaCPresence)}))I.onError({code:q.GENERIC_ERRORS.ERROR_UNKNOWN,description:"failed to send roster IQ"})}function H(b){for(var a={},c=0;c<Q.length;c++){var d=Q[c];b.hasOwnProperty(d)&&(a[d]=b[d])}return a}
function E(b,d){var f=new g.JSJaCIQ;f.setIQ(a.getSearchDomain(),"set",c.createUUID(c.TAG_IQ));var p=f.setQuery("jabber:iq:search");if(!c.isEmpty(b.searchString)&&!c.isEmpty(b.searchType)){var r=b.searchString,w=b.searchType,t=H(b);k.appendNodeWithText(f,p,w,r);p=k.appendNodeWithAttribute(f,p,"search",m.XMLNS,"urn:xmpp:amazon:search:attributes");k.appendNodeWithAttributeAndText(f,p,m.ELEMENT_JSON,m.XMLNS,m.NS_JSON,JSON.stringify(t));h.l("roster","searching for users matching ["+JSON.stringify(b)+"]");
if(!n.sendPacket(f,!1,function(a){var g=!1;c.isEmpty(b.excludeSelf)||!0!==b.excludeSelf||(g=!0);if(a.isError())g=k.getCampfireErrorFromPacket(a),h.error("roster","error searching for users",g),d.onError(g);else{var f,p,r,m,q,n=[],w=a.getNode().getElementsByTagName("item");h.l("roster","user search returned "+w.length+" items");for(var K=u.getLocalUser().getJID(),t=0;t<w.length;t++)f=w.item(t),a=new e.JID(f.getAttribute("jid")),p=k.getChildNode(f,"name").textContent,r=k.getChildNode(f,"amazonCustomerId").textContent,
q=k.getChildNode(f,"mobile").textContent,m=k.getChildNode(f,"email").textContent,f="true"===k.getChildNode(f,"userExist").textContent?!0:!1,!1!==g&&a.getBareJID()===K.getBareJID()||n.push(new l.Person(a,p,r,null,q,m,f));d.onSuccess({rosterItems:n})}}))d.onError({code:q.GENERIC_ERRORS.ERROR_UNKNOWN,description:"failed to send search IQ"})}}var I,C=!1,z=[],y=[],B=[],Q=["maxSize","prefix","sortField","substring"],G=function(){this.mRosterLoadCallbacks=null;this.mRosterLoaded=!1;this.mRosterObservers=
[];this.mCurrentRoster=[];this.mSentInvites=[];n.addIQHandler("jabber:iq:roster",{onIq:p});d.subscribe(f.PresenceType.SUBSCRIBE,b);d.subscribe(f.PresenceType.SUBSCRIBED,b);d.subscribe(f.PresenceType.UNSUBSCRIBED,b)};G.prototype.loadRoster=function(b){v(b)};G.prototype.searchForUsers=function(b,a){E(b,a)};G.prototype.registerObserver=function(b){z.push(b)};G.prototype.unregisterObserver=function(b){b=z.indexOf(b);return-1<b?(z=z.splice(b,1),!0):!1};G.prototype.invitePerson=function(b){return t(f.PresenceType.SUBSCRIBE,
b)};G.prototype.acceptInvite=function(b){t(f.PresenceType.SUBSCRIBED,b)};G.prototype.rejectInvite=function(b){t(f.PresenceType.UNSUBSCRIBED,b)};G.prototype.getSize=function(){return this.mCurrentRoster.length};G.prototype.toString=function(){return"Roster:{size:"+this.mCurrentRoster.length+"}"};G.prototype.handlePresence=function(a){return b(a)};G.prototype.handleRosterResponseItem=function(b){return r(b)};G.prototype.getRosterItems=function(){return y};G.prototype.getSentInvites=function(){return B};
G.prototype.compare=function(b,a){return w(b,a)};return{Roster:G,AMAZON_CUSTOMER_ID:"amazonCustomerId",EMAIL:"email",MOBILE:"mobile",NAME:"name",SOCIAL_GRAPH:"socialGraph"}});t.when("AmazonComm/roster/roster_class").execute(function(e){v["AmazonComm/roster/roster_class"]=e});t.register("AmazonComm/roster/roster_item_interface",function(){var e=function(){};e.prototype.getThirdPartyID=function(){throw Error("must be implemented by subclass!");};return{RosterItem:e}});t.when("AmazonComm/roster/roster_item_interface").execute(function(e){v["AmazonComm/roster/roster_item_interface"]=
e});t.when("AmazonComm/common/chatroom_class","AmazonComm/common/jid_class","AmazonComm/common/person_class","AmazonComm/messaging/chatroom/association_class","AmazonComm/messaging/chatroom/chat_room_manager","AmazonComm/rtc/call_peer_class","AmazonComm/rtc/call_signaler","AmazonComm/utils/common","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/rtc/call_class",function(e,l,f,d,n,k,c,a,m,q){var u=Object.freeze({NONE:"none",INCOMING:"incoming",OUTGOING:"outgoing"}),h=Object.freeze({NONE:"none",
REQUEST_SENT:"request_sent",REQUEST_DELIVERED:"request_delivered",PENDING_RESPONSE:"pending_response",CONNECTING:"connecting",IN_PROGRESS:"in_progress",ENDED:"ended",ERROR:"error"});l=function(){this.mID=a.createUUID(a.TAG_CALL);this.mDirection=u.NONE;this.mCallState=h.NONE;this.mCallStateObservers=[];this.mRequestedParticipants=[];this.mParticipantsCurrentlyInCall=[];this.mMcuInfo=this.mRemoteVideo=this.mSelfVideo=this.mCallPeer=this.mSignalingDestination=null};l.prototype.getID=function(){return this.mID};
l.prototype.setID=function(a){this.mID=a};l.prototype.getDirection=function(){return this.mDirection};l.prototype.setDirection=function(a){this.mDirection=a};l.prototype.addCallStateObserver=function(a){-1===this.mCallStateObservers.indexOf(a)&&this.mCallStateObservers.push(a);return a};l.prototype.removeCallStateObserver=function(a){a=this.mCallStateObservers.indexOf(a);-1<a&&this.mCallStateObservers.splice(a,1)};l.prototype.notifyObservers=function(){for(var a=0;a<this.mCallStateObservers.length;a++)this.mCallStateObservers[a].onStateChange(this.mCallState)};
l.prototype.getCallState=function(){return this.mCallState};l.prototype.setCallState=function(a){this.mCallState=a;this.notifyObservers()};l.prototype.getRequestedParticipants=function(){return this.mRequestedParticipants};l.prototype.setVideoElements=function(a,b){this.mSelfVideo=a;this.mRemoteVideo=b};l.prototype.isEnded=function(){return this.mCallState===h.ENDED||this.mCallState===h.ERROR};l.prototype.equals=function(c){return a.deepEquals(this,c)};l.prototype.toString=function(){return"Call: {\nID: ["+
this.mID+"]\ndirection: ["+this.mDirection+"]\ncallState: ["+this.mCallState+"]\nrequested participants: ["+this.mRequestedParticipants.length+"]\nparticipants in call: ["+this.mParticipantsCurrentlyInCall.length+"]\nobservers: ["+this.mCallStateObservers.length+"]\n}"};l.prototype.placeCall=function(a){this.setDirection(u.OUTGOING);this.mRequestedParticipants=a;this.addCallParticipant(m.getLocalUser());if(1<this.mRequestedParticipants.length){a=new n.ChatRoomConfig;a.ENABLE_LOGGING=n.MUC_CONFIG_VALUES.FALSE;
a.MEMBERS_ONLY=n.MUC_CONFIG_VALUES.TRUE;a.PERSISTENT_ROOM=n.MUC_CONFIG_VALUES.FALSE;a.PUBLIC_ROOM=n.MUC_CONFIG_VALUES.FALSE;var b=this;n.createRoom({name:"chat room for call "+this.getID()},{onCreated:function(a){var e=a.chatroom;b.mSignalingDestination=e;q.l("call_class","chat room created: "+e.toString());for(a=0;a<b.mRequestedParticipants.length;a++)n.setAffiliationInRoom(e,b.mRequestedParticipants[a].getJID(),d.Affiliation.MEMBER,{onSetAffiliationSuccess:function(a){c.sendInvite(b.getID(),new f.Person(a,
b.findParticipantNameForJID(a)),e)},onError:function(b){q.e("call_class","error adding participant to member list: "+b.description)}});b.setCallState(h.REQUEST_SENT)},onError:function(a){q.e("call_class","error creating chat room: "+a.description);b.setCallState(h.ERROR)}},a)}else this.mSignalingDestination=this.mRequestedParticipants[0],c.sendInvite(this.getID(),this.mSignalingDestination),this.setCallState(h.REQUEST_SENT)};l.prototype.findParticipantNameForJID=function(a){for(var b=0;b<this.mRequestedParticipants.length;b++){var c=
this.mRequestedParticipants[b];if(c.getJID().equals(a))return c.getName()}return""};l.prototype.handleIncomingCall=function(c){var b=this.makePersonFromSignal(c);q.l("call_class","incoming call from ["+b.getName()+"]");this.setDirection(u.INCOMING);this.setID(c.getAmzCallId());this.addCallParticipant(b);this.setCallState(h.PENDING_RESPONSE);a.isEmpty(c.getAmzGroupInviteJID())?this.mSignalingDestination=b:(this.mSignalingDestination=c=new e.ChatRoom(c.getAmzGroupInviteJID(),c.getAmzCallId()),n.joinRoom(c,
{onJoined:function(b){},onError:function(b){q.e("call_class","error joining chat room: "+b.description)}},{maxMessages:1}))};l.prototype.accept=function(){this.addCallParticipant(m.getLocalUser());this.setCallState(h.CONNECTING);c.sendAccept(this.getID(),this.mSignalingDestination);this.createPeer(!1)};l.prototype.handleAccept=function(a){q.l("call_class","["+a.getAmzSenderName()+"] accepted the call");a=this.makePersonFromSignal(a);this.addCallParticipant(a);this.getDirection()===u.OUTGOING?(this.getCallState()===
h.REQUEST_SENT?this.setCallState(h.CONNECTING):this.notifyObservers(),this.createPeer(!0)):this.notifyObservers()};l.prototype.reject=function(){c.sendReject(this.getID(),this.mSignalingDestination);this.endCall()};l.prototype.handleReject=function(a){q.l("call_class","["+a.getAmzSenderName()+"] rejected the call");a=this.makePersonFromSignal(a);this.endCallIfNoMoreParticipants(a)};l.prototype.hangup=function(){c.sendHangup(this.getID(),this.mSignalingDestination);this.endCall()};l.prototype.handleHangup=
function(a){q.l("call_class","["+a.getAmzSenderName()+"] hung up");a=this.makePersonFromSignal(a);this.endCallIfNoMoreParticipants(a)};l.prototype.endCallIfNoMoreParticipants=function(a){this.removeCallParticipant(a);1>=this.mParticipantsCurrentlyInCall.length?this.endCall():this.notifyObservers()};l.prototype.endCall=function(){this.setCallState(h.ENDED);this.closePeer()};l.prototype.addCallParticipant=function(a){for(var b=!1,c=0;c<this.mParticipantsCurrentlyInCall.length;c++)if(this.mParticipantsCurrentlyInCall[c].equals(a)){b=
!0;break}b||this.mParticipantsCurrentlyInCall.push(a)};l.prototype.removeCallParticipant=function(a){for(var b=0;b<this.mParticipantsCurrentlyInCall.length;b++)if(this.mParticipantsCurrentlyInCall[b].equals(a)){this.mParticipantsCurrentlyInCall.splice(b,1);break}};l.prototype.getCurrentCallParticipants=function(){return this.mParticipantsCurrentlyInCall};l.prototype.makePersonFromSignal=function(a){return new f.Person(a.getAmzSenderJID(),a.getAmzSenderName(),a.getAmzSenderId())};l.prototype.createPeer=
function(c){if(a.isEmpty(this.mCallPeer)){var b=this,d=1<this.mRequestedParticipants.length;this.mCallPeer=new k.CallPeer(this.getID(),c,d,this.mSignalingDestination,this.mSelfVideo,this.mRemoteVideo,function(){b.setCallState(h.IN_PROGRESS)});this.mCallPeer.initialize();a.isEmpty(this.mMcuInfo)||this.mCallPeer.handleMcuInfo(this.mMcuInfo)}};l.prototype.closePeer=function(){a.isEmpty(this.mCallPeer)||this.mCallPeer.close()};l.prototype.handleOffer=function(c){a.isEmpty(this.mCallPeer)||(c=c.getAmzSignalData(),
this.mCallPeer.handleOffer(c))};l.prototype.handleMcuInfo=function(c){c=c.getAmzSignalData();a.isEmpty(this.mCallPeer)?this.mMcuInfo=c:this.mCallPeer.handleMcuInfo(c)};l.prototype.handleAnswer=function(c){a.isEmpty(this.mCallPeer)||(c=c.getAmzSignalData(),this.mCallPeer.handleAnswer(c))};l.prototype.handleCandidate=function(c){a.isEmpty(this.mCallPeer)||(c=c.getAmzSignalData(),this.mCallPeer.handleCandidate(c))};l.prototype.getCallStateObservers=function(){return this.mCallStateObservers};l.prototype.setRequestedParticipants=
function(a){this.mRequestedParticipants=a};l.prototype.setCurrentCallParticipants=function(a){this.mParticipantsCurrentlyInCall=a};l.prototype.getCallPeer=function(){return this.mCallPeer};l.prototype.getSelfVideo=function(){return this.mSelfVideo};l.prototype.getRemoteVideo=function(){return this.mRemoteVideo};return{CallState:h,CallDirection:u,Call:l}});t.when("AmazonComm/rtc/call_class").execute(function(e){v["AmazonComm/rtc/call_class"]=e});t.when("AmazonComm/messaging/connection_strategy","AmazonComm/messaging/message_class",
"AmazonComm/rtc/call_class","AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/rtc/call_manager",function(e,l,f,d,n){function k(a){if(!a.wasSentByUs())if(a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_INVITE){m=new f.Call;m.handleIncomingCall(a);a=m;for(var d=0;d<c.length;d++)c[d].onIncomingCall(a)}else a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_ACK?a.getAmzAccept()?m.handleAccept(a):m.handleReject(a):a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_BYE?m.handleHangup(a):a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_OFFER?
m.handleOffer(a):a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_ANSWER?m.handleAnswer(a):a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_CANDIDATE?m.handleCandidate(a):a.getAmzSubType()===l.AMZ_SUBTYPE_SIGNAL_MCU_INFO?m.handleMcuInfo(a):n.w("call_manager","unknown signal type: ["+a.getAmzSubType()+"]")}var c=[],a=e.getConnection(),m;(function(){a.addMessageHandler(l.AMZ_TYPE_SIGNAL,{onMessage:function(a){k(a)}})})();return{addIncomingCallObserver:function(a){-1===c.indexOf(a)&&c.push(a);return a},removeIncomingCallObserver:function(a){a=
c.indexOf(a);-1<a&&c.splice(a,1)},placeCall:function(a){m=new f.Call;m.placeCall(a);return m},getIncomingCallObservers:function(){return c},setCurrentCall:function(a){m=a},handleSignal:function(a){return k(a)}}});t.when("AmazonComm/rtc/call_manager").execute(function(e){v["AmazonComm/rtc/call_manager"]=e});t.when("AmazonComm/messaging/message_class","AmazonComm/rtc/call_signaler","AmazonComm/rtc/mcu_controller","AmazonComm/utils/common","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/rtc/call_peer_class",
function(e,l,f,d,n,k){var c={iceServers:[{urls:["turn:54.86.0.80"],username:"kurento",credential:"kurento"}],iceTransportPolicy:"relay"},a={},m={audio:!0,video:!0},q={offerToReceiveAudio:!0,offerToReceiveVideo:!0},u={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};n=function(e,g,b,f,k,l,n){this.mPeerConfiguration=c;this.mPeerConstraints=a;this.mMediaConstraints=m;d.isEmpty(navigator.mozGetUserMedia)?this.mOfferOptions=u:this.mOfferOptions=q;this.mPeerConnection=null;this.mCallId=e;this.mIsCaller=
g;this.mIsGroupCall=b;this.mRemoteParticipant=f;this.mSelfView=k;this.mRemoteView=l;this.mLocalStream=null;this.mCallConnectedCallback=n;this.mRemoteMcuInfo=null;this.mUseMcu=!0;navigator.getUserMedia=navigator.getUserMedia||navigator.mozGetUserMedia||navigator.webkitGetUserMedia;v.RTCPeerConnection=v.RTCPeerConnection||v.mozRTCPeerConnection||v.webkitRTCPeerConnection;v.RTCSessionDescription=v.RTCSessionDescription||v.mozRTCSessionDescription||v.webkitRTCSessionDescription;v.RTCIceCandidate=v.RTCIceCandidate||
v.mozRTCIceCandidate||v.webkitRTCIceCandidate};n.prototype.initialize=function(){k.l("call_peer_class","initializing "+(this.mUseMcu?"MCU":"direct")+" peer connection");var a=this;this.mIsCaller&&this.mUseMcu?f.initialize(function(c){k.l("call_peer_class","sending MCU info to ["+a.mRemoteParticipant.getName()+"]: "+JSON.stringify(c));l.sendSignal(a.mCallId,a.mRemoteParticipant,e.AMZ_SUBTYPE_SIGNAL_MCU_INFO,c);a.createPeerConnection();a.startLocalStream()},function(c){a.onMcuAnswer(c)},function(c){a.onMcuCandidate(c)},
function(c){a.onMcuError(c)},{isGroupCall:a.mIsGroupCall}):this.mUseMcu||(this.createPeerConnection(),this.startLocalStream())};n.prototype.createPeerConnection=function(){if(!d.isEmpty(v.RTCPeerConnection)){this.mPeerConnection=new v.RTCPeerConnection(this.mPeerConfiguration,this.mPeerConstraints);var a=this;this.mPeerConnection.onicecandidate=function(c){a.sendCandidate(c.candidate)};this.mPeerConnection.onaddstream=function(c){a.remoteStreamAdded(c.stream)}}};n.prototype.close=function(){k.l("call_peer_class",
"closing peer connection");this.mUseMcu&&f.close();d.isEmpty(this.mLocalStream)||(this.mLocalStream.getAudioTracks()[0].stop(),this.mLocalStream.getVideoTracks()[0].stop());this.mSelfView.src="";this.mRemoteView.src="";d.isEmpty(this.mPeerConnection)||this.mPeerConnection.close()};n.prototype.handleMcuInfo=function(a){k.l("call_peer_class","got MCU info: "+JSON.stringify(a));this.mRemoteMcuInfo=a;this.mIsGroupCall=a.isGroupCall;var c=this;f.initialize(function(){c.createPeerConnection();c.startLocalStream()},
function(b){c.onMcuAnswer(b)},function(b){c.onMcuCandidate(b)},function(b){c.onMcuError(b)},{remoteMcuInfo:c.mRemoteMcuInfo})};n.prototype.onMcuAnswer=function(a){this.handleAnswer(a)};n.prototype.onMcuCandidate=function(a){this.handleCandidate(a)};n.prototype.onMcuError=function(a){k.e("call_peer_class","got MCU error: "+JSON.stringify(a))};n.prototype.sendOffer=function(a){k.l("call_peer_class","sending offer to "+(this.mUseMcu?"MCU":"["+this.mRemoteParticipant.getName()+"]")+this.sessionDescriptionToString(a));
d.isEmpty(this.mPeerConnection)||this.mPeerConnection.setLocalDescription(a);this.mUseMcu?f.sendOffer(a.sdp):l.sendSignal(this.mCallId,this.mRemoteParticipant,e.AMZ_SUBTYPE_SIGNAL_OFFER,a)};n.prototype.handleOffer=function(a){k.l("call_peer_class","got offer from ["+this.mRemoteParticipant.getName()+"]"+this.sessionDescriptionToString(a));if(!d.isEmpty(this.mPeerConnection)&&(this.mPeerConnection.setRemoteDescription(new v.RTCSessionDescription(a)),!this.mUseMcu)){var c=this;this.mPeerConnection.createAnswer(function(b){c.sendAnswer(b)},
c.handleError,c.mOfferOptions)}};n.prototype.sendAnswer=function(a){k.l("call_peer_class","sending answer to ["+this.mRemoteParticipant.getName()+"] "+this.sessionDescriptionToString(a));d.isEmpty(this.mPeerConnection)||this.mPeerConnection.setLocalDescription(a);this.mUseMcu||l.sendSignal(this.mCallId,this.mRemoteParticipant,e.AMZ_SUBTYPE_SIGNAL_ANSWER,a)};n.prototype.handleAnswer=function(a){k.l("call_peer_class","got answer from "+(this.mUseMcu?"MCU":"["+this.mRemoteParticipant.getName()+"]")+
this.sessionDescriptionToString(a));d.isEmpty(this.mPeerConnection)||this.mPeerConnection.setRemoteDescription(new v.RTCSessionDescription(a))};n.prototype.sendCandidate=function(a){d.isEmpty(a)||-1===a.candidate.indexOf("relay")||(k.l("call_peer_class","sending candidate to "+(this.mUseMcu?"MCU ":"["+this.mRemoteParticipant.getName()+"] ")+this.candidateToString(a)),this.mUseMcu?f.sendCandidate(a):l.sendSignal(this.mCallId,this.mRemoteParticipant,e.AMZ_SUBTYPE_SIGNAL_CANDIDATE,a))};n.prototype.handleCandidate=
function(a){d.isEmpty(a)||(k.l("call_peer_class","got candidate from "+(this.mUseMcu?"MCU ":"["+this.mRemoteParticipant.getName()+"] ")+this.candidateToString(a)),d.isEmpty(this.mPeerConnection)||this.mPeerConnection.addIceCandidate(new v.RTCIceCandidate(a)))};n.prototype.startLocalStream=function(){var a=this;k.l("call_peer_class","starting local stream");d.isEmpty(navigator.getUserMedia)||navigator.getUserMedia(a.mMediaConstraints,function(c){a.mLocalStream=c;a.mIsGroupCall?a.mSelfView.style.display=
"none":(a.mSelfView.style.display="initial",a.connectStreamToElement(c,a.mSelfView));a.mPeerConnection.addStream(c);(a.mIsCaller||a.mUseMcu)&&a.mPeerConnection.createOffer(function(b){a.sendOffer(b)},a.handleError,a.mOfferOptions)},a.handleError)};n.prototype.remoteStreamAdded=function(a){k.l("call_peer_class","adding remote stream");this.connectStreamToElement(a,this.mRemoteView);this.mCallConnectedCallback()};n.prototype.connectStreamToElement=function(a,c){d.isEmpty(navigator.mozGetUserMedia)?
(v.URL=v.URL||v.webkitURL,c.autoplay=!0,c.src=v.URL.createObjectURL(a)):(c.mozSrcObject=a,c.play())};n.prototype.handleError=function(a){k.e("call_peer_class","got error: "+a.name+" "+a.message)};n.prototype.sessionDescriptionToString=function(a){return"\n"+a.sdp};n.prototype.candidateToString=function(a){return"["+a.candidate+"]"};n.prototype.getCallId=function(){return this.mCallId};n.prototype.getIsCaller=function(){return this.mIsCaller};n.prototype.getRemoteParticipant=function(){return this.mRemoteParticipant};
n.prototype.getSelfView=function(){return this.mSelfView};n.prototype.getRemoteView=function(){return this.mRemoteView};n.prototype.getRemoteMcuInfo=function(){return this.mRemoteMcuInfo};n.prototype.setUseMcu=function(a){this.mUseMcu=a};return{CallPeer:n}});t.when("AmazonComm/rtc/call_peer_class").execute(function(e){v["AmazonComm/rtc/call_peer_class"]=e});t.when("AmazonComm/common/chatroom_class","AmazonComm/messaging/connection_strategy","AmazonComm/messaging/message_class","AmazonComm/utils/common",
"AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/rtc/call_signaler",function(e,l,f,d,n,k){function c(a,c,d){var h=n.getLocalUser(),g=new f.Message;g.setFrom(h.getJID());g.setTo(c.getJID());c instanceof e.ChatRoom?g.setType(f.TYPE_GROUPCHAT):g.setType(f.TYPE_NORMAL);g.setAmzType(f.AMZ_TYPE_SIGNAL);g.setAmzCallId(a);g.setAmzSubType(d);g.setAmzSenderJID(h.getJID());g.setAmzSenderName(h.getName());g.setAmzSenderId(h.getThirdPartyID());return g}var a=l.getConnection();return{sendInvite:function(e,
l,n){var h=f.AMZ_SUBTYPE_SIGNAL_INVITE;e=c(e,l,h);d.isEmpty(n)||e.setAmzGroupInviteJID(n.getJID());k.l("call_signaler","sending ["+h+"] to ["+l.getName()+"]");a.sendMessage(e)},sendAccept:function(d,e){var l=f.AMZ_SUBTYPE_SIGNAL_ACK;d=c(d,e,l);d.setAmzAccept(!0);k.l("call_signaler","sending ["+l+"] accept\x3dtrue to ["+e.getName()+"]");a.sendMessage(d)},sendReject:function(d,e){var l=f.AMZ_SUBTYPE_SIGNAL_ACK;d=c(d,e,l);d.setAmzAccept(!1);k.l("call_signaler","sending ["+l+"] accept\x3dfalse to ["+
e.getName()+"]");a.sendMessage(d)},sendHangup:function(d,e){var l=f.AMZ_SUBTYPE_SIGNAL_BYE;d=c(d,e,l);k.l("call_signaler","sending ["+l+"] to ["+e.getName()+"]");a.sendMessage(d)},sendSignal:function(d,e,f,h){d=c(d,e,f);d.setAmzSignalData(h);a.sendMessage(d)}}});t.when("AmazonComm/rtc/call_signaler").execute(function(e){v["AmazonComm/rtc/call_signaler"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/rtc/mcu_controller",function(e,l){function f(g,f,k,q,x){n();J=g;
H=f;E=k;I=q;w=!0;e.isEmpty(x)||(e.isEmpty(x.isGroupCall)||(t=x.isGroupCall),e.isEmpty(x.filterName)||(b=x.filterName),e.isEmpty(x.remoteMcuInfo)||(w=!1,r=x.remoteMcuInfo.mcuSocketUrl,z=x.remoteMcuInfo.mediaPipelineId,M=x.remoteMcuInfo.sourceEndpointId,K=x.remoteMcuInfo.sinkEndpointId,t=x.remoteMcuInfo.isGroupCall));e.isEmpty(r)&&(r="wss://mcu.turn.amazon-comm.com:443/kurento");g=e.isEmpty(D)?v.WebSocket:D;l.l("mcu_controller","opening websocket to ["+r+"]");p=new g(r);p.onopen=function(){l.l("mcu_controller",
"opened websocket to ["+r+"]");w?d({jsonrpc:"2.0",id:"ID_CREATE_MEDIA_PIPELINE",method:"create",params:{type:"MediaPipeline"}}):c()};p.onmessage=function(g){g=JSON.parse(g.data);e.isEmpty(g.error)?"onEvent"===g.method?"OnIceCandidate"===g.params.value.type&&E(g.params.value.data.candidate):"ID_CREATE_MEDIA_PIPELINE"===g.id?(C=g.result.sessionId,z=g.result.value,l.l("mcu_controller","created media pipeline - mMediaPipelineId: ["+z+"]"),c()):"ID_CREATE_WEBRTC_ENDPOINT"===g.id?(C=g.result.sessionId,
y=g.result.value,l.l("mcu_controller","created endpoint - mWebRtcEndpointId: ["+y+"]"),e.isEmpty(b)?u():d({jsonrpc:"2.0",id:"ID_CREATE_CUSTOM_FILTER",method:"create",params:{type:b,constructorParams:{mediaPipeline:z}},sessionId:C})):"ID_CREATE_COMPOSITE"===g.id?(P=g.result.value,l.l("mcu_controller","created composite - mCompositeEndpointId: ["+P+"]"),a()):"ID_CREATE_HUB_PORT"===g.id?(N=g.result.value,l.l("mcu_controller","created hub port - mHubPortId: ["+N+"]"),e.isEmpty(L)?m("ID_CONNECT_LOCAL_TO_HUB_PORT",
y,N):m("ID_CONNECT_LOCAL_TO_HUB_PORT",L,N),m("ID_CONNECT_HUB_PORT_TO_LOCAL",N,y)):"ID_CREATE_CUSTOM_FILTER"===g.id?(L=g.result.value,l.l("mcu_controller","created custom filter - mCustomFilterId: ["+L+"]"),m("ID_CONNECT_LOCAL_TO_CUSTOM",y,L)):"ID_CONNECT_LOCAL_TO_CUSTOM"===g.id?(l.l("mcu_controller","connected local endpoint to custom filter"),u()):"ID_CONNECT_LOCAL_TO_HUB_PORT"===g.id?(Q=!0,l.l("mcu_controller","connected local endpoint to hub port"),h()):"ID_CONNECT_HUB_PORT_TO_LOCAL"===g.id?(G=
!0,l.l("mcu_controller","connected hub port to local endpoint"),h()):"ID_CONNECT_LOCAL_TO_REMOTE"===g.id?(Q=!0,l.l("mcu_controller","connected local endpoint to remote endpoint"),h()):"ID_CONNECT_REMOTE_TO_LOCAL"===g.id?(G=!0,l.l("mcu_controller","connected remote endpoint to local endpoint"),h()):"ID_PROCESS_OFFER"===g.id?(H({sdp:g.result.value,type:"answer"}),d({jsonrpc:"2.0",id:"ID_SUBSCRIBE_ON_ICE_CANDIDATE",method:"subscribe",params:{object:y,type:"OnIceCandidate",sessionId:C}})):"ID_SUBSCRIBE_ON_ICE_CANDIDATE"===
g.id&&(B=g.result.value,l.l("mcu_controller","subscribed to ICE candidates - mOnIceCandidateSubscriptionId: ["+B+"]"),d({jsonrpc:"2.0",id:"ID_GATHER_CANDIDATES",method:"invoke",params:{object:y,operation:"gatherCandidates"},sessionId:C})):(l.e("mcu_controller","got error from kurento: ["+g.error.message+"]"),I({code:g.error.code,description:g.error.message}))}}function d(b){b=JSON.stringify(b);p.send(b)}function n(){if(e.isEmpty(p))k();else{var b=!1;e.isEmpty(B)||(l.l("mcu_controller","unsubscribing from ice candidate events"),
d({jsonrpc:"2.0",id:"ID_UNSUBSCRIBE_ON_ICE_CANDIDATE",method:"unsubscribe",params:{object:y,subscription:B,sessionId:C}}),b=!0);e.isEmpty(N)||(l.l("mcu_controller","disconnecting hub port"),e.isEmpty(L)?q("ID_DISCONNECT_LOCAL_FROM_HUB_PORT",y,N):q("ID_DISCONNECT_LOCAL_FROM_HUB_PORT",L,N),q("ID_DISCONNECT_HUB_PORT_FROM_LOCAL",N,y),b=!0);b?(l.l("mcu_controller","closing websocket to ["+r+"] in 1000ms"),setTimeout(function(){p.close();k()},1E3)):(l.l("mcu_controller","closing websocket to ["+r+"]"),
p.close(),k())}}function k(){r=p=b=null;t=w=!1;B=y=z=C=I=E=H=J=null;G=Q=!1;K=M=L=N=P=null}function c(){d({jsonrpc:"2.0",id:"ID_CREATE_WEBRTC_ENDPOINT",method:"create",params:{type:"WebRtcEndpoint",constructorParams:{mediaPipeline:z}},sessionId:C})}function a(){d({jsonrpc:"2.0",id:"ID_CREATE_HUB_PORT",method:"create",params:{type:"HubPort",constructorParams:{mediaPipeline:z,hub:w?P:K}},sessionId:C})}function m(b,a,c){d({jsonrpc:"2.0",id:b,method:"invoke",params:{object:a,operation:"connect",operationParams:{sink:c}},
sessionId:C})}function q(b,a,c){d({jsonrpc:"2.0",id:b,method:"invoke",params:{object:a,operation:"disconnect",operationParams:{sink:c}},sessionId:C})}function u(){t?w?d({jsonrpc:"2.0",id:"ID_CREATE_COMPOSITE",method:"create",params:{type:"Composite",constructorParams:{mediaPipeline:z}},sessionId:C}):a():w?g():(e.isEmpty(L)?m("ID_CONNECT_LOCAL_TO_REMOTE",y,K):m("ID_CONNECT_LOCAL_TO_REMOTE",L,K),m("ID_CONNECT_REMOTE_TO_LOCAL",M,y))}function h(){Q&&G&&g()}function g(){if(w){var a,c;t?a=c=P:(c=e.isEmpty(b)?
y:L,a=y);J({mcuSocketUrl:r,mediaPipelineId:z,sourceEndpointId:c,sinkEndpointId:a,isGroupCall:t})}else J()}var b=null,p=null,r=null,w=!1,t=!1,J=null,H=null,E=null,I=null,C=null,z=null,y=null,B=null,Q=!1,G=!1,P=null,N=null,L=null,M=null,K=null,D;return{FILTER_EDGE_DETECTION:"CannyEdge",initialize:function(b,a,c,d,e){f(b,a,c,d,e)},close:function(){n()},sendOffer:function(b){d({jsonrpc:"2.0",id:"ID_PROCESS_OFFER",method:"invoke",params:{object:y,operation:"processOffer",operationParams:{offer:b}},sessionId:C})},
sendCandidate:function(b){d({jsonrpc:"2.0",id:"ID_ADD_ICE_CANDIDATE",method:"invoke",params:{object:y,operation:"addIceCandidate",operationParams:{candidate:b}},sessionId:C})},setTestWebSocketClass:function(b){D=b}}});t.when("AmazonComm/rtc/mcu_controller").execute(function(e){v["AmazonComm/rtc/mcu_controller"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/mash/campfire_cordova",function(e,l){function f(d,f,k){e.isEmpty(v.cordova)?(l.e("campfire_cordova",
"Cordova undefined"),k.onError("Cordova undefined")):v.cordova.exec(function(c){k.onSuccess(c)},function(c){l.e("campfire_cordova","Error executing "+d+": "+c);k.onError(c)},"CampfireSMASHPlugin",d,f)}return{exec:function(d,e,k){f(d,e,k)}}});t.when("AmazonComm/utils/mash/campfire_cordova").execute(function(e){v["AmazonComm/utils/mash/campfire_cordova"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/browser_storage",function(e,l){var f=[];return{add:function(d,
e){a:{try{localStorage.setItem(d,e)}catch(c){l.l("BrowserStorage","adding to localStorage failed - try to clean up");for(var k=0;k<f.length;k++)f[k]();try{localStorage.setItem(d,e)}catch(a){l.ex("BrowserStorage","adding to localStorage failed after clean up",a);d=!1;break a}}d=!0}return d},get:function(d){return localStorage.getItem(d)},remove:function(d){localStorage.removeItem(d)},clear:function(){localStorage.clear()},getLength:function(){return localStorage.length},keyAt:function(d){return localStorage.key(d)},
registerStorageFullObserver:function(d){f.push(d)},unregisterStorageFullObserver:function(d){-1!==f.indexOf(d)&&f.splice(f.indexOf(d),1)},getObserverCount:function(){return f.length}}});t.when("AmazonComm/utils/browser_storage").execute(function(e){v["AmazonComm/utils/browser_storage"]=e});t.register("AmazonComm/utils/build",function(){return{BUILD_VERSION:"CampfireJavaScriptSDK-2.2.209481.0",BUILD_TIME:"2020-11-05 02:45:18"}});t.when("AmazonComm/utils/build").execute(function(e){v["AmazonComm/utils/build"]=
e});t.register("AmazonComm/utils/common",function(){function e(b){if(void 0===b||null===b)return!0;if("number"===typeof b||"boolean"===typeof b||"function"===typeof b)return!1;if("string"===typeof b)return""===b.trim();if(Array.isArray(b)||void 0!==b.length)return 0===b.length;if(Object.getPrototypeOf(b)!==Object.prototype)return!1;for(var a in b)if(b.hasOwnProperty(a)&&void 0!==b[a])return!1;return!0}function l(b,a){if("number"===typeof b||"string"===typeof b||"boolean"===typeof b)return b===a;if(b===
M&&a===M)return!0;if(b===M&&a!==M||b!==M&&a===M)return!1;if(null===b&&null===a)return!0;if(null===b&&null!==a||null!==b&&null===a)return!1;if(e(b)&&e(a))return!0;if(e(b)&&!e(a)||!e(b)&&e(a))return!1;if(b instanceof Node&&a instanceof Node)return b.isEqualNode(a);var c=[],d=null;for(d in b)if(b.hasOwnProperty(d)&&"function"!==typeof b[d]&&(c.push(d),!l(b[d],a[d])))return!1;for(d in a)if(a.hasOwnProperty(d)&&"function"!==typeof a[d]&&-1===c.indexOf(d))return!1;return!0}function f(b){var a=document.cookie.trim().split(/\s*;\s*/);
b+="\x3d";for(var c=0;c<a.length;++c)if(0===a[c].indexOf(b))return a[c].substring(b.length);return null}function d(b){for(var c="",d=0;d<b.length;d++){for(var e=b[d].toString(2);8>e.length;)e="0"+e;c+=e}e="";for(d=0;d<5-b.length;++d)e+="00000000";c+=e;e="";for(d=0;d<c.length;d+=5)var g=parseInt(c.slice(d,d+5),2),e=e+a[g];1===b.length?e=e.replace(/(.{6})$/,"\x3d\x3d\x3d\x3d\x3d\x3d"):2===b.length?e=e.replace(/(.{4})$/,"\x3d\x3d\x3d\x3d"):3===b.length?e=e.replace(/(.{3})$/,"\x3d\x3d\x3d"):4===b.length&&
(e=e.replace(/(.{1})$/,"\x3d"));return e}function n(b){for(var a="",c=0;c<b.length;++c){for(var d=m[b[c]].toString(2);5>d.length;)d="0"+d;a+=d}b="";for(c=0;c<a.length;c+=8)d=a.slice(c,c+8),8===d.length&&(b+=String.fromCharCode(parseInt(d,2)));return b}for(var k=/[0-9]{9}[0-9X]|[A-Z][A-Z0-9]{9}/g,c=/(http(s)?:\/\/|www\.)?([\da-zA-Z\.-]+)\.(com|ru|net|org|de|jp|uk|cn|in|fr|de|it|nl|es|ca|mx|au|br)(:\d+)?(\/[a-zA-Z0-9\-\+\.\?\/\=@:;%_~#&]+)?\/?/g,a="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".split(""),m={},q=
0;q<a.length;++q)m[a[q]]=q;var u={};t.when("mash").execute(function(b){u=b});var h="mr mrs ms miss dr fr rev prof judge hon".split(" "),g="i ii iii iv jr sr md phd esq".split(" ");return{isDataUri:function(b){b=e(b)?!1:"string"!==typeof b?!1:0===b.indexOf("data:");return b},TAG_CALL:"call",TAG_PRESENCE:"presence",TAG_IQ:"iq",TAG_MESSAGE:"message",TAG_ROOM:"room",TAG_REQUEST:"request",TAG_JID:"jid",TAG_RESOURCE:"resource",TAG_METRIC:"metric",createUUID:function(b){return("xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(b){var a=16*Math.random()|0;return("x"===b?a:a&3|8).toString(16)})+("-"+b)).toLowerCase()},getChromeMajorVersion:function(){var b=-1,a=navigator.userAgent,c=a.indexOf("Chrome/");-1!==c&&(b=a.substring(c+7),b=b.substring(0,b.indexOf(" ")),b=parseInt(b,10));return b},isChrome:function(){return!e(v.chrome)},isNativeApp:function(){return!e(v.NativeWrapper)||!e(v.AndroidClipboard)},isMashCordova:function(){return!e(u)&&!e(v.cordova)||!e(f("amzn-app-ctxt"))},getMash:function(){return u},deepEquals:function(b,
a){return l(b,a)},shortString:function(b,a){if(e(b))return"[]";e(a)&&(a=5);return b.length>a?"[..."+b.substring(b.length-a)+"]":b},xmppDateToJSDate:function(b){if(e(b))throw Error("null input string");if(20>b.length)throw Error("input string too short");var a=b.substr(0,4),c=b.substr(5,2)-1,d=b.substr(8,2),g=b.substr(11,2),f=b.substr(14,2),h=b.substr(17,2),k=parseInt(a,10);if(1970>k||3E3<k)throw Error("invalid year");k=parseInt(c,10);if(0>k||11<k)throw Error("invalid month");k=parseInt(d,10);if(0>
k||31<k)throw Error("invalid day");k=parseInt(g,10);if(0>k||24<k)throw Error("invalid hour");k=parseInt(f,10);if(0>k||59<k)throw Error("invalid minute");k=parseInt(h,10);if(0>k||59<k)throw Error("invalid second");a=new Date(Date.UTC(a,c,d,g,f,h));d=b.length;if("Z"!==b.substr(d-1,1)){c=new Date;c.setTime(0);g=b.substr(d-5,2);f=parseInt(g,10);if(0>f||24<f)throw Error("invalid offset hour");f=b.substr(d-2,2);h=parseInt(f,10);if(0>h||59<h)throw Error("invalid offset minute");c.setUTCHours(g);c.setUTCMinutes(f);
b=b.substr(d-6,1);if("+"===b)a.setTime(a.getTime()-c.getTime());else if("-"===b)a.setTime(a.getTime()+c.getTime());else throw Error("invalid offset sign");}return a},escapeHtml:function(b){b=b.replace(/&/g,"\x26amp;");b=b.replace(/</g,"\x26lt;");b=b.replace(/>/g,"\x26gt;");b=b.replace(/"/g,"\x26quot;");return b=b.replace(/'/g,"\x26#39;")},unescapeHtml:function(b){b=b.replace(/&amp;/g,"\x26");b=b.replace(/&lt;/g,"\x3c");b=b.replace(/&gt;/g,"\x3e");b=b.replace(/&quot;/g,'"');return b=b.replace(/&#39;/g,
"'")},stringToBase64:function(b){b=encodeURIComponent(b).replace(/%([0-9A-F]{2})/g,function(b,a){return String.fromCharCode(parseInt(a,16))});return v.btoa(b)},stringToBase32:function(b){var a=encodeURIComponent(b).replace(/%([0-9A-F]{2})/g,function(b,a){return String.fromCharCode(parseInt(a,16))});b=[];for(var c=0;c<a.length;++c)b.push(a.charCodeAt(c));a="";for(c=0;c<b.length;c+=5)a+=d(b.slice(c,c+5));return a},base32ToString:function(b){b=b.replace(/(=*)$/,"");for(var a="",c=0;c<b.length;c+=8)a+=
n(b.slice(c,c+8));b=a.replace(/(.)/g,function(b,a){b=a.charCodeAt(0).toString(16).toUpperCase();2>b.length&&(b="0"+b);return"%"+b});return decodeURIComponent(b)},base64ToString:function(b){b=v.atob(b).replace(/(.)/g,function(b,a){b=a.charCodeAt(0).toString(16).toUpperCase();2>b.length&&(b="0"+b);return"%"+b});return decodeURIComponent(b)},isEmpty:function(b){return e(b)},getRandomWithExclusion:function(b,a,c){b=Math.floor(b);a=Math.floor(a)-b;for(var d=0,g=!1,f=0;1E3>d&&!g;)d++,f=Math.round(Math.random()*
a)+b,g=e(c)||-1===c.indexOf(f);if(!g)throw Error("failed to generate random after 1000 tries - giving up");return f},shortenName:function(b){var a;if(e(b))a="";else if(a=b.trim().split(/\s+/),1===a.length)a=b;else{b=a[0].toLowerCase().replace(/\./g,"");-1!==h.indexOf(b)&&a.shift();for(b=a.shift().trim();1<a.length&&-1!==g.indexOf(a[a.length-1].toLowerCase().replace(/\./g,""));)a.pop();a=a.pop().trim().substring(0,1).toUpperCase();a=b+" "+a}return a},getGlobalRegEx:function(a){return new RegExp(a,
"g")},getAsinRegEx:function(){return k},getUrlRegEx:function(){return c},ellipsize:function(a,c){return a.length<=c?a:a.substring(0,c)+"..."},dayOfWeek:function(a){switch(a){case 0:return"Sunday";case 1:return"Monday";case 2:return"Tuesday";case 3:return"Wednesday";case 4:return"Thursday";case 5:return"Friday";case 6:return"Saturday";default:return""}},getRelativeTimeFormatForTimestamp:function(a,c){if(e(a))return"";a=new Date(a);var d=new Date;e(c)||(d=new Date(c));c=(d.getTime()-a.getTime())/1E3;
if(86400>c){c="am";var g=d=a.getHours();0===d?g="12":11<d&&(c="pm",12<d&&(g=d-12));return g+":"+(10>a.getMinutes()?"0":"")+a.getMinutes()+" "+c}return 604800>c?this.dayOfWeek(a.getDay()):1209600>c?"Last "+this.dayOfWeek(a.getDay()):a.toLocaleDateString()},setMash:function(a){u=a},getCookieValue:function(a){return f(a)}}});t.when("AmazonComm/utils/common").execute(function(e){v["AmazonComm/utils/common"]=e});t.when("AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/config",
function(e,l){function f(b){a="PROD"===b||"GAMMA"===b||"BETA"===b||"ALPHA"===b||"DEV"===b?b:"PROD"}var d="SharedKey",n=!1,k={Default:{}};k.Default.PROD={MESSAGING_SERVICE:"https://campfire__SERVER_INDEX__.prod.xmpp.amazon-comm.com",MESSAGING_SERVICE_HOST_COUNT:4,MESSAGING_SERVICE_DOMAIN:"campfire.prod.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.prod.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.prod.xmpp.amazon-comm.com",CORE_SERVICE:"https://prod.core.amazon-comm.com",
TURN_SERVICE:"wss://turn.amazon-comm.com",EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};k.Default.GAMMA={MESSAGING_SERVICE:"https://campfire__SERVER_INDEX__.gamma.xmpp.amazon-comm.com",MESSAGING_SERVICE_HOST_COUNT:4,MESSAGING_SERVICE_DOMAIN:"campfire.gamma.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.gamma.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.gamma.xmpp.amazon-comm.com",CORE_SERVICE:"https://gamma.core.amazon-comm.com",TURN_SERVICE:"wss://gamma.turn.amazon-comm.com",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};k.Default.BETA={MESSAGING_SERVICE:"https://campfire-xmpp-beta__SERVER_INDEX__.aka.pdx.corp.amazon.com:4569",MESSAGING_SERVICE_HOST_COUNT:2,MESSAGING_SERVICE_DOMAIN:"campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.beta.xmpp.amazon-comm.com",CORE_SERVICE:"https://campfire.integ.amazon.com:4281",TURN_SERVICE:"wss://campfire-turn.integ.amazon.com:443",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};k.Default.ALPHA={MESSAGING_SERVICE:"https://campfire-xmpp-alpha__SERVER_INDEX__.aka.pdx.corp.amazon.com:4569",MESSAGING_SERVICE_HOST_COUNT:2,MESSAGING_SERVICE_DOMAIN:"campfire.alpha.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.alpha.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.alpha.xmpp.amazon-comm.com",CORE_SERVICE:"https://campfire.integ.amazon.com:4281",TURN_SERVICE:"wss://campfire-turn.integ.amazon.com:443",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};k.Default.DEV={MESSAGING_SERVICE:"https://campfire-xmpp-beta__SERVER_INDEX__.aka.pdx.corp.amazon.com:4569",MESSAGING_SERVICE_HOST_COUNT:2,MESSAGING_SERVICE_DOMAIN:"campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_MUC_DOMAIN:"groups.campfire.beta.xmpp.amazon-comm.com",MESSAGING_SERVICE_SEARCH_DOMAIN:"search.campfire.beta.xmpp.amazon-comm.com",CORE_SERVICE:"https://campfire.integ.amazon.com:4281",TURN_SERVICE:"wss://campfire-turn.integ.amazon.com:443",
EXTENDED_MESSAGE_METADATA:!0,DISCONNECT_ON_UNLOAD:!0};k.Huddles=k.Default;k.Poppin=k.Default;k.IntegrationTestDefault=k.Default;k.IntegrationTestPoppin=k.Poppin;var c={},a="PROD",m="LIVE",q="Default",u=v.CAMPFIRE_APOLLO_STAGE;void 0!==u&&(u=u.toLowerCase(),"beta"===u?f("BETA"):"alpha"===u?f("ALPHA"):"gamma"===u&&f("GAMMA"));var h,g,b=/((fr|de|es|nl|uk|it|in|ae|sa|tr)+-+)|(-+(fr|de|es|nl|uk|it|in|ae|sa|tr)+[^a-z])|(amazon(.)*(fr|de|es|nl|uk|it|in|ae|sa|tr))/i,p=/((jp|sg|au)+-+)|(amazon(.)*(jp|sg|au))/i,
r=/(amazon(.)*(fr))/i,t=/(amazon(.)*(de))/i,M=/(amazon(.)*(es))/i,J=/(amazon(.)*(nl))/i,H=/(amazon(.)*(uk))/i,E=/(amazon(.)*(it))/i,I=/(amazon(.)*(in))/i,C=/(amazon(.)*(ae))/i,z=/(amazon(.)*(sa))/i,y=/(amazon(.)*(tr))/i,B=/(amazon(.)*(jp))/i,Q=/(amazon(.)*(au))/i,G=/(amazon(.)*(sg))/i,P=/(amazon(.)*(ca))/i,N=/(amazon(.)*(br))/i,L=/(amazon(.)*(mx))/i,X=/(.+.)*primevideo.com/i;return{STAGE_PROD:"PROD",STAGE_GAMMA:"GAMMA",STAGE_BETA:"BETA",STAGE_ALPHA:"ALPHA",STAGE_DEV:"DEV",MUC_DOMAIN_PREFIX:"groups.",
setApiKey:function(a){"Poppin"===a||"Huddles"===a||"Default"===a||"IntegrationTestPoppin"===a||"IntegrationTestDefault"===a?(q=a,a=!0):(q="Default",l.e("config","Invalid API key: ["+a+"] - using default"),a=!1);return a},getStage:function(){return a},setStage:function(a){f(a)},isDev:function(){return"DEV"===a},isAlpha:function(){return"ALPHA"===a},isBeta:function(){return"BETA"===a},isGamma:function(){return"GAMMA"===a},isProd:function(){return"PROD"===a},getMessagingHost:function(b){var d=b=e.isEmpty(b)||
0>b?"":"-"+b;e.isEmpty(m)||"STAGING"!==m||(d=b+"-"+m.toLowerCase());return(c.MESSAGING_SERVICE||k[q][a].MESSAGING_SERVICE).replace(/__SERVER_INDEX__/g,d)},getMessagingHostOverride:function(){return c.MESSAGING_SERVICE},getMessagingHostFormat:function(){return c.MESSAGING_SERVICE||k[q][a].MESSAGING_SERVICE},getMessagingHostCount:function(){return c.MESSAGING_SERVICE_HOST_COUNT||k[q][a].MESSAGING_SERVICE_HOST_COUNT},getMessagingDomain:function(){return c.MESSAGING_SERVICE_DOMAIN||k[q][a].MESSAGING_SERVICE_DOMAIN},
getMUCDomain:function(){return c.MESSAGING_SERVICE_MUC_DOMAIN||k[q][a].MESSAGING_SERVICE_MUC_DOMAIN},getSearchDomain:function(){return c.MESSAGING_SERVICE_SEARCH_DOMAIN||k[q][a].MESSAGING_SERVICE_SEARCH_DOMAIN},getCoreServiceHost:function(){return c.CORE_SERVICE||k[q][a].CORE_SERVICE},getTURNHost:function(){return c.TURN_SERVICE||k[q][a].TURN_SERVICE},getInternalServiceHost:function(){l.l("config","Marketplace Id: ["+h+"]");if(!e.isEmpty(c.INTERNAL_SERVICE))return l.l("config","Using Internal Service host Override: ["+
c.INTERNAL_SERVICE+"]"),c.INTERNAL_SERVICE;var d;l.l("config","Domain Name: ["+g+"]");d=b.test(g);"PROD"===a?X.test(g)?(d="https://internal.campfire.primevideo.com","A2MFUE2XK8ZSSY"===h||"A3K6Y4MI8GDYMT"===h?d="https://internal-campfire-eu.primevideo.com":"A15PK738MTQHSO"===h&&(d="https://internal-campfire-fe.primevideo.com")):d?(d="https://internal-campfire-eu.amazon.com",r.test(g)?d="https://internal-campfire-eu.amazon.fr":t.test(g)?d="https://internal-campfire-eu.amazon.de":M.test(g)?d="https://internal-campfire-eu.amazon.es":
J.test(g)?d="https://internal-campfire-eu.amazon.nl":H.test(g)?d="https://internal-campfire-eu.amazon.co.uk":E.test(g)?d="https://internal-campfire-eu.amazon.it":I.test(g)?d="https://internal-campfire-eu.amazon.in":C.test(g)?d="https://internal-campfire-eu.amazon.ae":z.test(g)?d="https://internal-campfire-eu.amazon.sa":y.test(g)&&(d="https://internal-campfire-eu.amazon.com.tr")):p.test(g)?(d="https://internal-campfire-fe.amazon.com",B.test(g)?d="https://internal-campfire-fe.amazon.co.jp":G.test(g)?
d="https://internal-campfire-fe.amazon.sg":Q.test(g)&&(d="https://internal-campfire-fe.amazon.com.au")):(d="https://internal.campfire.amazon.com",P.test(g)?d="https://internal.campfire.amazon.ca":N.test(g)?d="https://internal.campfire.amazon.com.br":L.test(g)&&(d="https://internal.campfire.amazon.com.mx")):d="GAMMA"===a?d?"https://internal-campfire-eu-gamma.amazon.com":p.test(g)?"https://internal-campfire-fe-gamma.amazon.com":"https://internal-gamma.campfire.amazon.com":d?"https://campfire-eu.integ.amazon.com:11343":
p.test(g)?"https://campfire-fe.integ.amazon.com:11343":"https://campfire.integ.amazon.com:11343";l.l("config","Internal Service Host: ["+d+"]");return d},isExtendedMessageMetadataEnabled:function(){return e.isEmpty(c.EXTENDED_MESSAGE_METADATA)?k[q][a].EXTENDED_MESSAGE_METADATA:c.EXTENDED_MESSAGE_METADATA},getMapThumbnailBase:function(a){return a?"http://image.maps.api.here.com/mia/1.6/mapview?app_id\x3doOnEEaBPJEG9JTqwTyjZ\x26app_code\x3dWV2t5lCfD0NGpQMEjS2VBw\x26w\x3d120\x26h\x3d80\x26z\x3d15\x26style\x3dflame":
"http://image.maps.api.here.com/mia/1.6/mapview?app_id\x3doOnEEaBPJEG9JTqwTyjZ\x26app_code\x3dWV2t5lCfD0NGpQMEjS2VBw\x26w\x3d240\x26h\x3d160\x26z\x3d15\x26style\x3dflame"},getMapThumbnailWidth:function(a){return a?120:240},getMapThumbnailHeight:function(a){return a?80:160},getMapUrl:function(a,b){return"http://here.com/"+a+","+b+",13,0,0,normal.day"},useWebDeviceAttributes:function(){return!e.isMashCordova()&&("DEV"===a||"ALPHA"===a||"BETA"===a)},disconnectOnUnload:function(){return e.isEmpty(c.DISCONNECT_ON_UNLOAD)?
k[q][a].DISCONNECT_ON_UNLOAD:c.DISCONNECT_ON_UNLOAD},AUTH_COGNITO:"Cognito",AUTH_CS_SHARED_KEY:"CSSharedKey",AUTH_SHARED_KEY:"SharedKey",setAuthProvider:function(a){d=a},useCognitoAuth:function(){return"Cognito"===d},useCSSharedKeyAuth:function(){return"CSSharedKey"===d},useSharedKeyAuth:function(){return"SharedKey"===d},isAuthenticationCheckRequired:function(){return n},setAuthenticationCheckRequired:function(a){n=a},CLUSTER_LIVE:"LIVE",CLUSTER_STAGING:"STAGING",setClusterName:function(a){m=a},getClusterName:function(){return m},
setMarketplaceId:function(a){h=a},getMarketplaceId:function(){return h},setDomainName:function(a){l.l("config","Setting Domain Name: ["+a+"]");g=a},getDomainName:function(){return g},getApiKey:function(){return q},setMessagingHost:function(a){e.isEmpty(a)?l.w("config","Empty value passed to setMessagingHost()"):c.MESSAGING_SERVICE=a},setMessagingDomain:function(a){e.isEmpty(a)?l.w("config","Empty value passed to setMessagingDomain()"):(c.MESSAGING_SERVICE_DOMAIN=a,c.MESSAGING_SERVICE_MUC_DOMAIN="groups."+
a,c.MESSAGING_SERVICE_SEARCH_DOMAIN="search."+a)},setMUCDomain:function(a){e.isEmpty(a)?l.w("config","Empty value passed to setMUCDomain()"):c.MESSAGING_SERVICE_MUC_DOMAIN=a},setCoreServiceHost:function(a){e.isEmpty(a)?l.w("config","Empty value passed to setCampfireCoreServiceHost()"):c.CORE_SERVICE=a},setTURNHost:function(a){e.isEmpty(a)?l.w("config","Empty value passed to setTURNHost()"):c.TURN_SERVICE=a},setInternalServiceHost:function(a){e.isEmpty(a)?l.w("config","Empty value passed to setCampfireInternalServiceHost()"):
c.INTERNAL_SERVICE=a},setExtendedMessageMetadataEnabled:function(a){c.EXTENDED_MESSAGE_METADATA=a},setDisconnectOnUnload:function(a){c.DISCONNECT_ON_UNLOAD=a},resetServers:function(){c={}}}});t.when("AmazonComm/utils/config").execute(function(e){v["AmazonComm/utils/config"]=e});t.register("AmazonComm/utils/constants",function(){return{ELEMENT_JSON:"json",NS_JSON:"urn:xmpp:json:0",XMLNS:"xmlns"}});t.when("AmazonComm/utils/constants").execute(function(e){v["AmazonComm/utils/constants"]=e});t.when("AmazonComm/utils/common").register("AmazonComm/utils/location",
function(e){function l(d,e,k,c){var a=(k-d)*f;e=(c-e)*f;d=Math.sin(a/2)*Math.sin(a/2)+Math.cos(d*f)*Math.cos(k*f)*Math.sin(e/2)*Math.sin(e/2);return 12742E3*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))}var f=Math.PI/180;return{getDistanceBetweenLatLongPoints:function(d,e,f,c){return l(d,e,f,c)},isSignificantLocationChange:function(d,f){return e.isEmpty(d)||200<l(d.latitude,d.longitude,f.latitude,f.longitude)||9<Math.abs(d.speed-f.speed)}}});t.when("AmazonComm/utils/location").execute(function(e){v["AmazonComm/utils/location"]=
e});t.register("AmazonComm/utils/error_codes",function(){return{GENERIC_ERRORS:{ERROR_UNKNOWN:1001},AUTH_ERRORS:{ERROR_AUTH_STATUS_CHANGED_ON_REFRESH:2001,ERROR_CUSTOMER_ID_CHANGED_ON_REFRESH:2002},COMM_SERVICE_ERRORS:{ERROR_NOT_INITIALIZED:3001},CONNECTION_ERRORS:{ERROR_CONNECTION_LOST:4001,ERROR_SESSION_TERMINATED:4002,ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE:4003,ERROR_INVALID_URL:4004},IDENTITY_ERRORS:{ERROR_CUSTOMER_ID_DIFFERENT_THAN_AUTH:5001},SERVICE_ERRORS:{ERROR_XHR_RESPONSE:6001},CHAT_ROOM_ERRORS:{ERROR_INVALID_PARAMETER:7001,
ERROR_FAILED_TO_CREATE_ROOM:7002,ERROR_FAILED_TO_JOIN_ROOM:7003,ERROR_FAILED_TO_SET_AFFILIATION:7004,ERROR_FAILED_TO_SET_ROLE:7005,ERROR_FAILED_TO_REGISTER_WITH_ROOM:7006,ERROR_FAILED_TO_REMOVE_REGISTRATION:7007,ERROR_FAILED_TO_GET_MEMBERS_LIST:7008,ERROR_FAILED_TO_ENABLE_MUTE_NOTIFICATION:7009,ERROR_FAILED_TO_DISABLE_MUTE_NOTIFICATION:7010,ERROR_FAILED_TO_GET_MUTE_NOTIFICATION_STATE:7011}}});t.when("AmazonComm/utils/error_codes").execute(function(e){v["AmazonComm/utils/error_codes"]=e});t.when("AmazonComm/common/person_class",
"AmazonComm/common/jid_class","AmazonComm/utils/common","AmazonComm/utils/log").register("AmazonComm/utils/global_state",function(e,l,f,d){var n=new e.Person(null),k={},c={},a=[],m=null,q=null,u=null,h=[],g=null;return{addCookie:function(a){h.push(a)},getCookies:function(){return h},getLocalUser:function(){return n},getLocalUserFullJID:function(){return g},setLocalUser:function(a){n=a;f.isEmpty(a.getJID())||(g=new l.JID.fromJSONObject(a.getJID()),g.setResource(this.getResource()))},getPersonaName:function(){return q},
setPersonaName:function(a){q=a},getResource:function(){f.isEmpty(m)&&(m=f.createUUID(f.TAG_RESOURCE));return m},setAuthCredentialData:function(a){k=a},setCurrentAuthCredentialData:function(a){c=a},getAuthCredentialData:function(){return k},getCurrentAuthCredentialData:function(){return c},setAuthStatus:function(a){f.isEmpty(k)?k={authStatus:a}:k.authStatus=a},getAuthStatus:function(){return f.isEmpty(k)?null:k.authStatus},registerCleanupObserver:function(b){a.push(b);return b},unregisterCleanupObserver:function(b){b=
a.indexOf(b);-1<b&&a.splice(b,1)},cleanup:function(){d.l("global_state","cleaning up global state");for(var b=0;b<a.length;b++)a[b].cleanup();n=new e.Person(null);k={};c={};m=null},setMessagingServerUrl:function(a){u=a},getMessagingServerUrl:function(){return u},getCleanupObservers:function(){return Object.freeze(a)},setResource:function(a){m=a;g.setResource(a)}}});t.when("AmazonComm/utils/global_state").execute(function(e){v["AmazonComm/utils/global_state"]=e});t.register("AmazonComm/utils/log",
function(){function e(d){return 10>d?"0"+d:""+d}function l(d){return 10>d?"00"+d:100>d?"0"+d:""+d}function f(f,c,a){if(d||-1===navigator.userAgent.indexOf("PhantomJS/")){var m=new Date,q=m.getFullYear()+"-"+e(m.getMonth()+1)+"-"+e(m.getDate()),q=q+(" "+e(m.getHours())+":"+e(m.getMinutes())+":"+e(m.getSeconds())+"."+l(m.getMilliseconds())+" ");if(n){m=q;a:{q=Error().stack;if(void 0===q||!q){try{throw Error();}catch(g){q=g.stack}if(void 0===q||!q){q="NO_STACK";break a}}var u=q.split("\n"),q="unknown",
h=3;"Error"===u[0].trim()&&(h=4);if(u.length>h){q=u[h];q=q.trim();try{0<=q.indexOf("@")?q=q.substring(q.indexOf("@")+1):(q=0<=q.indexOf(" (")?q.split(" (")[1].substring(0,q.length-1):q.split("at ")[1],-1!==q.indexOf(")")&&(q=q.substring(0,q.lastIndexOf(")")))),q=q.substring(q.lastIndexOf("/")+1)}catch(g){q="unknown"}}u=q.indexOf("sha1\x3d");-1!==u&&(q=q.substring(0,u+5)+"..."+q.substr(-10));q="["+q+"]"}q=m+q}q+="["+c+"] "+a;2===f?console.error(q):1===f?console.warn(q):console.log(q)}}var d=!1,n=!1;
return{l:function(d,c){f(0,d,c)},w:function(d,c){f(1,d,"[WARNING] "+c)},e:function(d,c){f(2,d,"[ERROR] "+c)},error:function(d,c,a){f(2,d,"[ERROR] "+c+" - code: ["+a.code+"], description: ["+a.description+"]")},ex:function(d,c,a){f(2,d,"[EXCEPTION] "+c+", name: "+a.name+(void 0===a.stack?"":", stack: "+a.stack))},setIncludeCallingLocation:function(d){n=d},setPhantomJSLoggingEnabled:function(e){d=e},pad:function(d){return e(d)},pad2:function(d){return l(d)}}});t.when("AmazonComm/utils/log").execute(function(e){v["AmazonComm/utils/log"]=
e});t.when("AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/config","AmazonComm/utils/error_codes","AmazonComm/utils/log","AmazonComm/utils/services").register("AmazonComm/utils/messaging_service_host_provider",function(e,l,f,d,n,k){function c(a){var c=l.createUUID(l.TAG_REQUEST),b=f.getApiKey(),d=f.getMessagingDomain(),c={requestId:c,apiKey:b,messagingServiceDomain:d,clusterName:f.getClusterName()};l.isEmpty(a)||(c.unreachableHosts=a);return JSON.stringify(c)}function a(a,
g){var b=e.createMetricEvent("GetMessagingServiceHost",e.AGGREGATING_EVENT);e.startTimer(b,"GetMessagingServiceHost.ApiTimer");var p=f.getCoreServiceHost();n.l("messaging_service_host_provider","Connecting to core service : ["+p+"]");g={url:p,api:"getMessagingServiceHost",payload:c(g),withCredentials:!1};k.sendRestXhrWithRetries(g,{onXhrSendSuccess:function(c){e.stopTimer(b,"GetMessagingServiceHost.ApiTimer");e.incrementCounter(b,"GetMessagingServiceHost.SuccessCount");c=JSON.parse(c.responseText);
c=u(c);if(l.isEmpty(c))a.onGetMessagingServiceHostError({code:d.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE,description:"The host doesn't support required protocol"});else a.onGetMessagingServiceHostSuccess(c)},onXhrSendRetry:function(c,g){e.stopTimer(b,"GetMessagingServiceHost.ApiTimer");e.incrementCounter(b,"GetMessagingServiceHost.RetryCount");n.l("messaging_service_host_provider","Reconnecting to Core Service in "+g+" ms. ErrorCode : ["+c.code+"] Description : ["+c.description+
"]");c.code=d.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE;a.onGetMessagingServiceHostRetry(c,g)},onXhrSendFailed:function(c){e.stopTimer(b,"GetMessagingServiceHost.ApiTimer");e.incrementCounter(b,"GetMessagingServiceHost.FailureCount");n.l("messaging_service_host_provider","The request to core service failed. ErrorCode : ["+c.code+"] Description : ["+c.description+"]");c.code=d.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE;a.onGetMessagingServiceHostError(c)}})}function m(a){var c=
{requestId:l.createUUID(l.TAG_REQUEST),authenticationCheckRequired:!1,apiKey:f.getApiKey(),marketplaceId:f.getMarketplaceId(),domainName:f.getDomainName(),messagingServiceDomain:f.getMessagingDomain(),clusterName:f.getClusterName()};l.isEmpty(a)||(c.unreachableHosts=a);return JSON.stringify(c)}function q(a,c){var b=e.createMetricEvent("GetMessagingServiceHost",e.AGGREGATING_EVENT);e.startTimer(b,"GetMessagingServiceHost.InternalService.ApiTimer");var p=f.getInternalServiceHost();n.l("messaging_service_host_provider",
"Connecting to internal service : ["+p+"]");c={url:p,api:"getCampfireConnectionPayloadForAmazonCookie",payload:m(c),withCredentials:!1};k.sendRestXhrWithRetries(c,{onXhrSendSuccess:function(c){e.stopTimer(b,"GetMessagingServiceHost.InternalService.ApiTimer");e.incrementCounter(b,"GetMessagingServiceHost.InternalService.SuccessCount");c=JSON.parse(c.responseText);c=u(c);if(l.isEmpty(c))a.onGetMessagingServiceHostError({code:d.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE,description:"The host doesn't support required protocol"});
else a.onGetMessagingServiceHostSuccess(c)},onXhrSendRetry:function(c,g){e.stopTimer(b,"GetMessagingServiceHost.InternalService.ApiTimer");e.incrementCounter(b,"GetMessagingServiceHost.InternalService.RetryCount");n.l("messaging_service_host_provider","Reconnecting to internal service in "+g+" ms. ErrorCode : ["+c.code+"] Description : ["+c.description+"]");c.code=d.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE;a.onGetMessagingServiceHostRetry(c,g)},onXhrSendFailed:function(c){e.stopTimer(b,
"GetMessagingServiceHost.InternalService.ApiTimer");e.incrementCounter(b,"GetMessagingServiceHost.InternalService.FailureCount");n.l("messaging_service_host_provider","The request to internal service failed. ErrorCode : ["+c.code+"] Description : ["+c.description+"]");c.code=d.CONNECTION_ERRORS.ERROR_GET_MESSAGING_SERVICE_HOST_FAILURE;a.onGetMessagingServiceHostError(c)}})}function u(a){var c=null,b=a.messagingServiceHosts;if(!l.isEmpty(b)&&!l.isEmpty(b[0])){var b=a.messagingServiceHosts[0].hostName,
d=null,e=null;a=a.messagingServiceHosts[0].protocols;for(var f=0;f<a.length;++f)if("wss"===a[f].scheme){d=a[f].scheme;e=a[f].port;break}l.isEmpty(b)||l.isEmpty(d)||(c={hostName:b,protocol:d,port:e})}return c}return{getMessagingServiceHost:function(c,d){a(c,d)},createGetMessagingServiceHostRequest:function(a){return c(a)},getMessagingServiceHostFromInternalService:function(a,c){return q(a,c)}}});t.when("AmazonComm/utils/messaging_service_host_provider").execute(function(e){v["AmazonComm/utils/messaging_service_host_provider"]=
e});t.when("AmazonComm/metrics/metrics_manager","AmazonComm/utils/common","AmazonComm/utils/error_codes","AmazonComm/utils/global_state","AmazonComm/utils/log").register("AmazonComm/utils/services",function(e,l,f,d,n){function k(a){var b=d.getCookies();if(!l.isEmpty(b)){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(var c="",e=0;e<b.length;e++)c+=b[e]+";";a.setRequestHeader("cookie",c)}}function c(a,b){var c=new XMLHttpRequest;c.open("POST",a,!0);c.setRequestHeader("Content-Type","application/json");
c.setRequestHeader("Content-Encoding","amz-1.0");c.setRequestHeader("X-Amz-Target",b);k(c);return c}function a(a,b,c){var d=new XMLHttpRequest;d.open("POST",a+"/"+b,!0);d.setRequestHeader("Accept","application/json");d.setRequestHeader("Content-Type","text/plain");!0===c?(d.withCredentials=!0,k(d)):d.withCredentials=!1;return d}function m(a,b,c,d){0===a.status?(n.e("services",c+" XHR status 0 [cross domain call?]\n  URL: "+b+"\n  document.domain:"+document.domain),d(c+" failed with status 0")):(n.e("services",
c+" failed\n  status: "+a.status+"\n  response: "+a.responseText),d(c+" failed with status "+a.status+": ["+a.responseText+"]"))}function q(c,b,d){function k(){try{e.startTimer(v,t+"XhrRequestTimer");var d=a(c.url,c.api,c.withCredentials);d.send(c.payload);d.onreadystatechange=function(){4===d.readyState&&(e.stopTimer(v,t+"XhrRequestTimer"),200===d.status?(e.recordMetricEvent(v),b.onXhrSendSuccess(d)):m(d,c.url,c.api,function(a){q({code:f.SERVICE_ERRORS.ERROR_XHR_RESPONSE,description:a})}))}}catch(h){e.stopTimer(v,
t+"XhrRequestTimer"),e.incrementCounter(v,t+"XhrRequestExceptionCount"),q({code:f.GENERIC_ERRORS.ERROR_UNKNOWN,description:h.message})}}function q(a){if(h)e.incrementCounter(v,t+"XhrRequestFailureCount"),e.recordMetricEvent(v),n.l("services","All XHR sends failed.\n  URL: "+c.url+"\n  API: "+c.api),b.onXhrSendFailed(a);else{e.incrementCounter(v,t+"XhrRequestRetryCount");var f=H,f=Math.floor(f+f*d.jitterRatio*Math.random());H=Math.min(d.backoffFactor*H,E);n.l("services","Scheduling XHR send retry in "+
f+" milliseconds\n  URL: "+c.url+"\n  API: "+c.api);if(!l.isEmpty(b.onXhrSendRetry))b.onXhrSendRetry(a,f);setTimeout(k,f)}}var t=c.api+".",v=e.createMetricEvent("ServiceUtils",e.AGGREGATING_EVENT);l.isEmpty(d)&&(d=u);var H=d.startIntervalMs,E=d.maxDelayMs;k()}var u={startIntervalMs:1E3,maxDelayMs:3E4,backoffFactor:2,jitterRatio:.1},h=!1;return{HTTP_POST:"POST",CONTENT_TYPE:"Content-Type",CONTENT_TYPE_FORM:"application/x-www-form-urlencoded",INTERNAL_SERVICE_NAME:"com.amazon.campfireinternal.CampfireInternalService",
createCoralRequest:function(a,b){return c(a,b)},createRestRequest:function(c,b,d){return a(c,b,d)},createCoreServiceRequest:function(a,b,d){a=c(a,b);a.setRequestHeader("x-campfire-shared-key",d);return a},isXhrDone:function(a){return 4===a.readyState},isXhrOk:function(a){return 200===a.status},handleXhrNotOk:function(a,b,c,d){m(a,b,c,d)},sendRestXhrWithRetries:function(a,b,c){q(a,b,c)},disableRetries:function(){h=!0}}});t.when("AmazonComm/utils/services").execute(function(e){v["AmazonComm/utils/services"]=
e})});
/* ******** */
